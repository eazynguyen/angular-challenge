"use strict";var ga=Object.defineProperty,_a=Object.defineProperties,ya=Object.getOwnPropertyDescriptors,Qo=Object.getOwnPropertySymbols,Ca=Object.prototype.hasOwnProperty,ba=Object.prototype.propertyIsEnumerable,Xo=(bt,Fe,A)=>Fe in bt?ga(bt,Fe,{enumerable:!0,configurable:!0,writable:!0,value:A}):bt[Fe]=A,he=(bt,Fe)=>{for(var A in Fe||(Fe={}))Ca.call(Fe,A)&&Xo(bt,A,Fe[A]);if(Qo)for(var A of Qo(Fe))ba.call(Fe,A)&&Xo(bt,A,Fe[A]);return bt},Ht=(bt,Fe)=>_a(bt,ya(Fe));(self.webpackChunkangular_challenge=self.webpackChunkangular_challenge||[]).push([[126],{3126:(bt,Fe,A)=>{A.r(Fe),A.d(Fe,{ProductsModule:()=>ha});var w=A(9808),ye=A(1083),Ve=A(7579),X=A(1135),q=A(8372),Ee=A(3900),Oe=A(8505),be=A(2722),ae=A(9646),Te=A(8746),ke=A(262),ve=A(1365),ie=A(2382),Se=A(6364),ot=A(158),e=A(5e3),Ke=A(4351),Ie=A(736),fe=A(520);let _e=(()=>{class r extends Ie.b{constructor(o){super(o,"products")}getCategories(){return this.http.get(`${this.url}/products/categories`)}searchProduct(o){return this.http.get(`${this.url}/products/search`,{params:o})}}return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275inject(fe.eN))},r.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var le=A(1422),te=A(6693);function Xe(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",1)(2,"div",2)(3,"div",3)(4,"div")(5,"span",4),e.\u0275\u0275text(6,"Delete "),e.\u0275\u0275elementStart(7,"span",5),e.\u0275\u0275text(8),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(9," ?"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(10,"div",6)(11,"button",7),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).closeDialog()}),e.\u0275\u0275text(12," No "),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"button",8),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).deleteProduct()}),e.\u0275\u0275text(14," Yes "),e.\u0275\u0275elementEnd()()()()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const o=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(8),e.\u0275\u0275textInterpolate(o.product.title),e.\u0275\u0275advance(3),e.\u0275\u0275property("disabled","pending"===o.isLoading),e.\u0275\u0275advance(2),e.\u0275\u0275property("showLoader","pending"===o.isLoading)}}function Ye(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Xe,15,3,"ng-container",0),e.\u0275\u0275elementContainerEnd()),2&r){const o=p.ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.product)}}let $e=(()=>{class r{constructor(o,u){this.productsService=o,this.alertService=u,this.product=null,this.onClose=new e.EventEmitter(!1),this.subject$=new Ve.x,this.state$=new X.X({product:null,isLoading:Se.q.Idle}),this.vm$=this.state$.asObservable()}ngOnInit(){this.patchState({product:this.product})}ngOnDestroy(){this.state$.complete(),this.subject$.complete()}closeDialog(o=!1){this.onClose.emit(o)}deleteProduct(){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,Oe.b)(()=>this.patchState({isLoading:Se.q.Pending})),(0,ve.M)(this.state$),(0,Ee.w)(([,{product:o}])=>this.productsService.delete(+o.id).pipe((0,Oe.b)(()=>this.closeDialog(!0)),(0,Te.x)(()=>this.patchState({isLoading:Se.q.Done})),(0,Ke.b)(()=>this.alertService.success("Delete Successfully!")),(0,ke.K)(u=>this.alertService.error(u.error.message||u.message))))).subscribe()}patchState({product:o,isLoading:u}){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,ve.M)(this.state$),(0,Oe.b)(([,_])=>{this.state$.next(Object.assign(Object.assign({},_),{product:o||_.product,isLoading:u||_.isLoading}))})).subscribe()}}return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(_e),e.\u0275\u0275directiveInject(le.c))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-product-delete"]],inputs:{product:"product"},outputs:{onClose:"onClose"},decls:2,vars:3,consts:[[4,"ngIf"],[1,"absolute","inset-0","z-10","h-screen","w-screen",2,"background","rgba(0, 0, 0, 0.75)"],[1,"flex","h-full","justify-center","items-center"],[1,"dark:bg-gray-800","bg-white","rounded-xl","shadow-2xl","p-6","md:w-1/2","xl:w-1/3"],[1,"tui-text_h5","dark:text-gray-300","text-gray-700"],[1,"tui-text_h3","dark:text-gray-500","text-gray-900"],[1,"mt-10","flex","justify-end","space-x-5"],["tuiButton","","size","m","appearance","secondary",1,"w-20",3,"disabled","click"],["tuiButton","","size","m","appearance","accent",1,"w-20",3,"showLoader","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Ye,2,1,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,u.vm$))},directives:[w.O5,te.v0],pipes:[w.Ov],styles:[""],changeDetection:0}),r})();var Ge=A(3996),ze=A(5635),Mt=A(4023),Me=A(6907),re=A(9627),O=A(7672),L=A(8453),$=A(1594),Q=A(5489);let Dt=(()=>{let r=class{transform(o){return function Le(r){const p=function jt(r){return null===r||"string"==typeof r?r||"":(0,Q.S)(String(r),3,"0")}(r);return function We(r){switch(r){case"RUB":case"643":return"\u20bd";case"USD":case"840":case"MXN":case"484":return"$";case"SGD":case"702":return"S$";case"AUD":case"036":return"A$";case"HKD":case"344":return"HK$";case"CAD":case"124":return"C$";case"EUR":case"978":return"\u20ac";case"GBP":case"826":return"\xa3";case"THB":case"764":return"\u0e3f";case"TRY":case"949":return"\u20ba";case"CNY":case"156":return"CN\xa5";case"JPY":case"392":return"\xa5";case"ILS":case"376":return"\u20aa";case"INR":case"356":return"\u20b9";case"CHF":case"756":return"\u20a3";case"AMD":case"051":return"\u058f";case"KRW":case"410":return"\u20a9";case"KZT":case"398":return"\u20b8";case"UAH":case"980":return"\u20b4";default:return null}}(p)||p}(o)}};return r.\u0275fac=function(o){return new(o||r)},r.\u0275pipe=e.\u0275\u0275definePipe({name:"tuiCurrency",type:r,pure:!0}),r})(),N=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({}),r})();const S=function(r){return["/products/detail",r]},E=function(r){return["/products/update",r]};function F(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tr",14)(1,"td",15),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"td",15),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(5,"td",15),e.\u0275\u0275text(6),e.\u0275\u0275pipe(7,"tuiCurrency"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"td",15),e.\u0275\u0275text(9),e.\u0275\u0275pipe(10,"tuiFormatNumber"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(11,"td",15),e.\u0275\u0275text(12),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(13,"td",15)(14,"a",16),e.\u0275\u0275text(15,"Detail"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(16," | "),e.\u0275\u0275elementStart(17,"a",17),e.\u0275\u0275text(18,"Update"),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(19," | "),e.\u0275\u0275elementStart(20,"a",18),e.\u0275\u0275listener("click",function(){const T=e.\u0275\u0275restoreView(o).$implicit;return e.\u0275\u0275nextContext(3).deleteProduct(T)}),e.\u0275\u0275text(21,"Delete "),e.\u0275\u0275elementEnd()()()}if(2&r){const o=p.$implicit;e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.title),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate(o.category),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2(" ",o.price,"",e.\u0275\u0275pipeBind1(7,8,"USD")," "),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate(e.\u0275\u0275pipeBind1(10,10,o.stock)),e.\u0275\u0275advance(3),e.\u0275\u0275textInterpolate1("",o.discountPercentage,"%"),e.\u0275\u0275advance(2),e.\u0275\u0275property("routerLink",e.\u0275\u0275pureFunction1(12,S,o.id)),e.\u0275\u0275advance(3),e.\u0275\u0275property("routerLink",e.\u0275\u0275pureFunction1(14,E,o.id))}}function z(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div")(1,"tui-pagination",19),e.\u0275\u0275listener("indexChange",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).goToPage(_)}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("activePadding",2)("length",o.pagination.totalPage)("index",+o.pagination.currentPage)}}function V(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",5)(2,"tui-input",6),e.\u0275\u0275text(3,"Search product"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",7),e.\u0275\u0275text(5,"Add New"),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(6,"div",8)(7,"table",9)(8,"tbody")(9,"tr",10)(10,"th",11),e.\u0275\u0275text(11,"Title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(12,"th",11),e.\u0275\u0275text(13,"Category"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(14,"th",11),e.\u0275\u0275text(15,"Price"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(16,"th",11),e.\u0275\u0275text(17,"Stock"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"th",11),e.\u0275\u0275text(19,"Discount Percentage"),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(20,"th",12),e.\u0275\u0275text(21," Actions "),e.\u0275\u0275elementEnd()(),e.\u0275\u0275template(22,F,22,16,"tr",13),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275template(23,z,2,3,"div",1),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext().ngIf,u=e.\u0275\u0275nextContext();e.\u0275\u0275advance(2),e.\u0275\u0275property("formControl",u.query),e.\u0275\u0275advance(20),e.\u0275\u0275property("ngForOf",o.products),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.pagination)}}function Z(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,V,24,3,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&r){const o=p.ngIf;e.\u0275\u0275nextContext();const u=e.\u0275\u0275reference(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pending"!==o.isLoading)("ngIfElse",u)}}function ee(r,p){1&r&&e.\u0275\u0275element(0,"app-loading")}function de(r,p){}let me=(()=>{class r{constructor(o,u){this.productsService=o,this.alertService=u,this.subject$=new Ve.x,this.state$=new X.X({products:[],isLoading:Se.q.Idle,pagination:null}),this.vm$=this.state$.asObservable(),this.query=new ie.FormControl("")}ngOnInit(){this.getProducts(),this.query.valueChanges.pipe((0,q.b)(300),(0,Ee.w)(o=>this.productsService.searchProduct({q:`${o}`.trim()}).pipe((0,Oe.b)(u=>{console.log(u),this.patchState({products:u.products,pagination:{totalResult:u.total,totalPage:Math.ceil(u.total/Ge.p),currentPage:1}})})))).subscribe()}ngOnDestroy(){this.subject$.complete(),this.state$.complete()}deleteProduct(o){const u=this.showDialogDelete.viewContainerRef;u.clear();const _=u.createComponent($e);_.instance.product=o,_.instance.onClose.pipe((0,be.R)(this.subject$)).subscribe(T=>{u.clear(),T&&this.getProducts()})}goToPage(o){this.getProducts(""+o*Ge.p)}getProducts(o="0"){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,Oe.b)(()=>this.patchState({isLoading:Se.q.Pending})),(0,Ee.w)(()=>this.productsService.getPagination(o,Ge.p).pipe((0,Oe.b)(u=>this.patchState({products:u.products,pagination:{totalResult:u.total,totalPage:Math.ceil(u.total/Ge.p),currentPage:Math.floor(+o/Ge.p)}})),(0,Te.x)(()=>this.patchState({isLoading:Se.q.Done})),(0,ke.K)(u=>this.alertService.error(u.error.message||u.message))))).subscribe()}patchState({products:o,isLoading:u,pagination:_}){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,ve.M)(this.state$),(0,Oe.b)(([,T])=>{this.state$.next(Object.assign(Object.assign({},T),{products:o||T.products,isLoading:u||T.isLoading,pagination:_||T.pagination}))})).subscribe()}}return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(_e),e.\u0275\u0275directiveInject(le.c))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-products"]],viewQuery:function(o,u){if(1&o&&e.\u0275\u0275viewQuery(ot.t,5),2&o){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(u.showDialogDelete=_.first)}},decls:6,vars:3,consts:[[1,"dark:bg-gray-800","rounded-xl","p-6","h-full","flex","flex-col","space-y-10"],[4,"ngIf"],["showLoading",""],["appAlert",""],[4,"ngIf","ngIfElse"],[1,"flex","space-x-6"],["tuiTextfieldExampleText","Enter query...","tuiTextfieldSize","m","tuiAutoFocus","true",1,"w-full",3,"formControl"],["tuiButton","","size","m","icon","tuiIconPlus","routerLink","/products/create"],[1,"h-full"],[1,"tui-table"],[1,"tui-table__tr_border_top"],[1,"tui-table__th","tui-table__th_font-size_l"],[1,"tui-table__th","tui-table__th_font-size_l","w-52"],["class","tui-table__tr tui-table__tr_border_top",4,"ngFor","ngForOf"],[1,"tui-table__tr","tui-table__tr_border_top"],[1,"tui-table__td"],["tuiLink","",3,"routerLink"],["tuiLink","","mode","positive",3,"routerLink"],["tuiLink","","mode","negative",3,"click"],[3,"activePadding","length","index","indexChange"]],template:function(o,u){1&o&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Z,2,2,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,ee,1,0,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,de,0,0,"ng-template",3)),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,u.vm$)))},directives:[w.O5,ze.K3,ze.wU,Me._K,Me.sz,L.k,ie.NgControlStatus,ie.FormControlDirective,te.v0,ye.rH,w.sg,re.V,ye.yS,Mt.r5,$.N,ot.t],pipes:[w.Ov,Dt,O.m],styles:[""],changeDetection:0}),r})();var k=A(758);function c(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"span",6),e.\u0275\u0275text(2,"Product "),e.\u0275\u0275elementStart(3,"span",7),e.\u0275\u0275text(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275text(5," loaded."),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate(o.product.title)}}function f(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"div",5),e.\u0275\u0275template(2,c,6,1,"ng-container",4),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275nextContext();const u=e.\u0275\u0275reference(6);e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.product)("ngIfElse",u)}}function g(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,f,3,2,"ng-container",4),e.\u0275\u0275elementContainerEnd()),2&r){const o=p.ngIf;e.\u0275\u0275nextContext();const u=e.\u0275\u0275reference(4);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf","pending"!==o.isLoading)("ngIfElse",u)}}function v(r,p){1&r&&e.\u0275\u0275element(0,"app-loading")}function M(r,p){1&r&&e.\u0275\u0275element(0,"app-load-error",8),2&r&&e.\u0275\u0275property("message","Category")}let P=(()=>{class r{constructor(o,u,_,T){this.route=o,this.router=u,this.productsService=_,this.alertService=T,this.subject$=new Ve.x,this.state$=new X.X({product:null,isLoading:Se.q.Idle}),this.vm$=this.state$.asObservable(),this.patchState({isLoading:Se.q.Pending})}ngOnInit(){this.getProduct()}ngOnDestroy(){this.subject$.complete(),this.state$.complete()}getProduct(){this.route.params.pipe((0,be.R)(this.subject$),(0,Ee.w)(({slug:o})=>o?this.productsService.getOne(o).pipe((0,Oe.b)(u=>this.patchState({product:u})),(0,Te.x)(()=>this.patchState({isLoading:Se.q.Done})),(0,ke.K)(u=>this.alertService.error(u.error.message||u.message))):(0,ae.of)(""))).subscribe()}patchState({product:o,isLoading:u}){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,ve.M)(this.state$),(0,Oe.b)(([,_])=>{this.state$.next(Object.assign(Object.assign({},_),{product:o||_.product,isLoading:u||_.isLoading}))})).subscribe()}}return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(ye.gz),e.\u0275\u0275directiveInject(ye.F0),e.\u0275\u0275directiveInject(_e),e.\u0275\u0275directiveInject(le.c))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-product-detail"]],decls:7,vars:3,consts:[[1,"dark:bg-gray-800","rounded-xl","p-6","h-full","flex","flex-col","space-y-10"],[4,"ngIf"],["showLoading",""],["errorData",""],[4,"ngIf","ngIfElse"],[1,"text-center","mt-10"],[1,"tui-text_h5","text-gray-300"],[1,"tui-text_h3","text-gray-500"],[3,"message"]],template:function(o,u){1&o&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,g,2,2,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,v,1,0,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275template(5,M,1,1,"ng-template",null,3,e.\u0275\u0275templateRefExtractor)),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,u.vm$)))},directives:[w.O5,$.N,k.N],pipes:[w.Ov],styles:[""],changeDetection:0}),r})();var B=A(4004),J=A(8062),K=(()=>{return(r=K||(K={})).Undo="undo",r.Size="fontSize",r.Bold="bold",r.Italic="italic",r.Underline="underline",r.Strikethrough="strikeThrough",r.Align="justify",r.List="list",r.Quote="quote",r.Color="foreColor",r.Hilite="hiliteColor",r.Clear="clear",r.Link="link",r.Attach="attach",r.Tex="tex",r.Code="code",r.Img="image",r.HR="insertHorizontalRule",r.Sup="superscript",r.Sub="subscript",r.Table="insertTable",r.MergeCells="mergeCells",r.SplitCells="splitCells",r.RowsColumnsManaging="rowsColumnsManaging",r.Details="details",K;var r})();const ge=new Map([["color-black-300","#333333"],["color-black-200","#666666"],["color-black-100","#909090"],["color-yellow-100","#FFDD2C"],["color-yellow-200","#FCC521"],["color-yellow-300","#FAB618"],["color-gray-100","#f5f5f6"],["color-gray-200","#e7e8ea"],["color-gray-300","#cbcfd3"],["color-gray-400","#959ba4"],["color-gray-500","#79818c"],["color-gray-600","#616871"],["color-light-blue-100","#ecf1f7"],["color-light-blue-200","#e4ebf3"],["color-light-blue-300","#dde4ed"],["color-blue-100","#1771e6"],["color-blue-200","#1464cc"],["color-blue-300","#0953b3"],["color-green-100","#39b54a"],["color-green-200","#2ca53a"],["color-green-300","#168a21"],["color-red-100","#e01f19"],["color-red-200","#d3120e"],["color-red-300","#c40b08"]]),sn=[K.Undo,K.Size,K.Bold,K.Italic,K.Underline,K.Align,K.List,K.Quote,K.Link,K.Color,K.Hilite,K.Clear,K.Strikethrough,K.Code,K.Img,K.HR,K.Sup,K.Sub,K.Table,K.Details];var $n=A(2395),qe=A(988),Nn=A(4707);const Et=new e.InjectionToken("Extensions for editor"),yn=new e.InjectionToken("lazy extensions"),Cn={colors:ge,blankColor:"rgb(51, 51, 51)",fontOptions:function Ki(r){return[{px:13,name:r.small},{px:15,name:r.normal},{px:17,name:r.large},{px:24,family:"var(--tui-font-heading)",name:r.subtitle,headingLevel:2,weight:"bold"},{px:30,family:"var(--tui-font-heading)",name:r.title,headingLevel:1,weight:"bold"}]}},kt=new e.InjectionToken("Default Editor colors",{factory:()=>Cn}),oi=new e.InjectionToken("Styles for Editor",{factory:()=>"\n@import 'https://fonts.googleapis.com/css2?family=Manrope:wght@500;800&display=swap';\n\nbody.tui-editor-socket {\n    margin: 0;\n    overflow: hidden;\n    padding: 0 16px;\n}\n\np:empty:before {\n    content: ' ';\n    white-space: pre;\n}\n\n.tui-editor-socket {\n    display: block;\n    color: #333;\n    font-size: 15px;\n    font-family: tuiText, 'Manrope', sans-serif;\n    line-height: 24px;\n}\n\n.tui-editor-socket ul,\n.tui-editor-socket ol {\n    list-style-type: none;\n    margin: 16px 16px 16px 24px;\n    padding: 0;\n}\n\n.tui-editor-socket li {\n    margin: 16px 0;\n}\n\n.tui-editor-socket ul li:before {\n    content: '';\n    display: inline-block;\n    width: 8px;\n    height: 8px;\n    border-radius: 100%;\n    margin: 0 14px 1px -22px;\n    background-color: #ffdd2d;\n}\n\n.tui-editor-socket ol {\n    counter-reset: counter;\n}\n\n.tui-editor-socket ol li:before {\n    content: counter(counter) '.';\n    width: 24px;\n    margin: 0 12px 0 -24px;\n    counter-increment: counter;\n    color: #909090;\n}\n\n.tui-editor-socket pre {\n    white-space: pre-wrap;\n    word-break: break-word;\n    border-radius: 4px;\n    margin: 16px 0;\n    padding: 12px 16px;\n    font-family: 'Courier', monospace;\n    color: #666666;\n    background-color: #f5f5f6;\n}\n\n.tui-editor-socket pre + pre {\n    margin-top: -29px;\n    padding-top: 0;\n}\n\n.tui-editor-socket blockquote {\n    margin: 20px 0 20px 24px !important;\n    padding-left: 17px !important;\n    border-left: 1px solid #cbcfd3 !important;\n}\n\n.tui-editor-socket p {\n    margin: 16px 0;\n}\n\n.tui-editor-socket a {\n    color: #3d7ab6;\n    text-decoration: none;\n    outline: none;\n}\n\n.tui-editor-socket a:hover {\n    text-decoration: underline;\n}\n\n.tui-editor-socket a:hover {\n    color: #369;\n}\n\n.tui-editor-socket a:active {\n    color: #29527c;\n}\n\n.tui-editor-socket hr {\n    border: none;\n    border-top: 1px solid #e7e8ea;\n    margin: 16px 0;\n}\n\n.tui-editor-socket font[face='Courier New'] {\n    padding: 4px 8px;\n    border-radius: 4px;\n    background-color: #ecf1f7;\n    display: inline-block;\n    word-break: break-word;\n}\n\n.tui-editor-socket font[size='1'] {\n    font-size: 11px;\n    line-height: 16px;\n}\n\n.tui-editor-socket font[size='2'] {\n    font-size: 13px;\n    line-height: 20px;\n}\n\n.tui-editor-socket font[size='3'] {\n    font-size: 15px;\n    line-height: 24px;\n}\n\n.tui-editor-socket font[size='4'] {\n    font-size: 17px;\n    line-height: 24px;\n}\n\n.tui-editor-socket font[size='5'],\n.tui-editor-socket font[size='6'],\n.tui-editor-socket font[size='7'] {\n    display: block;\n    margin: 32px 0 16px;\n    font-family: var(--tui-font-heading);\n}\n\n.tui-editor-socket font[size='5'] {\n    font-size: 24px;\n    line-height: 28px;\n}\n\n.tui-editor-socket font[size='6'] {\n    font-size: 30px;\n    line-height: 36px;\n}\n\n.tui-editor-socket font[size='7'] {\n    font-size: 40px;\n    line-height: 44px;\n}\n"}),Ne=(new e.InjectionToken("tui-color-selector i18n",{factory:()=>["Solid color","Gradient"]}),new e.InjectionToken("tui-editor-toolbar i18n",{factory:(0,$n.Ho)("toolbarTools")})),si=new e.InjectionToken("tui-editor-toolbar table i18n",{factory:(0,$n.Ho)("editorTableCommands")}),Ni=new e.InjectionToken("tui-editor-toolbar codes options",{factory:(0,$n.Ho)("editorCodeOptions")}),Ri=new e.InjectionToken("tui-editor-toolbar font options",{factory:(0,$n.Ho)("editorFontOptions")}),li=new e.InjectionToken("Image loader handler",{factory:()=>r=>{const p=new FileReader;return p.readAsDataURL(r),(0,qe.eh)(p,"load").pipe((0,B.U)(()=>String(p.result)))}}),$t=new e.InjectionToken("Token for Tiptap Editor"),ai=new e.InjectionToken("Lazy loaded Editor",{factory:()=>{const r=new Nn.t(1);return Promise.resolve().then(A.bind(A,9220)).then(p=>r.next(p.Editor)),r}}),Zt=new e.InjectionToken("The container in which the tip-tap editor is initialized");A(7792);var Un=A(9220),Be=A(6579),dt=A(6956);const Ai=Un.Extension.create({name:"backgroundColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{backgroundColor:{default:null,renderHTML:({backgroundColor:r})=>r?{style:`background-color: ${r}`}:{},parseHTML:({style:r})=>r.backgroundColor.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setBackgroundColor:r=>({chain:p})=>p().setMark("textStyle",{backgroundColor:r}).run(),unsetBackgroundColor:()=>({chain:r})=>r().setMark("textStyle",{backgroundColor:null}).run()})});var Wn=Object.freeze({__proto__:null,BackgroundColor:Ai});const Rn=[A.e(809).then(A.bind(A,4809)).then(function Jn(r){return r.default}).then(function Kn(r){return r.configure({heading:{levels:[1,2]}})}),A.e(928).then(A.bind(A,7928)).then(r=>r.default.configure({types:["heading","paragraph"]})),Promise.resolve().then(A.bind(A,7792)).then(r=>r.default),A.e(738).then(A.bind(A,6738)).then(r=>r.default),A.e(544).then(A.bind(A,7544)).then(r=>r.default),A.e(202).then(A.bind(A,6202)).then(r=>r.default),Promise.resolve().then(function(){return Yn}).then(r=>r.FontColor),A.e(607).then(A.bind(A,607)).then(r=>r.default.configure({inline:!0})),A.e(903).then(A.bind(A,4903)).then(r=>r.default.configure({openOnClick:!1})),Promise.resolve().then(function(){return Wn}).then(r=>r.BackgroundColor),A.e(538).then(A.bind(A,9538)).then(r=>r.default.configure({resizable:!0,lastColumnResizable:!1})),A.e(573).then(A.bind(A,4573)).then(r=>r.default),A.e(649).then(A.bind(A,2649)).then(r=>r.default),A.e(956).then(A.bind(A,4956)).then(r=>r.TableHeader),Promise.resolve().then(function(){return Gi}).then(r=>r.Indent),Promise.resolve().then(function(){return fi}).then(r=>r.TableCellBackground),A.e(20).then(A.bind(A,9020)).then(r=>r.TuiDetailsContent),A.e(20).then(A.bind(A,9020)).then(r=>r.TuiDetails),A.e(20).then(A.bind(A,9020)).then(r=>r.TuiSummary),A.e(600).then(A.bind(A,6600)).then(({TuiFontSize:r})=>r)],Bt=Un.Extension.create({name:"fontColor",addOptions:()=>({types:["textStyle"]}),addGlobalAttributes(){return[{types:this.options.types,attributes:{fontColor:{default:null,renderHTML:({fontColor:r})=>r?{style:`color: ${r}`}:{},parseHTML:({style:r})=>r.color.replace(/['"]+/g,""),keepOnSplit:!1}}}]},addCommands:()=>({setFontColor:r=>({chain:p})=>p().setMark("textStyle",{fontColor:r}).run(),unsetFontColor:()=>({chain:r})=>r().setMark("textStyle",{fontColor:null}).run()})});var Yn=Object.freeze({__proto__:null,FontColor:Bt}),wt=(()=>{return(r=wt||(wt={}))[r.Min=0]="Min",r[r.min=0]="min",r[r.Max=210]="Max",r[r.max=210]="max",r[r.More=30]="More",r[r.more=30]="more",r[r.Less=-30]="Less",r[r.less=-30]="less",wt;var r})();function ui({type:r}){return"bullet_list"===r.name}function di({type:r}){return"order_list"===r.name}function Bi({type:r}){return"todo_list"===r.name}function Gn(r){return ui(r)||di(r)||Bi(r)}function Qt(r){return r.isActive("bulletList")||r.isActive("orderedList")}function pi(r,p){const{doc:o,selection:u}=r;if(!o||!u||!(u instanceof dt.Bs||u instanceof dt.C1))return r;const{from:_,to:T}=u;return o.nodesBetween(_,T,(j,G)=>{const{name:Ce}=j.type;return"paragraph"===Ce||"heading"===Ce?(r=function Fi(r,p,o){if(!r.doc)return r;const u=r.doc.nodeAt(p);if(!u)return r;const j=(0,Be.uZ)((u.attrs.indent||0)+o,wt.min,wt.max);if(j===u.attrs.indent)return r;const G=Object.assign(Object.assign({},u.attrs),{indent:j});return r.setNodeMarkup(p,u.type,G,u.marks)}(r,G,p),!1):!Gn(j)}),r}const Yi=Un.Extension.create({name:"indent",addOptions:()=>({types:["heading","paragraph"],indentLevels:[0,30,60,90,120,150,180,210],defaultIndentLevel:0}),addGlobalAttributes(){return[{types:this.options.types,attributes:{indent:{default:this.options.defaultIndentLevel,renderHTML:({indent:r})=>r?{style:`margin-left: ${r}px;`}:{},parseHTML:({style:r})=>parseInt(r.marginLeft,10)||this.options.defaultIndentLevel,keepOnSplit:!1}}}]},addCommands:()=>({indent:()=>({tr:r,state:p,dispatch:o})=>{const{selection:u}=p;return!(!(r=pi(r=r.setSelection(u),wt.more)).docChanged||!o||(o(r),0))},outdent:()=>({tr:r,state:p,dispatch:o})=>{const{selection:u}=p;return!(!(r=pi(r=r.setSelection(u),wt.less)).docChanged||!o||(o(r),0))}}),addKeyboardShortcuts(){return{Tab:()=>Qt(this.editor)?null:this.editor.commands.indent(),"Shift-Tab":()=>Qt(this.editor)?null:this.editor.commands.indent()}}});var Gi=Object.freeze({__proto__:null,get IndentProps(){return wt},isBulletListNode:ui,isOrderedListNode:di,isTodoListNode:Bi,isListNode:Gn,tuiIsOrderedOrBulletList:Qt,Indent:Yi});const zi=Un.Extension.create({addGlobalAttributes:()=>[{types:["tableCell","tableHeader"],attributes:{background:{default:null,renderHTML:({background:r})=>r?{style:`background: ${r}`}:null,parseHTML:({style:r})=>r.background,keepOnSplit:!1}}}],addCommands:()=>({setCellBackground:r=>({chain:p})=>p().updateAttributes("tableCell",{background:r}).updateAttributes("tableHeader",{background:r}).run(),unsetCellBackground:()=>({chain:r})=>r().updateAttributes("tableCell",{background:null}).updateAttributes("tableHeader",{background:null}).run()})});var fi=Object.freeze({__proto__:null,TableCellBackground:zi}),hi=A(535),Xt=A(5927),qt=A(284),Ut=A(4992),it=A(6249),mi=A(2079);function Zi(r,p){if(1&r&&e.\u0275\u0275element(0,"tui-data-list-wrapper",18),2&r){const o=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275property("items",o.categories)}}function Zn(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"form",3),e.\u0275\u0275listener("ngSubmit",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onSubmit()}),e.\u0275\u0275elementStart(2,"div",4)(3,"div",5)(4,"tui-input",6),e.\u0275\u0275text(5,"Title"),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(6,"tui-field-error",7),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(7,"div",5)(8,"tui-select",8),e.\u0275\u0275text(9," Category "),e.\u0275\u0275template(10,Zi,1,1,"tui-data-list-wrapper",9),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(11,"tui-field-error",10),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(12,"div",11)(13,"div",5)(14,"tui-input-number",12),e.\u0275\u0275pipe(15,"tuiCurrency"),e.\u0275\u0275text(16," Price "),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(17,"tui-field-error",13),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(18,"div",5)(19,"tui-input-number",14),e.\u0275\u0275text(20," Discount Percentage "),e.\u0275\u0275elementEnd(),e.\u0275\u0275element(21,"tui-field-error",15),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementStart(22,"div",16)(23,"button",17),e.\u0275\u0275text(24),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const o=p.ngIf,u=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("formGroup",u.formProduct),e.\u0275\u0275advance(13),e.\u0275\u0275property("prefix",e.\u0275\u0275pipeBind1(15,5,"USD")),e.\u0275\u0275advance(5),e.\u0275\u0275property("prefix","%"),e.\u0275\u0275advance(4),e.\u0275\u0275property("showLoader","pending"===o.isLoading),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.isUpdate?"Update Product":"Create Product"," ")}}function Li(r,p){1&r&&e.\u0275\u0275element(0,"tui-loader",19)}let ft=(()=>{class r{constructor(o,u,_,T,j){this.fb=o,this.route=u,this.router=_,this.productsService=T,this.alertService=j,this.subject$=new Ve.x,this.state$=new X.X({product:null,categories:[""],isLoading:Se.q.Idle,isUpdate:!1}),this.vm$=this.state$.asObservable(),this.formProduct=null}ngOnInit(){this.initForm(),this.getProduct(),this.getCategories()}ngOnDestroy(){this.state$.complete(),this.subject$.complete()}initForm(){this.formProduct=this.fb.group({title:[null,[(0,J.b)("Title is required!")]],price:[null,[(0,J.b)("Price is required!")]],discountPercentage:[0],category:[null,[(0,J.b)("Category Id is required!")]]})}getProduct(){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,ve.M)(this.route.params),(0,Oe.b)(([,{slug:o}])=>{o&&this.patchState({isUpdate:!0})}),(0,Ee.w)(([,{slug:o}])=>o?this.productsService.getOne(o).pipe((0,Oe.b)(u=>{this.patchState({product:u}),this.formProduct.patchValue(Object.assign({},u))}),(0,ke.K)(u=>this.alertService.error(u.message))):(0,ae.of)(""))).subscribe()}getCategories(){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,Ee.w)(()=>this.productsService.getCategories().pipe((0,Oe.b)(o=>{this.patchState({categories:o}),this.formProduct.patchValue({category:o[0]})}),(0,ke.K)(o=>this.alertService.error(o.message))))).subscribe()}onSubmit(){if(this.formProduct.valid){const o=this.formProduct.getRawValue();this.createOrUpdateProduct(o)}else(0,J.m)(this.formProduct)}createOrUpdateProduct(o){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,Oe.b)(()=>this.patchState({isLoading:Se.q.Pending})),(0,B.U)(()=>o),(0,ve.M)(this.route.params),(0,Ee.w)(([u,{slug:_}])=>_?this.updateProduct(u,_):this.createProduct(u))).subscribe()}createProduct(o){return this.productsService.create(o).pipe((0,Oe.b)(()=>this.router.navigate(["/products"])),(0,Te.x)(()=>this.patchState({isLoading:Se.q.Done})),(0,Ke.b)(()=>this.alertService.success("Create successfully!")),(0,ke.K)(u=>this.alertService.error(u.error.message||u.message)))}updateProduct(o,u){return this.productsService.update(o,u).pipe((0,Oe.b)(()=>this.router.navigate(["/products"])),(0,Te.x)(()=>this.patchState({isLoading:Se.q.Done})),(0,Ke.b)(()=>this.alertService.success("Update successfully!")),(0,ke.K)(_=>this.alertService.error(_.message)))}patchState({product:o,isLoading:u,isUpdate:_,categories:T}){(0,ae.of)("").pipe((0,be.R)(this.subject$),(0,ve.M)(this.state$),(0,Oe.b)(([,j])=>{this.state$.next(Object.assign(Object.assign({},j),{isLoading:u||j.isLoading,product:o||j.product,isUpdate:_||j.isUpdate,categories:T||j.categories}))})).subscribe()}}return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(ie.FormBuilder),e.\u0275\u0275directiveInject(ye.gz),e.\u0275\u0275directiveInject(ye.F0),e.\u0275\u0275directiveInject(_e),e.\u0275\u0275directiveInject(le.c))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["app-product-add"]],features:[e.\u0275\u0275ProvidersFeature([{provide:Et,useValue:Rn}])],decls:5,vars:3,consts:[[1,"dark:bg-gray-800","rounded-xl","p-6","h-full","flex","flex-col","space-y-10"],[4,"ngIf"],["loading",""],[3,"formGroup","ngSubmit"],[1,"tui-row"],[1,"tui-col_6"],["tuiTextfieldSize","m","tuiTextfieldExampleText","Enter product title...","tuiAutoFocus","true","formControlName","title"],["formControlName","title",1,"absolute"],["tuiTextfieldSize","m","formControlName","category"],[3,"items",4,"tuiDataList"],["formControlName","image",1,"absolute"],[1,"tui-row","mt-10"],["tuiTextfieldSize","m","tuiTextfieldExampleText","Enter product price...","formControlName","price",3,"prefix"],["formControlName","price",1,"absolute"],["tuiTextfieldSize","m","tuiTextfieldExampleText","Enter discount percentage...","formControlName","discountPercentage",3,"prefix"],["formControlName","discountPercentage",1,"absolute"],[1,"mt-10","text-right"],["tuiButton","","size","m",3,"showLoader"],[3,"items"],[1,"loader"]],template:function(o,u){1&o&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275template(1,Zn,25,7,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Li,1,0,"ng-template",null,2,e.\u0275\u0275templateRefExtractor)),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,u.vm$)))},directives:[w.O5,ie.\u0275NgNoValidate,ie.NgControlStatusGroup,ie.FormGroupDirective,ze.K3,ze.wU,Me.sz,Me._K,L.k,ie.NgControlStatus,ie.FormControlName,hi.y,Xt.uJ,Xt.OI,it.gX,qt.eC,Ut.qS,Ut.g5,te.v0,mi.kM],pipes:[w.Ov,Dt],styles:[".editor[_ngcontent-%COMP%]{max-height:18.75rem}"],changeDetection:0}),r})();const ht=[{path:"",component:me},{path:"detail/:slug",component:P},{path:"update/:slug",component:ft},{path:"create",component:ft}];let Qi=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[ye.Bz.forChild(ht)],ye.Bz]}),r})();var Xi=A(2271),U=A(2014),Je=A(5640),An=A(5113),Ft=A(6477),ce=A(3442),en=A(3703),Pt=A(3256),Bn=A(390),gi=A(2802),mt=A(5302);function _i(r){return isFinite(r)&&r>=0}A(2832);var bn=A(3618),xt=A(2997),Ci=A(102);const Hi=["dotLeft"],Fn=["dotRight"];function bi(r){return r>0}let vi=(()=>{let r=class extends mt.M${constructor(){super(...arguments),this.min=0,this.max=1/0,this.minLabel="",this.maxLabel="",this.segments=0,this.steps=0,this.quantum=1,this.keySteps=null,this.size="l",this.pluralizeMap=null,this.segmentsPluralizeMap=null,this.pluralizeMapFallback={one:"",few:"",many:"",other:""}}set pluralize(o){this.pluralizeMap=Array.isArray(o)?(0,Bn.KA)(o):o}set segmentsPluralize(o){this.segmentsPluralizeMap=Array.isArray(o)?(0,Bn.KA)(o):o}getTickPrefix(o,u,_){return 1!==u?"":0===o?`${_[0]}`:`${_[1]}`}get segmented(){return this.segments>0}get length(){return this.max-this.min}get computedSteps(){return this.steps||this.length/this.quantum}get step(){return this.length/this.computedSteps}get computedKeySteps(){return this.computePureKeySteps(this.keySteps,this.min,this.max)}onHovered(o){this.updateHovered(o)}computePureKeySteps(o,u,_){return[[0,u],...o||[],[100,_]]}};return r.\u0275fac=function(){let p;return function(u){return(p||(p=e.\u0275\u0275getInheritedFactory(r)))(u||r)}}(),r.\u0275dir=e.\u0275\u0275defineDirective({type:r,hostVars:3,hostBindings:function(o,u){2&o&&(e.\u0275\u0275attribute("data-size",u.size),e.\u0275\u0275classProp("_segmented",u.segmented))},inputs:{min:"min",max:"max",minLabel:"minLabel",maxLabel:"maxLabel",segments:"segments",steps:"steps",quantum:"quantum",keySteps:"keySteps",size:"size",pluralize:"pluralize",segmentsPluralize:"segmentsPluralize"},features:[e.\u0275\u0275InheritDefinitionFeature]}),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"min",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"max",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"minLabel",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"maxLabel",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"pluralize",null),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"segmentsPluralize",null),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"segments",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"steps",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)(bi,"Quantum must be positive")],r.prototype,"quantum",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"keySteps",void 0),(0,U.gn)([(0,e.Input)(),(0,e.HostBinding)("attr.data-size"),(0,ce.TH)()],r.prototype,"size",void 0),(0,U.gn)([ce.UM],r.prototype,"getTickPrefix",null),(0,U.gn)([(0,e.HostBinding)("class._segmented")],r.prototype,"segmented",null),(0,U.gn)([ce.UM],r.prototype,"computePureKeySteps",null),r})();const ji={s:8,m:16};let an=(()=>{let r=class extends mt.M${constructor(o,u,_,T){super(o,u),this.documentRef=_,this.fromToTexts$=T,this.pointerDown$=new Ve.x,this.min=0,this.max=1/0,this.segments=0,this.steps=0,this.quantum=0,this.size="m",this.keySteps=null,this.focusVisibleLeft=!1,this.focusVisibleRight=!1,this.pluralizeMap=null}set pluralize(o){this.pluralizeMap=Array.isArray(o)?(0,Bn.KA)(o):o}get segmented(){return this.segments>0}get discrete(){return this.steps>0}get length(){return this.max-this.min}get computedStep(){return this.steps?1/this.steps:this.quantum?this.quantum/this.length:.05}get isLeftFocusable(){return!this.disabled&&this.focusable&&100!==this.right}get isRightFocusable(){return!this.disabled&&this.focusable&&100!==this.left}ngOnInit(){super.ngOnInit();const o=(0,qe.eh)(this.documentRef,"mousemove"),u=(0,qe.eh)(this.documentRef,"mouseup"),_=(0,qe.eh)(this.documentRef,"touchmove"),T=(0,qe.eh)(this.documentRef,"touchend");let j;this.pointerDown$.pipe((0,B.U)(G=>{(0,An.HU)(G.currentTarget);const Ce=G.currentTarget.getBoundingClientRect(),pe=G instanceof MouseEvent?G.clientX:G.touches[0].clientX,Pe=(0,Be.uZ)(this.getFractionFromEvents(Ce,pe),0,1),tt=100*Pe-100+this.right;j=Math.abs(100*Pe-this.left)>Math.abs(tt)||tt>0||0===this.left&&100===this.right;const Lt=(0,Be.uZ)(this.getCalibratedFractionFromEvents(Ce,pe,j),0,1),Di=this.getValueFromFraction(this.fractionGuard(Lt));return this.processValue(Di,j),this.processFocus(j),Ce}),(0,Ee.w)(G=>(0,Ci.S)([_,o]).pipe((0,B.U)(Ce=>this.getCalibratedFractionFromEvents(G,Ce instanceof MouseEvent?Ce.clientX:Ce.touches[0].clientX,j)),(0,be.R)((0,Ci.S)([u,T])))),(0,B.U)(G=>this.fractionGuard(G))).subscribe(G=>{this.processValue(this.getValueFromFraction(G),j)})}ngOnDestroy(){super.ngOnDestroy(),this.pointerDown$.complete()}onMouseDown(o){this.disabled||(o.preventDefault(),this.pointerDown$.next(o))}onTouchStart(o){this.disabled||(o.preventDefault(),this.pointerDown$.next(o))}getSegmentLabel(o){return(0,Be.NM)(this.getValueFromFraction(o/this.segments),2)}getSegmentPrefix(o,u){return 1!==this.segments?"":0===o?`${u[0]} `:`${u[1]} `}onActiveZone(o){this.updateFocused(o)}onLeftFocusVisible(o){this.focusVisibleLeft=o}onRightFocusVisible(o){this.focusVisibleRight=o}getValueFromFraction(o){return null!==this.keySteps?this.fractionValueKeyStepConverter(o,!0):(0,Be.NM)(this.fractionGuard(o)*this.length+this.min,bn.bF)}fractionGuard(o){return(0,Be.uZ)(this.discrete?(0,Be.q$)(o,1/this.steps):o,0,1)}getFractionFromValue(o){const u=(o-this.min)/this.length;return null!==this.keySteps?this.fractionValueKeyStepConverter(o,!1):(0,Be.uZ)(Number.isFinite(u)?u:1,0,1)}getCalibratedFractionFromEvents(o,u,_){return this.getFractionFromEvents(o,u)}valueGuard(o){return(0,Be.uZ)(this.quantum?(0,Be.NM)(Math.round(o/this.quantum)*this.quantum,bn.bF):o,this.min,this.max)}processFocus(o){!this.focusable||!this.dotRight||!this.dotLeft||(0,Je.NY)(o?this.dotRight.nativeElement:this.dotLeft.nativeElement)}fractionValueKeyStepConverter(o,u){const _=[[0,this.min]].concat(this.keySteps,[[100,this.max]]);let T=0,j=100,G=this.min,Ce=this.max;for(let et=1;et<_.length;et++)if(u&&_[et][0]/100>o||!u&&_[et][1]>o){T=_[et-1][0]||0,j=_[et][0],G=_[et-1][1],Ce=_[et][1];break}const pe=j-T,Pe=Ce-G;return u?(0,Be.NM)((100*o-T)/pe*Pe+G,bn.bF):(0,Be.uZ)((o-G)/Pe*pe+T,0,100)/100}getFractionFromEvents(o,u){return(0,Be.NM)((u-o.left-ji[this.size]/2)/(o.width-ji[this.size]),bn.bF)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(ie.NgControl),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Document),e.\u0275\u0275directiveInject(xt.Te))},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,viewQuery:function(o,u){if(1&o&&(e.\u0275\u0275viewQuery(Hi,5,e.ElementRef),e.\u0275\u0275viewQuery(Fn,5,e.ElementRef)),2&o){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(u.dotLeft=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(u.dotRight=_.first)}},hostVars:3,hostBindings:function(o,u){2&o&&(e.\u0275\u0275attribute("data-size",u.size),e.\u0275\u0275classProp("_segmented",u.segmented))},inputs:{min:"min",max:"max",segments:"segments",steps:"steps",quantum:"quantum",size:"size",keySteps:"keySteps",pluralize:"pluralize"},features:[e.\u0275\u0275InheritDefinitionFeature]}),(0,U.gn)([(0,e.ViewChild)("dotLeft",{read:e.ElementRef})],r.prototype,"dotLeft",void 0),(0,U.gn)([(0,e.ViewChild)("dotRight",{read:e.ElementRef})],r.prototype,"dotRight",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"min",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"max",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"segments",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"steps",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)(_i,"Quantum must be a non-negative number")],r.prototype,"quantum",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"pluralize",null),(0,U.gn)([(0,e.Input)(),(0,e.HostBinding)("attr.data-size"),(0,ce.TH)()],r.prototype,"size",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"keySteps",void 0),(0,U.gn)([(0,e.HostBinding)("class._segmented")],r.prototype,"segmented",null),r=(0,U.gn)([(0,U.fM)(3,(0,e.Inject)(xt.Te))],r),r})();var Ti=A(5063),zn=A(2836),Nt=A(8634),Ze=A(8907),eo=A(7940),gt=A(295),vn=A(5698),xn=(A(9718),A(9300),A(2620)),pt=A(9751),cn=A(6451),Rt=A(9841);const lt=["type","range","tuiSlider",""];function at(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"i18nPlural"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2).$implicit,u=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(2,1,u.getSegmentLabel(o),u.pluralizeMap)," ")}}function Wt(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span",12),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"tuiFormatNumber"),e.\u0275\u0275template(3,at,3,4,"span",13),e.\u0275\u0275elementEnd()),2&r){const o=p.ngIf,u=e.\u0275\u0275nextContext().$implicit,_=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" ",_.getSegmentPrefix(u,o)," ",e.\u0275\u0275pipeBind1(2,3,_.getSegmentLabel(u))," "),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",_.pluralizeMap)}}function Vi(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span",10),e.\u0275\u0275template(1,Wt,4,5,"span",11),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,o.fromToTexts$))}}function Qn(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",8),e.\u0275\u0275template(1,Vi,3,3,"span",9),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiRepeatTimesOf",o.segments+1)}}const Xn={size:"m",trackColor:"var(--tui-base-03)"},Ln=new e.InjectionToken("Default parameters for Slider component",{factory:()=>Xn});let nn=(()=>{let r=class{constructor(o,u,_,T,j){var G;this.control=o,this.options=_,this.elementRef=T,this.userAgent=j,this.size=this.options.size,this.segments=1,o instanceof ie.NgModel&&(null===(G=o.valueChanges)||void 0===G||G.pipe((0,qe.YP)(u),(0,vn.q)(1)).subscribe())}get min(){return Number(this.elementRef.nativeElement.min)}get max(){return Number(this.elementRef.nativeElement.max||100)}get step(){return Number(this.elementRef.nativeElement.step)||1}get value(){const{elementRef:o,control:u}=this;return!o.nativeElement.hasAttribute("data-key-steps")&&u instanceof ie.NgModel?u.viewModel:Number(o.nativeElement.value)||0}set value(o){this.elementRef.nativeElement.value=`${o}`}get valuePercentage(){return 100*(this.value-this.min)/(this.max-this.min)||0}get segmentWidth(){return 100/Math.max(1,this.segments)}get isOldEdge(){return(0,zn.Q0)(Nt.FS,this.userAgent)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Ln),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(Ti.yZ))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["input","type","range","tuiSlider",""]],hostVars:9,hostBindings:function(o,u){1&o&&e.\u0275\u0275listener("input",function(){return 0}),2&o&&(e.\u0275\u0275attribute("data-size",u.size),e.\u0275\u0275styleProp("--tui-slider-track-color",u.options.trackColor)("--tui-slider-fill-percentage",u.valuePercentage,"%")("--tui-slider-segment-width",u.segmentWidth,"%"),e.\u0275\u0275classProp("_old-edge",u.isOldEdge))},inputs:{size:"size",segments:"segments"},attrs:lt,decls:0,vars:0,template:function(o,u){},styles:["[_nghost-%COMP%]{display:block;width:100%;color:var(--tui-primary);cursor:pointer}[_nghost-%COMP%]:active{cursor:ew-resize}[_nghost-%COMP%]:disabled{opacity:var(--tui-disabled-opacity);cursor:auto}[_nghost-%COMP%]:not(._old-edge){-webkit-appearance:none;-moz-appearance:none;appearance:none;height:.125rem;padding:.4375rem 0;background-color:transparent;background-clip:content-box;outline:0;border-radius:var(--tui-radius-m)}[_nghost-%COMP%]:not(._old-edge)::-webkit-slider-container{border-radius:inherit}[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-runnable-track{height:.125rem;border-radius:inherit;background-repeat:no-repeat;background-color:var(--tui-slider-track-color);background-image:linear-gradient(to right,currentColor 0 .625rem,transparent .25rem),repeating-linear-gradient(to right,var(--tui-base-07) 0 .25rem,transparent 0 var(--tui-slider-segment-width)),linear-gradient(to right,currentColor var(--tui-slider-fill-percentage),transparent var(--tui-slider-fill-percentage));background-position-x:0,.375rem,0;background-size:calc(100% - 1rem),calc(100% - 1rem),auto}[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-runnable-track{height:.125rem;border-radius:inherit;background-repeat:no-repeat;background-color:var(--tui-slider-track-color);background-image:linear-gradient(to right,currentColor 0 .375rem,transparent .25rem),repeating-linear-gradient(to right,var(--tui-base-07) 0 .25rem,transparent 0 var(--tui-slider-segment-width)),linear-gradient(to right,currentColor var(--tui-slider-fill-percentage),transparent var(--tui-slider-fill-percentage));background-position-x:0,.125rem,0;background-size:calc(100% - .5rem),calc(100% - .5rem),auto}[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-track{height:.125rem;border-radius:inherit;background-repeat:no-repeat;background-color:var(--tui-slider-track-color);background-image:linear-gradient(to right,currentColor 0 .625rem,transparent .25rem),repeating-linear-gradient(to right,var(--tui-base-07) 0 .25rem,transparent 0 var(--tui-slider-segment-width));background-position-x:0,.375rem;background-size:calc(100% - 1rem)}[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-track{height:.125rem;border-radius:inherit;background-repeat:no-repeat;background-color:var(--tui-slider-track-color);background-image:linear-gradient(to right,currentColor 0 .375rem,transparent .25rem),repeating-linear-gradient(to right,var(--tui-base-07) 0 .25rem,transparent 0 var(--tui-slider-segment-width));background-position-x:0,.125rem;background-size:calc(100% - .5rem)}[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;background-color:currentColor;border:none;border-radius:50%;height:1rem;width:1rem;margin-top:-.4375rem}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-thumb{cursor:ew-resize}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-thumb:hover{background:var(--tui-primary-hover)}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-thumb:active{background:var(--tui-primary-active)}:focus-visible[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-webkit-slider-thumb{box-shadow:0 0 0 2px inset var(--tui-focus)}[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-thumb{-webkit-appearance:none;appearance:none;background-color:currentColor;border:none;border-radius:50%;height:.5rem;width:.5rem;margin-top:-.1875rem}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-thumb{cursor:ew-resize}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-thumb:hover{background:var(--tui-primary-hover)}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-thumb:active{background:var(--tui-primary-active)}:focus-visible[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-webkit-slider-thumb{box-shadow:0 0 0 2px inset var(--tui-focus)}[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-thumb{-moz-appearance:none;appearance:none;background-color:currentColor;border:none;border-radius:50%;height:1rem;width:1rem}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-thumb{cursor:ew-resize}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-thumb:hover{background:var(--tui-primary-hover)}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-thumb:active{background:var(--tui-primary-active)}:focus-visible[_nghost-%COMP%]:not(._old-edge)[data-size='m']::-moz-range-thumb{box-shadow:0 0 0 2px inset var(--tui-focus)}[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-thumb{-moz-appearance:none;appearance:none;background-color:currentColor;border:none;border-radius:50%;height:.5rem;width:.5rem}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-thumb{cursor:ew-resize}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-thumb:hover{background:var(--tui-primary-hover)}:not(:disabled)[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-thumb:active{background:var(--tui-primary-active)}:focus-visible[_nghost-%COMP%]:not(._old-edge)[data-size='s']::-moz-range-thumb{box-shadow:0 0 0 2px inset var(--tui-focus)}[_nghost-%COMP%]:not(._old-edge)::-moz-range-progress{background:currentColor;border-radius:inherit;border-top-right-radius:0;border-bottom-right-radius:0}._old-edge[_nghost-%COMP%]::-ms-thumb{background:currentColor;border-radius:50%}._old-edge[_nghost-%COMP%]::-ms-fill-lower{background:currentColor}._old-edge[_nghost-%COMP%]::-ms-track{background:var(--tui-slider-track-color);border:none}"],changeDetection:0}),(0,U.gn)([(0,e.Input)(),(0,e.HostBinding)("attr.data-size"),(0,ce.TH)()],r.prototype,"size",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],r.prototype,"segments",void 0),(0,U.gn)([(0,e.HostBinding)("style.--tui-slider-fill-percentage.%")],r.prototype,"valuePercentage",null),(0,U.gn)([(0,e.HostBinding)("style.--tui-slider-segment-width.%")],r.prototype,"segmentWidth",null),(0,U.gn)([(0,e.HostBinding)("class._old-edge")],r.prototype,"isOldEdge",null),r=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(2,(0,e.Inject)(Ln)),(0,U.fM)(3,(0,e.Inject)(e.ElementRef)),(0,U.fM)(4,(0,e.Inject)(Ti.yZ))],r),r})(),un=(()=>{let r=class extends mt.M${constructor(o,u,_,T){super(o,u),this.elementRef=_,this.slider=T,this.keySteps=[],this.keyStepsInput=(0,qe.eh)(this.elementRef.nativeElement,"input").pipe((0,B.U)(()=>this.controlValue))}get nativeFocusableElement(){return this.computedDisabled?null:this.elementRef.nativeElement}get focused(){return(0,Je.zV)(this.nativeFocusableElement)}get min(){var o;return(null===(o=this.keySteps[0])||void 0===o?void 0:o[1])||0}get max(){var o;return(null===(o=this.keySteps[this.keySteps.length-1])||void 0===o?void 0:o[1])||100}get controlValue(){return(0,xn.hm)(this.slider.valuePercentage,this.keySteps)}updateControlValue(){this.updateValue(this.controlValue)}writeValue(o){if(null===o)return;const u=(0,Be.uZ)(o,this.min,this.max);An.zU.assert(o===u,"\n[SliderKeySteps]: You cannot programmatically set value which is less/more than min/max"),this.slider.value=this.transformToNativeValue(u)}getFallbackValue(){return 0}transformToNativeValue(o){const{min:u,max:_}=this.slider;return(0,xn.ox)(o,this.keySteps)*(_-u)/100+u}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(nn))},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["input","tuiSlider","","keySteps",""]],hostVars:4,hostBindings:function(o,u){1&o&&e.\u0275\u0275listener("change",function(){return u.updateControlValue()}),2&o&&e.\u0275\u0275attribute("data-key-steps",!0)("aria-valuenow",u.controlValue)("aria-valuemin",u.min)("aria-valuemax",u.max)},inputs:{keySteps:"keySteps"},outputs:{keyStepsInput:"keyStepsInput"},features:[e.\u0275\u0275InheritDefinitionFeature]}),(0,U.gn)([(0,e.Input)(),(0,ce.TH)(xn.G0,"Should contain min and max values")],r.prototype,"keySteps",void 0),(0,U.gn)([(0,e.Output)()],r.prototype,"keyStepsInput",void 0),(0,U.gn)([(0,e.HostListener)("change")],r.prototype,"updateControlValue",null),r=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(2,(0,e.Inject)(e.ElementRef)),(0,U.fM)(3,(0,e.Inject)(nn))],r),r})(),ki=(()=>{let r=class{transform(o,u,_){return(0,xn.hm)(100/u*o,_)}};return r.\u0275fac=function(o){return new(o||r)},r.\u0275pipe=e.\u0275\u0275definePipe({name:"tuiSliderTickLabel",type:r,pure:!0}),r})();var qn;let Jt=qn=class extends an{constructor(p,o,u,_){super(p,o,u,_)}get nativeFocusableElement(){return this.dotRight?this.dotRight.nativeElement:null}get focused(){return(0,Je.zV)(this.nativeFocusableElement)}get left(){return 0}get right(){return 100-100*this.getFractionFromValue(this.value)}processValue(p){this.updateValue(this.valueGuard(p))}decrement(){this.processStep(!1)}increment(){this.processStep(!0)}getFallbackValue(){return 0}processStep(p){const o=this.getFractionFromValue(this.value),u=this.computedStep,_=this.getValueFromFraction(p?o+u:o-u);this.processValue(_)}};Jt.\u0275fac=function(p){return new(p||Jt)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(w.K0),e.\u0275\u0275directiveInject(xt.Te))},Jt.\u0275cmp=e.\u0275\u0275defineComponent({type:Jt,selectors:[["tui-slider"]],features:[e.\u0275\u0275ProvidersFeature([{provide:Ft.KZ,useExisting:(0,e.forwardRef)(()=>qn)}]),e.\u0275\u0275InheritDefinitionFeature],decls:8,vars:11,consts:[[1,"event-catcher",3,"tuiActiveZoneChange","mousedown","touchstart"],[1,"wrapper"],["class","segments",4,"ngIf"],["automation-id","tui-slider__bar",1,"bar"],["automation-id","tui-slider__left",1,"dot",3,"tuiFocusable","tuiFocusVisibleChange","keydown.arrowLeft.prevent","keydown.arrowDown.prevent","keydown.arrowRight.prevent","keydown.arrowUp.prevent"],["dotLeft",""],["automation-id","tui-slider__right",1,"dot",3,"tuiFocusable","tuiFocusVisibleChange","keydown.arrowLeft.prevent","keydown.arrowDown.prevent","keydown.arrowRight.prevent","keydown.arrowUp.prevent"],["dotRight",""],[1,"segments"],["automation-id","tui-slider__segment","class","segment",4,"tuiRepeatTimes","tuiRepeatTimesOf"],["automation-id","tui-slider__segment",1,"segment"],["class","number",4,"ngIf"],[1,"number"],[4,"ngIf"]],template:function(p,o){1&p&&(e.\u0275\u0275elementStart(0,"div",0),e.\u0275\u0275listener("tuiActiveZoneChange",function(_){return o.onActiveZone(_)})("mousedown",function(_){return o.onMouseDown(_)})("touchstart",function(_){return o.onTouchStart(_)}),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275template(2,Qn,2,1,"div",2),e.\u0275\u0275elementStart(3,"div",3)(4,"div",4,5),e.\u0275\u0275listener("tuiFocusVisibleChange",function(_){return o.onLeftFocusVisible(_)})("keydown.arrowLeft.prevent",function(){return o.decrement()})("keydown.arrowDown.prevent",function(){return o.decrement()})("keydown.arrowRight.prevent",function(){return o.increment()})("keydown.arrowUp.prevent",function(){return o.increment()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"div",6,7),e.\u0275\u0275listener("tuiFocusVisibleChange",function(_){return o.onRightFocusVisible(_)})("keydown.arrowLeft.prevent",function(){return o.decrement()})("keydown.arrowDown.prevent",function(){return o.decrement()})("keydown.arrowRight.prevent",function(){return o.increment()})("keydown.arrowUp.prevent",function(){return o.increment()}),e.\u0275\u0275elementEnd()()()()),2&p&&(e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o.segmented),e.\u0275\u0275advance(1),e.\u0275\u0275styleProp("left",o.left,"%")("right",o.right,"%"),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("dot_focus-visible",o.focusVisibleLeft&&o.computedFocused),e.\u0275\u0275property("tuiFocusable",o.isLeftFocusable),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("dot_focus-visible",o.focusVisibleRight&&o.computedFocused),e.\u0275\u0275property("tuiFocusable",o.isRightFocusable))},directives:[gt.e,w.O5,Pt.Xj,en.t,eo.q],pipes:[w.Ov,O.m,w.Gx],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);color:var(--tui-base-03);min-height:.125rem;font-size:1rem}[data-size='s'][_nghost-%COMP%]{min-height:.125rem;font-size:.5rem}._segmented[_nghost-%COMP%]{padding-bottom:1.25rem}._disabled[_nghost-%COMP%]{cursor:default;pointer-events:none;opacity:var(--tui-disabled-opacity)}.event-catcher[_ngcontent-%COMP%]{min-height:inherit;border-radius:inherit;padding:.4375rem 0;cursor:pointer}.wrapper[_ngcontent-%COMP%]{position:relative;min-height:inherit;border-radius:inherit;background-color:currentColor;border:solid transparent;border-width:0 1em}.bar[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;margin:0 -1em;border-radius:inherit;background-color:var(--tui-primary)}tui-input-slider[_nghost-%COMP%]   .bar[_ngcontent-%COMP%], tui-input-slider   [_nghost-%COMP%]   .bar[_ngcontent-%COMP%]{margin-left:calc(var(--tui-radius-m)/ 2);border-bottom-left-radius:calc(var(--tui-radius-m) * 5) calc(var(--tui-radius-m) * 1.5)}.dot[_ngcontent-%COMP%]{transition-property:background-color;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out;position:absolute;top:50%;z-index:1;width:1em;height:1em;transform:translate(0,-50%);border-radius:100%;background-color:var(--tui-primary);outline:0;cursor:ew-resize}.dot[_ngcontent-%COMP%]:last-child{right:0;transform:translate(0,-50%)}.dot[_ngcontent-%COMP%]:hover{background-color:var(--tui-primary-hover)}.dot[_ngcontent-%COMP%]:active{background-color:var(--tui-primary-active)}.dot_focus-visible[_ngcontent-%COMP%]{box-shadow:inset 0 0 0 2px var(--tui-focus)}.segments[_ngcontent-%COMP%]{position:relative;z-index:1;display:flex;justify-content:space-between;min-height:inherit;margin:0 -1em}.segments-spacer[_ngcontent-%COMP%]{height:1.625rem}.segment[_ngcontent-%COMP%]{position:relative;height:inherit;width:.25rem;background-color:rgba(0,0,0,.36);pointer-events:none}.segment[_ngcontent-%COMP%]:first-of-type, .segment[_ngcontent-%COMP%]:last-of-type{background-color:transparent}.number[_ngcontent-%COMP%]{position:absolute;left:50%;transform:translate(-50%,0);top:100%;font:var(--tui-font-text-s);margin-top:.5rem;color:var(--tui-text-02);white-space:nowrap}.segment[_ngcontent-%COMP%]:first-of-type   .number[_ngcontent-%COMP%]{left:-.05em;transform:none}.segment[_ngcontent-%COMP%]:last-of-type   .number[_ngcontent-%COMP%]{left:auto;right:-.05em;transform:none}._disabled[_nghost-%COMP%]   .number[_ngcontent-%COMP%]{color:var(--tui-text-01)}",".dot[_ngcontent-%COMP%]:first-child{display:none}.wrapper[_ngcontent-%COMP%]{border-left:none}.bar[_ngcontent-%COMP%], .segments[_ngcontent-%COMP%]{margin-left:0}"],changeDetection:0}),Jt.ctorParameters=()=>[{type:ie.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[ie.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:Document,decorators:[{type:e.Inject,args:[w.K0]}]},{type:pt.y,decorators:[{type:e.Inject,args:[xt.Te]}]}],Jt=qn=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(2,(0,e.Inject)(w.K0)),(0,U.fM)(3,(0,e.Inject)(xt.Te))],Jt);let ei=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,Pt.Ih,en.u,eo.c,gt.A,O.a]]}),r})();var wi=A(5628);const $i=function(r){return{$implicit:r}};function no(r,p){if(1&r&&e.\u0275\u0275element(0,"div",6),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("content",o.computedValueContent)("context",e.\u0275\u0275pureFunction1(2,$i,o.value))}}function io(r,p){if(1&r&&e.\u0275\u0275text(0),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275textInterpolate(o.secondary)}}function oo(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"i18nPlural"),e.\u0275\u0275pipe(3,"tuiSliderTickLabel"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2).$implicit,u=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",e.\u0275\u0275pipeBind2(2,1,e.\u0275\u0275pipeBind3(3,4,o,u.segments,u.computedKeySteps),u.segmentsPluralizeMap)," ")}}function ro(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span"),e.\u0275\u0275text(1),e.\u0275\u0275pipe(2,"tuiFormatNumber"),e.\u0275\u0275pipe(3,"tuiSliderTickLabel"),e.\u0275\u0275template(4,oo,4,8,"span",10),e.\u0275\u0275elementEnd()),2&r){const o=p.ngIf,u=e.\u0275\u0275nextContext().$implicit,_=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate2(" ",_.getTickPrefix(u,_.segments,o)," ",e.\u0275\u0275pipeBind1(2,3,e.\u0275\u0275pipeBind3(3,5,u,_.segments,_.computedKeySteps))," "),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",_.segmentsPluralizeMap)}}function Ii(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"span",9),e.\u0275\u0275template(1,ro,5,9,"span",10),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,o.fromToTexts$))}}function Oi(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,Ii,3,3,"span",8),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiRepeatTimesOf",o.segments+1)}}var Hn;let ti=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["tui-input-slider","new",""]]}),r})(),st=Hn=class extends vi{constructor(p,o,u,_,T){super(p,o),this.controller=u,this.fromToTexts$=_,this.isNew=T,this.min=0,this.max=1/0,this.quantum=1,this.steps=0,this.segments=0,this.keySteps=null,this.valueContent="",this.prefix="",this.postfix="",this.secondary=""}get nativeFocusableElement(){var p;return!(null===(p=this.inputNumberRef)||void 0===p?void 0:p.nativeFocusableElement)||this.computedDisabled?null:this.inputNumberRef.nativeFocusableElement}get focused(){var p;return(0,Je.zV)(this.nativeFocusableElement)||(0,Je.zV)((null===(p=this.sliderRef)||void 0===p?void 0:p.nativeElement)||null)}get computedSteps(){return this.steps||(this.max-this.min)/this.quantum}get precision(){return(0,Bn.Nk)(this.quantum).length}get decimal(){return this.precision?"not-zero":"never"}get computedSize(){return this.isNew?(An.zU.assert("s"!==this.controller.size,"Size 's' is not supported by this input."),"l"===this.controller.size?"l":"m"):this.size}get computedValueContent(){return this.minLabel||this.maxLabel?function _o({min:r,max:p,minLabel:o,maxLabel:u}){return({$implicit:_})=>{switch(_){case r:return o||_;case p:return u||_;default:return _}}}(this):this.valueContent}focusTextInput(){var p;const o=null===(p=this.inputNumberRef)||void 0===p?void 0:p.nativeFocusableElement;o&&(0,Je.NY)(o)}safelyUpdateValue(p){this.updateValue(this.valueGuard(null!=p?p:this.safeCurrentValue))}onVerticalArrowKeyDown(p){if(this.readOnly||!this.step)return;const o=this.value+p*this.step;o!==this.value&&this.safelyUpdateValue(o),this.updateTextInputValue(this.valueGuard(o))}onSliderChange(p){this.safelyUpdateValue(p),this.updateTextInputValue(this.value)}onFocused(p){const{value:o,textInputValue:u,safeCurrentValue:_,inputNumberRef:T}=this;!p&&u!==(null==T?void 0:T.getFormattedValue(o))&&this.updateTextInputValue(null!=o?o:_),this.updateFocused(p)}onPressed(p){this.updatePressed(p)}onHovered(p){this.updateHovered(p)}get textInputValue(){var p;return(null===(p=this.inputNumberRef)||void 0===p?void 0:p.nativeValue)||""}getFallbackValue(){return 0}valueGuard(p){const o=(0,Be.NM)(Math.round(p/this.quantum)*this.quantum,bn.bF);return(0,Be.uZ)(o,this.min,this.max)}updateTextInputValue(p){this.inputNumberRef&&(this.inputNumberRef.nativeValue=this.inputNumberRef.getFormattedValue(p))}};st.\u0275fac=function(p){return new(p||st)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Me.Cs),e.\u0275\u0275directiveInject(xt.Te),e.\u0275\u0275directiveInject(ti,8))},st.\u0275cmp=e.\u0275\u0275defineComponent({type:st,selectors:[["tui-input-slider"]],viewQuery:function(p,o){if(1&p&&(e.\u0275\u0275viewQuery(Ut.qS,5),e.\u0275\u0275viewQuery(nn,5,e.ElementRef)),2&p){let u;e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.inputNumberRef=u.first),e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.sliderRef=u.first)}},hostVars:2,hostBindings:function(p,o){2&p&&e.\u0275\u0275classProp("_show-ticks-labels",!o.isNew)},inputs:{min:"min",max:"max",quantum:"quantum",steps:"steps",segments:"segments",keySteps:"keySteps",valueContent:"valueContent",prefix:"prefix",postfix:"postfix",secondary:"secondary"},features:[e.\u0275\u0275ProvidersFeature([{provide:Ft.KZ,useExisting:(0,e.forwardRef)(()=>Hn)},function Si(r){return{provide:Ln,useValue:Object.assign(Object.assign({},Xn),r)}}({trackColor:"transparent"}),gi.Hw,Me.Y0]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:9,vars:26,consts:[[3,"min","max","precision","decimal","prefix","postfix","tuiTextfieldCustomContent","tuiTextfieldSize","tuiTextfieldLabelOutside","readOnly","pseudoFocused","pseudoHovered","pseudoPressed","pseudoInvalid","ngModel","ngModelChange","focusedChange","hoveredChange","pressedChange","keydown.arrowUp.prevent","keydown.arrowDown.prevent"],["polymorpheus-outlet","","automation-id","tui-input-slider__value-content",3,"content","context",4,"ngIf"],["deprecatedSecondary",""],[1,"t-slider-wrapper"],["tuiSlider","","type","range",3,"tuiFocusable","max","segments","keySteps","ngModel","keyStepsInput","click"],["class","t-ticks-labels",4,"ngIf"],["polymorpheus-outlet","","automation-id","tui-input-slider__value-content",3,"content","context"],[1,"t-ticks-labels"],["automation-id","tui-slider__segment",4,"tuiRepeatTimes","tuiRepeatTimesOf"],["automation-id","tui-slider__segment"],[4,"ngIf"]],template:function(p,o){if(1&p&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"tui-input-number",0),e.\u0275\u0275listener("ngModelChange",function(_){return o.safelyUpdateValue(_)})("focusedChange",function(_){return o.onFocused(_)})("hoveredChange",function(_){return o.onHovered(_)})("pressedChange",function(_){return o.onPressed(_)})("keydown.arrowUp.prevent",function(){return o.onVerticalArrowKeyDown(1)})("keydown.arrowDown.prevent",function(){return o.onVerticalArrowKeyDown(-1)}),e.\u0275\u0275pipe(1,"i18nPlural"),e.\u0275\u0275projection(2),e.\u0275\u0275template(3,no,1,4,"div",1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(4,io,1,1,"ng-template",null,2,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementStart(6,"div",3)(7,"input",4),e.\u0275\u0275listener("keyStepsInput",function(_){return o.onSliderChange(_)})("click",function(){return o.focusTextInput()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(8,Oi,2,1,"div",5),e.\u0275\u0275elementEnd()),2&p){const u=e.\u0275\u0275reference(5);e.\u0275\u0275property("min",o.min)("max",o.max)("precision",o.precision)("decimal",o.decimal)("prefix",o.prefix)("postfix",o.postfix||e.\u0275\u0275pipeBind2(1,23,o.value,o.pluralizeMap||o.pluralizeMapFallback))("tuiTextfieldCustomContent",o.controller.customContent||u)("tuiTextfieldSize",o.computedSize)("tuiTextfieldLabelOutside","l"!==o.computedSize)("readOnly",o.readOnly)("pseudoFocused",o.computedFocused)("pseudoHovered",o.computedHovered)("pseudoPressed",o.computedPressed)("pseudoInvalid",o.pseudoInvalid)("ngModel",o.value),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",o.computedValueContent&&!o.focused),e.\u0275\u0275advance(4),e.\u0275\u0275property("tuiFocusable",!1)("max",o.computedSteps)("segments",o.segments)("keySteps",o.computedKeySteps)("ngModel",o.value),e.\u0275\u0275attribute("disabled",o.readOnly||o.disabled||null),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.segments&&!o.isNew)}},directives:[Ut.qS,Ut.g5,Me.B7,Me.sz,Me.xT,ie.NgControlStatus,ie.NgModel,w.O5,wi.r1,un,nn,ie.RangeValueAccessor,ie.DefaultValueAccessor,en.t,Pt.Xj],pipes:[w.Gx,w.Ov,O.m,ki],styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;height:-webkit-max-content;height:-moz-max-content;height:max-content}._segmented._show-ticks-labels[_nghost-%COMP%]{border-bottom:26px solid transparent}.t-slider-wrapper[_ngcontent-%COMP%]{position:absolute;top:100%;left:calc(var(--tui-radius-m)/ 2);right:0;margin:-.5625rem 0 0}input[type=range][_ngcontent-%COMP%]{border-top-left-radius:0;border-bottom-left-radius:calc(var(--tui-radius-m) * 5) calc(var(--tui-radius-m) * 1.5)}.t-ticks-labels[_ngcontent-%COMP%]{display:flex;margin:0 .5rem;font:var(--tui-font-text-s);color:var(--tui-text-02)}.t-ticks-labels[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{position:relative;flex:2;text-align:center}.t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{left:-.5rem;flex:1;text-align:left}.t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{right:-.5rem;flex:1;text-align:right}tui-input-slider[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%]{margin-left:calc(var(--tui-radius-m)/ 2 + .5rem)}tui-input-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%], tui-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%]{margin-left:1rem;margin-right:1rem}tui-input-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child, tui-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:first-child{left:-1rem}tui-input-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child, tui-range[_ngcontent-%COMP%] + .t-ticks-labels[_ngcontent-%COMP%] > [_ngcontent-%COMP%]:last-child{right:-1rem}"],changeDetection:0}),st.ctorParameters=()=>[{type:ie.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[ie.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:Me.yH,decorators:[{type:e.Inject,args:[Me.Cs]}]},{type:pt.y,decorators:[{type:e.Inject,args:[xt.Te]}]},{type:ti,decorators:[{type:e.Optional},{type:e.Inject,args:[ti]}]}],(0,U.gn)([(0,e.ViewChild)(Ut.qS)],st.prototype,"inputNumberRef",void 0),(0,U.gn)([(0,e.ViewChild)(nn,{read:e.ElementRef})],st.prototype,"sliderRef",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"min",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"max",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)(function go(r){return r>0},"Quantum must be positive")],st.prototype,"quantum",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"steps",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"segments",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"keySteps",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"valueContent",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"prefix",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"postfix",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],st.prototype,"secondary",void 0),st=Hn=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(2,(0,e.Inject)(Me.Cs)),(0,U.fM)(3,(0,e.Inject)(xt.Te)),(0,U.fM)(4,(0,e.Optional)()),(0,U.fM)(4,(0,e.Inject)(ti))],st);let lo=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,ie.FormsModule,ie.ReactiveFormsModule,en.u,ei,O.a,Pt.Ih,wi.wq,Ut._H,Me.cn]]}),r})();var Qe=A(22);function ne(r,p,o,u){var j,_=arguments.length,T=_<3?p:null===u?u=Object.getOwnPropertyDescriptor(p,o):u;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)T=Reflect.decorate(r,p,o,u);else for(var G=r.length-1;G>=0;G--)(j=r[G])&&(T=(_<3?j(T):_>3?j(p,o,T):j(p,o))||T);return _>3&&T&&Object.defineProperty(p,o,T),T}function se(r,p){return function(o,u){p(o,u,r)}}let Ue=(()=>{let r=class{constructor(){this.stateChange$=new Ve.x,this.valueChange$=new Ve.x}};return r.\u0275fac=function(o){return new(o||r)},r.\u0275dir=e.\u0275\u0275defineDirective({type:r}),r})();var Tt=A(3507),Re=A(8891),Kt=A(4620),zt=A(3054),we=A(6083),pn=A(4176);const uo=["native"];function qo(r,p){1&r&&(e.\u0275\u0275elementStart(0,"span",4),e.\u0275\u0275projection(1),e.\u0275\u0275elementEnd())}var ko;let Tn=ko=class extends mt.M${constructor(p,o){super(p,o),this.maxLength=null}get nativeFocusableElement(){return this.native?this.native.nativeElement:null}get focused(){return(0,Je.zV)(this.nativeFocusableElement)}get hasValue(){return""!==this.value}onValueChange(p){this.updateValue(p)}onFocused(p){this.updateFocused(p)}getFallbackValue(){return""}};Tn.\u0275fac=function(p){return new(p||Tn)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef))},Tn.\u0275cmp=e.\u0275\u0275defineComponent({type:Tn,selectors:[["tui-input-inline"]],viewQuery:function(p,o){if(1&p&&e.\u0275\u0275viewQuery(uo,5),2&p){let u;e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.native=u.first)}},inputs:{maxLength:"maxLength"},features:[e.\u0275\u0275ProvidersFeature([we.E2,{provide:Ft.KZ,useExisting:(0,e.forwardRef)(()=>ko)}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*"],decls:5,vars:8,consts:[[1,"t-before"],["automation-id","tui-input-inline__placeholder","class","t-placeholder",4,"ngIf"],["automation-id","tui-input-inline__native","type","text","tuiMaskAccessor","",1,"t-native",3,"id","disabled","readOnly","tuiFocusable","ngModel","ngModelChange","tuiFocusedChange"],["native",""],["automation-id","tui-input-inline__placeholder",1,"t-placeholder"]],template:function(p,o){1&p&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275elementStart(0,"span",0),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(2,qo,2,0,"span",1),e.\u0275\u0275elementStart(3,"input",2,3),e.\u0275\u0275listener("ngModelChange",function(_){return o.onValueChange(_)})("tuiFocusedChange",function(_){return o.onFocused(_)}),e.\u0275\u0275elementEnd()),2&p&&(e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate(o.value),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",!o.hasValue),e.\u0275\u0275advance(1),e.\u0275\u0275property("id",o.id)("disabled",o.computedDisabled)("readOnly",o.readOnly)("tuiFocusable",o.focusable)("ngModel",o.value),e.\u0275\u0275attribute("maxLength",o.maxLength))},directives:[w.O5,pn.j$,ie.DefaultValueAccessor,en.t,ie.NgControlStatus,ie.NgModel,zt.U],styles:["[_nghost-%COMP%]{position:relative;display:inline-block;overflow:hidden;white-space:nowrap;box-sizing:border-box}.t-before[_ngcontent-%COMP%]{padding-right:.02em;margin-left:1px;visibility:hidden;white-space:pre}.t-placeholder[_ngcontent-%COMP%]{margin-left:-1px}.t-native[_ngcontent-%COMP%]{position:absolute;top:0;left:0;background-color:transparent;padding:inherit;font:inherit;color:inherit;box-sizing:border-box;width:100%;height:100%;border-width:0;text-align:inherit;letter-spacing:inherit;text-indent:inherit;text-transform:inherit;outline:0}"],changeDetection:0}),Tn.ctorParameters=()=>[{type:ie.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[ie.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]}],(0,U.gn)([(0,e.ViewChild)("native")],Tn.prototype,"native",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Tn.prototype,"maxLength",void 0),Tn=ko=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef))],Tn);let tr=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,ie.FormsModule,en.u,zt.F,pn.c8]]}),r})();function nr(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"label",2),e.\u0275\u0275text(2," URL "),e.\u0275\u0275elementStart(3,"span",3),e.\u0275\u0275text(4),e.\u0275\u0275elementStart(5,"tui-input-inline",4),e.\u0275\u0275listener("ngModelChange",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onChange(_)})("keydown.prevent.enter",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onSave()})("keydown.backspace",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onBackspace()}),e.\u0275\u0275text(6," example.com "),e.\u0275\u0275elementEnd()()(),e.\u0275\u0275elementStart(7,"tui-svg",5),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onClear()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(8,"button",6),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onSave()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementContainerEnd()}if(2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(4),e.\u0275\u0275textInterpolate1(" ",o.prefix," "),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("t-input_filled",o.hasUrl),e.\u0275\u0275property("ngModel",o.url),e.\u0275\u0275advance(2),e.\u0275\u0275classProp("t-cleaner_hidden",!o.hasUrl)}}function ir(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"a",7),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",8),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onEdit()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",9),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onRemove()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275property("href",o.href,e.\u0275\u0275sanitizeUrl),e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.shortUrl," ")}}let yo=(()=>{let r=class{constructor(o,u){this.documentRef=o,this.shadowRootRef=u,this.addLink=new e.EventEmitter,this.removeLink=new e.EventEmitter,this.url=this.makeUrl(),this.edit=!this.url,this.prefix="http://"}get hasUrl(){return!!this.url}get href(){return`${this.prefix}${this.url}`}get shortUrl(){return this.url.length<60?this.url:`${this.url.slice(0,Math.max(0,40))}...${this.url.slice(this.url.length-10)}`}get isViewMode(){return!this.edit}onSelectionChange(){this.isViewMode&&(this.url=this.makeUrl())}onMouseDown(o){const u=o.target instanceof HTMLElement?o.target.tagName.toLowerCase():"";"a"===u||"button"===u||"input"===u||o.preventDefault()}onSave(){this.url?this.addLink.emit(this.href):this.removeLink.emit()}onBackspace(){this.url||(this.prefix="http://")}onEdit(){this.edit=!0}onRemove(){this.removeLink.emit()}onChange(o){this.url=this.removePrefix(o)}onClear(){this.url=""}makeUrl(){const o=(this.shadowRootRef||this.documentRef).getSelection();return o?this.getHref(o):""}getHref({focusNode:o}){if(!o||!o.parentElement)return"";const u=(0,Tt.Q4)(o.parentElement,"a");return u?this.removePrefix(u.getAttribute("href")||""):""}removePrefix(o){return o.startsWith("http://")?(this.prefix="http://",o.replace("http://","")):o.startsWith("https://")?(this.prefix="https://",o.replace("https://","")):o}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(w.K0),e.\u0275\u0275directiveInject(Re.Qe,8))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-edit-link"]],hostBindings:function(o,u){1&o&&e.\u0275\u0275listener("selectionchange",function(){return u.onSelectionChange()},!1,e.\u0275\u0275resolveDocument)("mousedown",function(T){return u.onMouseDown(T)})},outputs:{addLink:"addLink",removeLink:"removeLink"},decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["view",""],[1,"t-label"],[1,"t-url"],["tuiAutoFocus","",1,"t-input",3,"ngModel","ngModelChange","keydown.prevent.enter","keydown.backspace"],["src","tuiIconCloseLarge",1,"t-cleaner",3,"click"],["tuiIconButton","","type","button","size","s","title","Insert link","icon","tuiIconCheckCircleLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiLink","","target","_blank",1,"t-link",3,"href"],["tuiIconButton","","type","button","size","s","title","Change link","icon","tuiIconEditLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"],["tuiIconButton","","type","button","size","s","title","Remove link","icon","tuiIconTrashLarge","shape","rounded","appearance","icon",1,"t-button",3,"click"]],template:function(o,u){if(1&o&&(e.\u0275\u0275template(0,nr,9,6,"ng-container",0),e.\u0275\u0275template(1,ir,4,2,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&o){const _=e.\u0275\u0275reference(2);e.\u0275\u0275property("ngIf",u.edit)("ngIfElse",_)}},directives:[w.O5,Tn,L.k,ie.NgControlStatus,ie.NgModel,Kt.P,te.v0,re.V],styles:["[_nghost-%COMP%]{display:flex;height:var(--tui-height-l);align-items:center;padding-right:.75rem}.t-label[_ngcontent-%COMP%]{font:var(--tui-font-text-s);height:var(--tui-height-l);box-sizing:border-box;padding:.4375rem 1rem;min-width:12.5rem;max-width:25rem}.t-url[_ngcontent-%COMP%]{display:flex;font:var(--tui-font-text-m);color:var(--tui-text-02)}.t-input[_ngcontent-%COMP%]{flex:1}.t-input_filled[_ngcontent-%COMP%]{color:var(--tui-text-01)}.t-button[_ngcontent-%COMP%]{width:2rem;height:2rem;margin:0 .25rem;transition:background .2s}.t-link[_ngcontent-%COMP%]{margin:0 1rem}.t-cleaner[_ngcontent-%COMP%]{transition-property:color;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out;color:var(--tui-base-06);cursor:pointer}.t-cleaner[_ngcontent-%COMP%]:hover{color:var(--tui-base-07)}.t-cleaner_hidden[_ngcontent-%COMP%]{visibility:hidden}"],changeDetection:0}),ne([(0,e.Output)()],r.prototype,"addLink",void 0),ne([(0,e.Output)()],r.prototype,"removeLink",void 0),ne([(0,e.HostListener)("document:selectionchange")],r.prototype,"onSelectionChange",null),ne([(0,e.HostListener)("mousedown",["$event"])],r.prototype,"onMouseDown",null),r=ne([se(0,(0,e.Inject)(w.K0)),se(1,(0,e.Optional)()),se(1,(0,e.Inject)(Re.Qe))],r),r})(),Bo=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,ie.FormsModule,L.Q7,te.fN,Kt.E,re.j,tr]]}),r})();var Fo=A(8675),ni=A(1884);function Io(r,p,o={}){return r.find(({attrs:u,type:_})=>_===p&&function sr(r,p){const o=Object.keys(p);return!o.length||!!o.filter(u=>p[u]===r[u]).length}(u,o))||null}let Ae=(()=>{let r=class extends Ue{constructor(o){super(),this.editorRef=o,this.editorRef.subscribe(u=>{this.editor=u,u.on("transaction",()=>{this.stateChange$.next()}),u.on("update",()=>{const _=u.getHTML(),j=function Cr(r){return Array.isArray(r)&&1===r.length&&!r[0].hasOwnProperty("content")}(u.getJSON().content)?"":_;this.valueChange$.next(j)})})}get isFocused(){return this.editor.isFocused}get html(){return this.editor.getHTML()}get editable(){return this.editor.isEditable}set editable(o){this.editor.setEditable(o)}get state(){return this.editor.state}getOriginTiptapEditor(){return this.editor}undoDisabled(){return!this.editor.can().undo()}redoDisabled(){return!this.editor.can().redo()}getFontColor(){return this.editor.getAttributes("textStyle").fontColor||"rgb(51, 51, 51)"}getBackgroundColor(){var o;return(null===(o=this.editor)||void 0===o?void 0:o.getAttributes("textStyle").backgroundColor)||"rgb(51, 51, 51)"}getCellColor(){return this.editor.getAttributes("tableCell").background||this.editor.getAttributes("tableHeader").background}onAlign(o){this.editor.chain().focus().setTextAlign(o).run()}setImage(o){this.editor.chain().focus().first(({commands:u})=>[()=>{var _;return(null===(_=u.setEditableImage)||void 0===_?void 0:_.call(u,{src:o}))||!1},()=>u.setImage({src:o})]).run()}undo(){this.editor.chain().undo().run()}redo(){this.editor.chain().redo().run()}setHorizontalRule(){this.editor.chain().focus().setHorizontalRule().run()}removeFormat(){this.editor.commands.unsetAllMarks(),this.editor.commands.clearNodes()}setFontColor(o){this.editor.chain().focus().setFontColor(o).run()}setBackgroundColor(o){this.editor.chain().focus().setBackgroundColor(o).run()}toggleUnderline(){this.editor.chain().focus().toggleUnderline().run()}toggleStrike(){this.editor.chain().focus().toggleStrike().run()}toggleOrderedList(){this.editor.chain().focus().toggleOrderedList().run()}toggleUnorderedList(){this.editor.chain().focus().toggleBulletList().run()}togglePre(){this.editor.chain().focus().toggleCodeBlock().run()}sinkListItem(){this.editor.chain().focus().sinkListItem("listItem").run()}liftListItem(){this.editor.chain().focus().liftListItem("listItem").run()}isActive(o){return this.editor.isActive(o)}isActive$(o){return this.stateChange$.pipe((0,Fo.O)(null),(0,B.U)(()=>this.isActive(o)),(0,ni.x)())}toggleBold(){this.editor.chain().focus().toggleBold().run()}toggleCode(){this.editor.chain().focus().toggleCode().run()}toggleItalic(){this.editor.chain().focus().toggleItalic().run()}toggleBlockquote(){this.editor.chain().focus().toggleBlockquote().run()}toggleSubscript(){this.editor.chain().focus().toggleSubscript().run()}toggleSuperscript(){this.editor.chain().focus().toggleSuperscript().run()}toggleCodeBlock(){this.editor.chain().focus().toggleCodeBlock().run()}insertTable(o,u){this.editor.chain().focus().insertTable({cols:o,rows:u}).run()}addColumnAfter(){this.editor.chain().focus().addColumnAfter().run()}addColumnBefore(){this.editor.chain().focus().addColumnBefore().run()}addRowAfter(){this.editor.chain().focus().addRowAfter().run()}addRowBefore(){this.editor.chain().focus().addRowBefore().run()}deleteColumn(){this.editor.chain().focus().deleteColumn().run()}deleteRow(){this.editor.chain().focus().deleteRow().run()}mergeCells(){this.editor.chain().focus().mergeCells().run()}splitCell(){this.editor.chain().focus().splitCell().run()}canMergeCells(){return this.editor.can().mergeCells()}canSplitCells(){return this.editor.can().splitCell()}setHeading(o){this.editor.chain().focus().setHeading({level:o}).run()}setParagraph(o){this.editor.chain().focus().setParagraph().run(),o&&this.editor.chain().setMark("textStyle",o).run()}setHardBreak(){this.editor.chain().setHardBreak().run()}setTextSelection(o){this.editor.commands.setTextSelection(o)}toggleLink(o){this.editor.chain().focus().toggleLink({href:o}).run()}setLink(o){this.editor.chain().focus().setLink({href:o}).run()}unsetLink(){this.editor.chain().focus().unsetLink().run()}indent(){this.editor.commands.indent()}outdent(){this.editor.commands.outdent()}focus(){this.editor.chain().focus().run()}setValue(o){this.editor.commands.setContent(o)}destroy(){this.editor.destroy()}setCellColor(o){this.editor.chain().focus().setCellBackground(o).run()}selectClosest(){const o=this.editor.state.selection.anchor,{schema:u,doc:_}=this.editor.state,T=function lr(r,p,o={}){if(!r||!p)return null;const{node:u,offset:_}=r.parent.childAfter(r.parentOffset);if(!u)return null;const T=Io(u.marks,p,o);if(!T)return null;let j=r.index(),G=r.start()+_,Ce=j+1,pe=G+u.nodeSize;for(Io(u.marks,p,o);j>0&&T.isInSet(r.parent.child(j-1).marks);)j-=1,G-=r.parent.child(j).nodeSize;for(;Ce<r.parent.childCount&&Io(r.parent.child(Ce).marks,p,o);)pe+=r.parent.child(Ce).nodeSize,Ce+=1;return{from:G,to:pe}}(_.resolve(o),u.marks.link);T&&this.editor.chain().setTextSelection(T).run()}enter(){this.editor.commands.enter()}setDetails(){this.editor.commands.setDetails()}removeDetails(){this.editor.commands.removeDetails()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275inject($t))},r.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:function(p){return r.\u0275fac(p)}}),r=ne([se(0,(0,e.Inject)($t))],r),r})(),br=(()=>{let r=class{constructor(o,u,_,T,j,G,Ce,pe){this.elementRef=o,this.renderer=u,this.editor=_,this.editorContainer=j,this.editorLoaded$=G,this.valueChange=this.editor.valueChange$,this.stateChange=this.editor.stateChange$,T.addStyle(Ce,"data-tui-editor-socket"),this.editorLoaded$.pipe((0,be.R)(pe)).subscribe(()=>{this.renderer.appendChild(this.elementRef.nativeElement,this.editorContainer)})}set value(o){o!==this.editor.html&&this.editor.setValue(o)}set editable(o){this.editor.editable=o}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(e.ElementRef),e.\u0275\u0275directiveInject(e.Renderer2),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ze.gH),e.\u0275\u0275directiveInject(Zt),e.\u0275\u0275directiveInject($t),e.\u0275\u0275directiveInject(oi),e.\u0275\u0275directiveInject(Ze.a3))},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["","tuiTiptapEditor",""]],inputs:{value:"value",editable:"editable"},outputs:{valueChange:"valueChange",stateChange:"stateChange"},features:[e.\u0275\u0275ProvidersFeature([Ze.a3])]}),ne([(0,e.Input)()],r.prototype,"value",null),ne([(0,e.Input)()],r.prototype,"editable",null),ne([(0,e.Output)()],r.prototype,"valueChange",void 0),ne([(0,e.Output)()],r.prototype,"stateChange",void 0),r=ne([se(0,(0,e.Inject)(e.ElementRef)),se(1,(0,e.Inject)(e.Renderer2)),se(2,(0,e.Inject)(Ae)),se(3,(0,e.Inject)(Ze.gH)),se(4,(0,e.Inject)(Zt)),se(5,(0,e.Inject)($t)),se(6,(0,e.Inject)(oi)),se(7,(0,e.Inject)(Ze.a3))],r),r})(),vr=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({}),r})();var He=A(3112),je=A(4664);function xr(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",2,3),e.\u0275\u0275listener("click",function(){e.\u0275\u0275restoreView(o);const _=e.\u0275\u0275nextContext().tuiLet,T=e.\u0275\u0275nextContext();return _.mergeCells?T.mergeCells():T.splitCell()}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("icon",_.mergeCells?"tuiIconTableMergeLarge":"tuiIconTableSplitLarge")("tuiHint",_.mergeCells?o.mergeCells:o.splitCells)("tuiHintId",u.id)("tuiDescribedBy",u.id)("focusable",!1)("disabled",!_.mergeCells&&!_.splitCells)}}function Tr(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,xr,2,6,"button",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(2,1,o.texts$))}}const Mr=function(r,p){return{mergeCells:r,splitCells:p}};let Sr=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.canMergeCells$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.canMergeCells()),(0,ni.x)()),this.canSplitCells$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.canSplitCells()),(0,ni.x)())}mergeCells(){this.editor.mergeCells()}splitCell(){this.editor.splitCell()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-table-merge-cells"]],decls:3,vars:8,consts:[[4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintId","tuiDescribedBy","focusable","disabled","click",4,"tuiLet"],["tuiIconButton","","type","button","size","s","appearance","icon","tuiHintDirection","top-left",3,"icon","tuiHint","tuiHintId","tuiDescribedBy","focusable","disabled","click"],["tableMergeSplitBtn",""]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Tr,3,3,"ng-container",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275pipe(2,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pureFunction2(5,Mr,e.\u0275\u0275pipeBind1(1,1,u.canMergeCells$),e.\u0275\u0275pipeBind1(2,3,u.canSplitCells$)))},directives:[Qe.Ls,te.v0,He.D,je.OH],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),kr=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,te.fN,He.go,je.$Z,Qe.WD]]}),r})();var ii=A(1602),Mn=A(2558),nt=A(5411),Co=(A(1762),A(8190)),jo=A(4335),wr=A(7670),Vo=A(589),bo=A(7795);function Ir(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275elementStart(1,"section",2)(2,"button",3),e.\u0275\u0275listener("mousedown",function(_){e.\u0275\u0275restoreView(o);const T=e.\u0275\u0275nextContext(2);return T.onButtonMouseDown(_,T.plusButtonDisabled)})("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).increaseValue()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",4),e.\u0275\u0275listener("mousedown",function(_){e.\u0275\u0275restoreView(o);const T=e.\u0275\u0275nextContext(2);return T.onButtonMouseDown(_,T.minusButtonDisabled)})("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).decreaseValue()}),e.\u0275\u0275elementEnd()(),e.\u0275\u0275elementContainerEnd()}if(2&r){const o=p.ngIf,u=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(2),e.\u0275\u0275property("icon",u.iconUp)("appearance",u.options.appearance)("title",o[0])("disabled",u.plusButtonDisabled)("focusable",!1),e.\u0275\u0275advance(1),e.\u0275\u0275property("icon",u.iconDown)("appearance",u.options.appearance)("disabled",u.minusButtonDisabled)("focusable",!1)("title",o[1])}}function Or(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ir,4,10,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,o.minusTexts$))}}const Dr=["*",[["input"]]],$o={icons:{up:"tuiIconPlus",down:"tuiIconMinus"},appearance:"textfield",hideButtons:!1,min:0,max:1/0,step:1,postfix:""},vo=new e.InjectionToken("Default parameters for input count component",{factory:()=>$o});var xo;let Ct=xo=class extends mt.M${constructor(p,o,u,_,T,j,G,Ce){super(p,o),this.appearance=u,this.textfieldSize=_,this.minusTexts$=T,this.isMobile=j,this.options=G,this.numberFormat=Ce,this.step=this.options.step,this.min=this.options.min,this.max=this.options.max,this.hideButtons=this.options.hideButtons,this.prefix="",this.postfix=this.options.postfix}getMask(p){return{mask:(0,wr.EC)({allowNegative:p,decimalSymbol:this.numberFormat.decimalSeparator,thousandSymbol:this.numberFormat.thousandSeparator}),guide:!1}}get buttonsHidden(){return this.hideButtons||"table"===this.appearance}get iconUp(){return this.options.icons.up}get iconDown(){return this.options.icons.down}get nativeFocusableElement(){return!this.primitiveTextfield||this.computedDisabled?null:this.primitiveTextfield.nativeFocusableElement}get size(){return this.textfieldSize.size}get focused(){return(0,Je.zV)(this.nativeFocusableElement)}get exampleText(){return String(this.min)}get computedValue(){return this.focused?this.nativeValue:this.formatNumber(this.value)}get minusButtonDisabled(){return!this.interactive||(0,jo.EN)(this.value)&&this.value<=this.min}get plusButtonDisabled(){return!this.interactive||(0,jo.EN)(this.value)&&this.value>=this.max}onButtonMouseDown(p,o=!1){o||!this.nativeFocusableElement||this.isMobile||(p.preventDefault(),(0,Je.NY)(this.nativeFocusableElement))}onFocused(p){p||this.onBlur(),this.updateFocused(p)}onHovered(p){this.updateHovered(p)}onPressed(p){this.updatePressed(p)}onValueChange(){const p=this.capValue(this.nativeNumberValue);if(null===p||isNaN(p))return;const o=this.formatNumber(p);this.nativeValue!==o&&(this.nativeValue=o),this.updateValue(p)}decreaseValue(){this.readOnly||this.safeUpdateValue((this.value||0)-this.step)}increaseValue(){this.readOnly||this.safeUpdateValue((this.value||0)+this.step)}onKeydown(p){switch(p.key){case"ArrowUp":case"Up":this.increaseValue(),p.preventDefault();break;case"ArrowDown":case"Down":this.decreaseValue(),p.preventDefault()}}getFallbackValue(){return 0}get nativeNumberValue(){return parseInt(this.nativeValue.split(this.numberFormat.thousandSeparator).join(""),10)}get nativeValue(){return this.nativeFocusableElement?this.nativeFocusableElement.value:""}set nativeValue(p){!this.nativeFocusableElement||(this.nativeFocusableElement.value=p)}safeUpdateValue(p){const o=(0,Be.uZ)(p,this.min,this.max);this.updateValue(o),this.nativeValue=this.formatNumber(o)}capValue(p){const o=Math.min(p,this.max);return isNaN(o)||o<this.min?null:o}onBlur(){const p=Math.max(this.nativeNumberValue||0,this.min),o=this.formatNumber(p);this.nativeValue=o,this.updateValue(p),this.primitiveTextfield&&(this.primitiveTextfield.value=o)}formatNumber(p){return(0,Bn.uf)(p,null,this.numberFormat.decimalSeparator,this.numberFormat.thousandSeparator)}};var Uo;Ct.\u0275fac=function(p){return new(p||Ct)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(Re.jt),e.\u0275\u0275directiveInject(Me.kI),e.\u0275\u0275directiveInject(xt.mT),e.\u0275\u0275directiveInject(Ft.fL),e.\u0275\u0275directiveInject(vo),e.\u0275\u0275directiveInject(Re.HO))},Ct.\u0275cmp=e.\u0275\u0275defineComponent({type:Ct,selectors:[["tui-input-count"]],viewQuery:function(p,o){if(1&p&&e.\u0275\u0275viewQuery(ii.yc,5),2&p){let u;e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.primitiveTextfield=u.first)}},hostVars:3,hostBindings:function(p,o){2&p&&(e.\u0275\u0275attribute("data-size",o.size),e.\u0275\u0275classProp("_hide-buttons",o.buttonsHidden))},inputs:{step:"step",min:"min",max:"max",hideButtons:"hideButtons",prefix:"prefix",postfix:"postfix"},features:[e.\u0275\u0275ProvidersFeature([{provide:Ft.KZ,useExisting:(0,e.forwardRef)(()=>xo)},{provide:mt.M$,useExisting:(0,e.forwardRef)(()=>xo)}]),e.\u0275\u0275InheritDefinitionFeature],ngContentSelectors:["*","input"],decls:4,vars:14,consts:[["tuiValueAccessor","","tuiTextfieldAutocomplete","off","tuiTextfieldInputMode","numeric",1,"textfield",3,"tuiTextfieldMaxLength","pseudoFocused","pseudoHovered","pseudoPressed","focusable","nativeId","prefix","postfix","disabled","readOnly","textMask","invalid","value","valueChange","keydown","focusedChange","hoveredChange","pressedChange"],[4,"ngIf"],[1,"buttons"],["tuiIconButton","","type","button","automation-id","tui-input-count__plus-button","size","s",1,"button","button_plus",3,"icon","appearance","title","disabled","focusable","mousedown","click"],["tuiIconButton","","type","button","automation-id","tui-input-count__minus-button","size","s",1,"button","button_minus",3,"icon","appearance","disabled","focusable","title","mousedown","click"]],template:function(p,o){1&p&&(e.\u0275\u0275projectionDef(Dr),e.\u0275\u0275elementStart(0,"tui-primitive-textfield",0),e.\u0275\u0275listener("valueChange",function(){return o.onValueChange()})("keydown",function(_){return o.onKeydown(_)})("focusedChange",function(_){return o.onFocused(_)})("hoveredChange",function(_){return o.onHovered(_)})("pressedChange",function(_){return o.onPressed(_)}),e.\u0275\u0275projection(1),e.\u0275\u0275projection(2,1,["ngProjectAs","input",5,["input"]]),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(3,Or,3,3,"ng-container",1)),2&p&&(e.\u0275\u0275property("tuiTextfieldMaxLength",18)("pseudoFocused",o.pseudoFocused)("pseudoHovered",o.pseudoHovered)("pseudoPressed",o.pseudoPressed)("focusable",o.focusable)("nativeId",o.nativeId)("prefix",o.prefix)("postfix",o.postfix)("disabled",o.computedDisabled)("readOnly",o.readOnly)("textMask",o.getMask(o.min<0))("invalid",o.computedInvalid)("value",o.computedValue),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!o.buttonsHidden))},directives:[ii.yc,ii.B1,Co.n,Me.S8,Me.D9,Me.fy,bo.hd,w.O5,te.v0],pipes:[w.Ov],styles:["[_nghost-%COMP%]{display:flex;font:var(--tui-font-text-s);border-radius:var(--tui-radius-m);height:var(--tui-height-m);color:var(--tui-text-01);text-align:left}._disabled[_nghost-%COMP%]{pointer-events:none}[data-size='l'][_nghost-%COMP%]{font:var(--tui-font-text-m);height:var(--tui-height-l)}.textfield[_ngcontent-%COMP%]{position:relative;border-radius:inherit;text-align:inherit;flex-grow:1;min-width:0}[_nghost-%COMP%]:not(._hide-buttons)   .textfield[_ngcontent-%COMP%]{border-top-right-radius:0;border-bottom-right-radius:0}.buttons[_ngcontent-%COMP%]{display:flex;flex-direction:column;margin-left:.125rem;height:100%}.buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{display:flex;width:calc(var(--tui-height-m) * .75);height:calc(50% - .0625rem)}.buttons[_ngcontent-%COMP%]   .button_plus[_ngcontent-%COMP%]{margin-bottom:.125rem;border-radius:0 var(--tui-radius-m) 0 0}.buttons[_ngcontent-%COMP%]   .button_minus[_ngcontent-%COMP%]{border-radius:0 0 var(--tui-radius-m)}[data-size='l'][_nghost-%COMP%]   .buttons[_ngcontent-%COMP%]   .button[_ngcontent-%COMP%]{width:calc(var(--tui-height-l) * .75)}"],changeDetection:0}),Ct.ctorParameters=()=>[{type:ie.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[ie.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:String,decorators:[{type:e.Inject,args:[Re.jt]}]},{type:Me.sz,decorators:[{type:e.Inject,args:[Me.kI]}]},{type:pt.y,decorators:[{type:e.Inject,args:[xt.mT]}]},{type:Boolean,decorators:[{type:e.Inject,args:[Ft.fL]}]},{type:void 0,decorators:[{type:e.Inject,args:[vo]}]},{type:void 0,decorators:[{type:e.Inject,args:[Re.HO]}]}],(0,U.gn)([(0,e.ViewChild)(ii.yc)],Ct.prototype,"primitiveTextfield",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"step",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"min",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"max",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"hideButtons",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"prefix",void 0),(0,U.gn)([(0,e.Input)(),(0,ce.TH)()],Ct.prototype,"postfix",void 0),(0,U.gn)([ce.UM],Ct.prototype,"getMask",null),(0,U.gn)([(0,e.HostBinding)("class._hide-buttons")],Ct.prototype,"buttonsHidden",null),(0,U.gn)([(0,e.HostBinding)("attr.data-size")],Ct.prototype,"size",null),Ct=xo=(0,U.gn)([(0,U.fM)(0,(0,e.Optional)()),(0,U.fM)(0,(0,e.Self)()),(0,U.fM)(0,(0,e.Inject)(ie.NgControl)),(0,U.fM)(1,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(2,(0,e.Inject)(Re.jt)),(0,U.fM)(3,(0,e.Inject)(Me.kI)),(0,U.fM)(4,(0,e.Inject)(xt.mT)),(0,U.fM)(5,(0,e.Inject)(Ft.fL)),(0,U.fM)(6,(0,e.Inject)(vo)),(0,U.fM)(7,(0,e.Inject)(Re.HO))],Ct);let Wi=Uo=class extends Vo.dh{onValueChange(){this.host.onValueChange()}process(p){p.autocomplete="off",p.inputMode="numeric"}};function Jr(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1),e.\u0275\u0275listener("click",function(){const T=e.\u0275\u0275restoreView(o).$implicit;return e.\u0275\u0275nextContext().selectedColor.emit(T.value)}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit;e.\u0275\u0275styleProp("background",o.value),e.\u0275\u0275property("tuiHint",o.key)("tuiHintId",o.key)("tuiDescribedBy",o.key)}}Wi.\u0275fac=function(){let r;return function(o){return(r||(r=e.\u0275\u0275getInheritedFactory(Wi)))(o||Wi)}}(),Wi.\u0275dir=e.\u0275\u0275defineDirective({type:Wi,selectors:[["tui-input-count"]],features:[e.\u0275\u0275ProvidersFeature([{provide:Re.S0,useExisting:(0,e.forwardRef)(()=>Uo)}]),e.\u0275\u0275InheritDefinitionFeature]}),A(2313);let Mo=(()=>{let r=class{constructor(){this.colors=new Map,this.selectedColor=new e.EventEmitter}};return r.\u0275fac=function(o){return new(o||r)},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-palette"]],inputs:{colors:"colors"},outputs:{selectedColor:"selectedColor"},decls:2,vars:3,consts:[["type","button","class","t-button",3,"background","tuiHint","tuiHintId","tuiDescribedBy","click",4,"ngFor","ngForOf"],["type","button",1,"t-button",3,"tuiHint","tuiHintId","tuiDescribedBy","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Jr,1,5,"button",0),e.\u0275\u0275pipe(1,"keyvalue")),2&o&&e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(1,1,u.colors))},directives:[w.sg,He.D,je.OH],pipes:[w.Nd],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;padding:.875rem}.t-button[_ngcontent-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;padding:0;border:1px solid rgba(0,0,0,.08);background:0 0;font-size:inherit;line-height:inherit;width:1.5625rem;height:1.5625rem;box-sizing:border-box;margin:.375rem;border-radius:var(--tui-radius-m)}"],changeDetection:0}),ne([(0,e.Input)(),(0,ce.TH)()],r.prototype,"colors",void 0),ne([(0,e.Output)()],r.prototype,"selectedColor",void 0),r})(),So=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,He.go,je.$Z]]}),r})();function ss(r,p){if(1&r&&e.\u0275\u0275element(0,"div",8),2&r){const o=e.\u0275\u0275nextContext(2).tuiLet;e.\u0275\u0275styleProp("background",o)}}function ls(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-palette",9),e.\u0275\u0275listener("selectedColor",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).setCellColor(_)}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit,u=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("tuiActiveZoneParent",o)("colors",u.colors)}}function as(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",2,3),e.\u0275\u0275element(2,"button",4,5),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,ss,1,2,"div",6),e.\u0275\u0275template(6,ls,1,2,"ng-template",null,7,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275reference(7),j=e.\u0275\u0275nextContext().tuiLet,G=e.\u0275\u0275nextContext();e.\u0275\u0275property("content",T)("tuiDropdownMaxHeight",999)("canOpen",o),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,10,G.cellColorText$))("tuiHintId",_.id)("tuiDescribedBy",_.id)("pseudoPressed",u.open)("focusable",u.open)("disabled",!o),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!G.isBlankColor(j))}}function cs(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,as,8,12,"tui-hosted-dropdown",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(2,1,o.isActive$))}}let us=(()=>{let r=class{constructor(o,u,_){this.defaultOptions=o,this.editor=u,this.texts$=_,this.colors=this.defaultOptions.colors,this.cellColorText$=this.texts$.pipe((0,B.U)(T=>T.cellColor)),this.isActive$=this.editor.isActive$("table"),this.cellColor$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.getCellColor()||this.defaultOptions.blankColor),(0,ni.x)())}isBlankColor(o){return o===this.defaultOptions.blankColor}setCellColor(o){this.editor.setCellColor(o)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(kt),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-table-cell-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight","canOpen"],["cellColorSelect",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconPaintLarge",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable","disabled"],["cellColorBtn",""],["class","t-plate t-plate_paint",3,"background",4,"ngIf"],["cellColorDropdown",""],[1,"t-plate","t-plate_paint"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,cs,3,3,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.cellColor$))},directives:[Qe.Ls,nt.o1,Mn.Sw,te.v0,He.D,je.OH,w.O5,Mo,gt.e],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ne([(0,e.Input)(),(0,ce.TH)()],r.prototype,"colors",void 0),r=ne([se(0,(0,e.Inject)(kt)),se(1,(0,e.Inject)(Ae)),se(2,(0,e.Inject)(Ne))],r),r})(),ds=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,So,te.fN,He.go,je.$Z,gt.A,Mn.Cu,Qe.WD]]}),r})();function ps(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",2,3),e.\u0275\u0275element(2,"button",4,5),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd()),2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275nextContext(),j=e.\u0275\u0275reference(3);e.\u0275\u0275property("content",j)("canOpen",o),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,7,T.rowsColumnsManagingText$))("tuiHintId",_.id)("tuiDescribedBy",_.id)("focusable",u.open)("disabled",!o)}}function fs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",8),e.\u0275\u0275listener("click",function(){const T=e.\u0275\u0275restoreView(o).index,j=e.\u0275\u0275nextContext().index;return e.\u0275\u0275nextContext(2).onTableOption(2*j+T)}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o," ")}}function hs(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-opt-group"),e.\u0275\u0275template(1,fs,2,1,"button",7),e.\u0275\u0275elementEnd()),2&r){const o=p.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",o)}}function ms(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-data-list"),e.\u0275\u0275template(1,hs,2,1,"tui-opt-group",6),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,o.tableCommandTexts$))}}var Vn=(()=>{return(r=Vn||(Vn={}))[r.InsertColumnBefore=0]="InsertColumnBefore",r[r.InsertColumnAfter=1]="InsertColumnAfter",r[r.InsertRowBefore=2]="InsertRowBefore",r[r.InsertRowAfter=3]="InsertRowAfter",r[r.DeleteColumn=4]="DeleteColumn",r[r.DeleteRow=5]="DeleteRow",Vn;var r})();let gs=(()=>{let r=class{constructor(o,u,_){this.editor=o,this.texts$=u,this.tableCommandTexts$=_,this.commandsRegistry={[Vn.InsertColumnAfter]:()=>this.editor.addColumnAfter(),[Vn.InsertColumnBefore]:()=>this.editor.addColumnBefore(),[Vn.InsertRowAfter]:()=>this.editor.addRowAfter(),[Vn.InsertRowBefore]:()=>this.editor.addRowBefore(),[Vn.DeleteColumn]:()=>this.editor.deleteColumn(),[Vn.DeleteRow]:()=>this.editor.deleteRow()},this.isActive$=this.editor.isActive$("table"),this.rowsColumnsManagingText$=this.texts$.pipe((0,B.U)(T=>T.rowsColumnsManaging))}onTableOption(o){this.commandsRegistry[o]()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne),e.\u0275\u0275directiveInject(si))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-table-row-column-manager"]],decls:4,vars:3,consts:[[3,"content","canOpen",4,"tuiLet"],["tableOptionsDropdown",""],[3,"content","canOpen"],["tableCommand",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAddRowLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","disabled"],["tableCommandsBtn",""],[4,"ngFor","ngForOf"],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,ps,5,9,"tui-hosted-dropdown",0),e.\u0275\u0275pipe(1,"async"),e.\u0275\u0275template(2,ms,3,3,"ng-template",null,1,e.\u0275\u0275templateRefExtractor)),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.isActive$))},directives:[Qe.Ls,nt.o1,te.v0,He.D,je.OH,it.qi,w.sg,it.Rs,it.vK],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne)),se(2,(0,e.Inject)(si))],r),r})(),_s=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,He.go,je.$Z,te.fN,it.pc,Qe.WD]]}),r})();var ys=A(8355);function Cs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",4),e.\u0275\u0275listener("mouseenter",function(_){const j=e.\u0275\u0275restoreView(o).$implicit,G=e.\u0275\u0275nextContext().$implicit;return e.\u0275\u0275nextContext().updateCurrentSize(j+1,G+1,_)})("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).onClick()}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit,u=e.\u0275\u0275nextContext().$implicit,_=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("t-cell_hovered",_.tableSelectHovered(o,u))}}function bs(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275template(1,Cs,1,2,"div",3),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiRepeatTimesOf",o.rowsNumber)}}let Ms=(()=>{let r=class{constructor(o){this.windowRef=o,this.onSelectSize=new e.EventEmitter,this.tableSize={rows:1,cols:1}}get columnsNumber(){return Math.min(Math.max(3,this.tableSize.cols+1),15)}get rowsNumber(){return Math.min(Math.max(3,this.tableSize.rows+1),15)}tableSelectHovered(o,u){return o<this.tableSize.rows&&u<this.tableSize.cols}updateCurrentSize(o,u,_){(0,ys.ic)(this.windowRef)-_.clientX>70&&(this.tableSize={rows:o,cols:u})}onClick(){this.onSelectSize.emit(this.tableSize)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ti.m9))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-table-size-selector"]],outputs:{onSelectSize:"onSelectSize"},decls:3,vars:3,consts:[["class","t-column",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-description"],[1,"t-column"],["class","t-cell",3,"t-cell_hovered","mouseenter","click",4,"tuiRepeatTimes","tuiRepeatTimesOf"],[1,"t-cell",3,"mouseenter","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,bs,2,1,"div",0),e.\u0275\u0275elementStart(1,"div",1),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()),2&o&&(e.\u0275\u0275property("tuiRepeatTimesOf",u.columnsNumber),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate2("",u.tableSize.cols,"\xd7",u.tableSize.rows,""))},directives:[Pt.Xj],styles:["[_nghost-%COMP%]{display:block;padding:.75rem}.t-cell[_ngcontent-%COMP%]{display:inline-block;background-color:var(--tui-base-01);width:1.25rem;height:1.25rem;border-radius:.25rem;margin:.125rem;border:1px solid var(--tui-base-04);cursor:pointer}.t-cell_hovered[_ngcontent-%COMP%]{background-color:var(--tui-base-02)}.t-column[_ngcontent-%COMP%]{white-space:nowrap}.t-description[_ngcontent-%COMP%]{text-align:center}"],changeDetection:0}),ne([(0,e.Output)()],r.prototype,"onSelectSize",void 0),r=ne([se(0,(0,e.Inject)(Ti.m9))],r),r})(),Ss=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,Pt.Ih]]}),r})();function ks(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-table-size-selector",5),e.\u0275\u0275listener("onSelectSize",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().addTable(_)}),e.\u0275\u0275elementEnd()}}let ws=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.insertTableText$=this.texts$.pipe((0,B.U)(_=>_.insertTable))}addTable({rows:o,cols:u}){this.editor.enter();const _=this.editor.state.selection.anchor;this.editor.enter(),this.editor.enter(),this.editor.setTextSelection(_),this.editor.insertTable(o,u)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-table-create"]],decls:7,vars:7,consts:[["tuiDropdownAlign","left","tuiDropdownDirection","bottom",3,"content"],["table",""],["tuiIconButton","","type","button","size","s","icon","tuiIconTableLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable"],["tableBtn",""],["tableDropdown",""],[3,"onSelectSize"]],template:function(o,u){if(1&o&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",0,1),e.\u0275\u0275element(2,"button",2,3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,ks,1,0,"ng-template",null,4,e.\u0275\u0275templateRefExtractor)),2&o){const _=e.\u0275\u0275reference(1),T=e.\u0275\u0275reference(3),j=e.\u0275\u0275reference(6);e.\u0275\u0275property("content",j),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,5,u.insertTableText$))("tuiHintId",T.id)("tuiDescribedBy",T.id)("focusable",_.open)}},directives:[nt.o1,Mn.Sw,te.v0,He.D,je.OH,Ms],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),Is=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,Mn.Cu,te.fN,He.go,je.$Z,Ss]]}),r})();function Os(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){const T=e.\u0275\u0275restoreView(o).$implicit;return e.\u0275\u0275nextContext(2).onClick(T)}),e.\u0275\u0275pipe(1,"lowercase"),e.\u0275\u0275text(2),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit;e.\u0275\u0275styleProp("font-family",o.family)("font-size",o.px,"px")("font-weight",o.weight),e.\u0275\u0275attribute("automation-id","tui_font__"+e.\u0275\u0275pipeBind1(1,8,o.name||"")),e.\u0275\u0275advance(2),e.\u0275\u0275textInterpolate1(" ",o.name," ")}}function Ds(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-data-list"),e.\u0275\u0275template(1,Os,3,10,"button",5),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,o.fontsOptions$))}}let Es=(()=>{let r=class{constructor(o,u,_,T){this.options=o,this.editor=u,this.texts$=_,this.fontOptionsTexts$=T,this.fontsOptions$=this.fontOptionsTexts$.pipe((0,B.U)(j=>this.options.fontOptions(j))),this.fontText$=this.texts$.pipe((0,B.U)(j=>j.font))}onClick({headingLevel:o,px:u}){o?this.editor.setHeading(o):this.editor.setParagraph({fontSize:(0,Q.O)(u||0)})}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(kt),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne),e.\u0275\u0275directiveInject(Ri))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-font-size"]],decls:7,vars:8,consts:[[3,"content"],["fonts",""],["tuiIconButton","","type","button","size","s","appearance","icon","icon","tuiIconFontLarge","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["fontsBtn",""],["fontsDropdown",""],["tuiOption","",3,"fontFamily","fontSize","fontWeight","click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(o,u){if(1&o&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",0,1),e.\u0275\u0275element(2,"button",2,3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,Ds,3,3,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){const _=e.\u0275\u0275reference(1),T=e.\u0275\u0275reference(3),j=e.\u0275\u0275reference(6);e.\u0275\u0275property("content",j),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,6,u.fontText$))("tuiHintId",T.id)("tuiDescribedBy",T.id)("pseudoPressed",_.open)("focusable",_.open)}},directives:[nt.o1,te.v0,He.D,je.OH,it.qi,w.sg,it.vK],pipes:[w.Ov,w.i8],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(kt)),se(1,(0,e.Inject)(Ae)),se(2,(0,e.Inject)(Ne)),se(3,(0,e.Inject)(Ri))],r),r})(),Ps=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,He.go,je.$Z,it.pc]]}),r})();function Ns(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",12),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(4).editor.toggleBold()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275nextContext(2).ngIf,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("tuiHint",u.bold)("pseudoPressed",o.bold)}}function Rs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",13),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(4).editor.toggleItalic()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275nextContext(2).ngIf,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("tuiHint",u.italic)("pseudoPressed",o.italic)}}function As(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",14),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(4).editor.toggleUnderline()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275nextContext(2).ngIf,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("tuiHint",u.underline)("pseudoPressed",o.underline)}}function Bs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",15),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(4).editor.toggleStrike()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275nextContext(2).ngIf,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("tuiHint",u.strikeThrough)("pseudoPressed",o.strike)}}function Fs(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",7),e.\u0275\u0275template(1,Ns,1,2,"button",8),e.\u0275\u0275template(2,Rs,1,2,"button",9),e.\u0275\u0275template(3,As,1,2,"button",10),e.\u0275\u0275template(4,Bs,1,2,"button",11),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(3);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isEnabled(o.TuiEditorTool.Bold)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isEnabled(o.TuiEditorTool.Italic)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isEnabled(o.TuiEditorTool.Underline)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.isEnabled(o.TuiEditorTool.Strikethrough))}}function zs(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",2,3),e.\u0275\u0275element(2,"button",4,5),e.\u0275\u0275template(4,Fs,5,4,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=p.ngIf,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275reference(5),j=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("content",T),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",j.fontStyle)("tuiHintId",_.id)("tuiDescribedBy",_.id)("pseudoPressed",u.open||o.bold||o.italic||o.underline||o.strike)("focusable",u.open)}}function Ls(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,zs,6,6,"tui-hosted-dropdown",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,1,o.fontStyleState$))}}let Hs=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.toolsSet=new Set(sn),this.TuiEditorTool=K,this.fontStyleState$=(0,Rt.a)([this.editor.isActive$("bold"),this.editor.isActive$("italic"),this.editor.isActive$("underline"),this.editor.isActive$("strike")]).pipe((0,B.U)(([_,T,j,G])=>({bold:_,italic:T,underline:j,strike:G})))}set enabledTools(o){this.toolsSet=new Set(o)}isEnabled(o){return this.toolsSet.has(o)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-font-style"]],inputs:{enabledTools:"enabledTools"},decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content",4,"ngIf"],[3,"content"],["format",""],["tuiIconButton","","type","button","size","s","icon","tuiIconFormatLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__font-style-button",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["formatBtn",""],["formatDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoPressed","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoPressed","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoPressed","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon","class","t-option t-option_margin",3,"tuiHint","pseudoPressed","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconBoldLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconItalicLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconUnderlineLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconStrikeThroughLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Ls,3,3,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.texts$))},directives:[Qe.Ls,w.O5,nt.o1,te.v0,He.D,je.OH],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ne([(0,e.Input)()],r.prototype,"enabledTools",null),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),js=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,He.go,je.$Z,Qe.WD]]}),r})();function Vs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7)(1,"button",8),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.onAlign("left")}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",9),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.onAlign("center")}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",10),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.onAlign("right")}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",11),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.onAlign("justify")}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275nextContext().tuiLet,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275advance(1),e.\u0275\u0275property("pseudoPressed",o.left)("tuiHint",u.justifyLeft),e.\u0275\u0275advance(1),e.\u0275\u0275property("pseudoPressed",o.center)("tuiHint",u.justifyCenter),e.\u0275\u0275advance(1),e.\u0275\u0275property("pseudoPressed",o.right)("tuiHint",u.justifyRight),e.\u0275\u0275advance(1),e.\u0275\u0275property("pseudoPressed",o.justify)("tuiHint",u.justifyFull)}}function $s(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",2,3),e.\u0275\u0275element(2,"button",4,5),e.\u0275\u0275template(4,Vs,5,8,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275reference(1),u=e.\u0275\u0275reference(3),_=e.\u0275\u0275reference(5),T=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("content",_),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",T.justify)("tuiHintId",u.id)("tuiDescribedBy",u.id)("pseudoPressed",o.open)("focusable",o.open)}}function Us(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,$s,6,6,"tui-hosted-dropdown",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(2,1,o.alignState$))}}let Ws=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.alignState$=(0,Rt.a)([this.editor.isActive$({textAlign:"left"}),this.editor.isActive$({textAlign:"right"}),this.editor.isActive$({textAlign:"center"}),this.editor.isActive$({textAlign:"justify"})]).pipe((0,B.U)(([_,T,j,G])=>({left:_,right:T,center:j,justify:G})))}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-align-content"]],decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content",4,"tuiLet"],[3,"content"],["align",""],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["alignBtn",""],["alignDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignLeftLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoPressed","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignCenterLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoPressed","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignRightLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoPressed","tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconAlignJustifyLarge","appearance","icon",1,"t-option","t-option_margin",3,"pseudoPressed","tuiHint","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Us,3,3,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.texts$))},directives:[Qe.Ls,nt.o1,te.v0,He.D,je.OH],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),Js=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,He.go,je.$Z,Qe.WD]]}),r})();function Ks(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",7)(1,"button",8),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.toggleUnorderedList()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(2,"button",9),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).editor.toggleOrderedList()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",10),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).sinkListItemOrIndent()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"button",11),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).liftListItemOrOutdent()}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275nextContext().tuiLet,u=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.unorderedList)("pseudoPressed",o.unordered),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.orderedList)("pseudoPressed",o.ordered),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.indent),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.outdent)}}function Ys(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",2,3),e.\u0275\u0275element(2,"button",4,5),e.\u0275\u0275template(4,Ks,5,6,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275reference(5),j=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275property("content",T),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",j.list)("tuiHintId",_.id)("tuiDescribedBy",_.id)("pseudoPressed",u.open||o.unordered||o.ordered)("focusable",u.open)}}function Gs(r,p){if(1&r&&(e.\u0275\u0275elementContainerStart(0),e.\u0275\u0275template(1,Ys,6,6,"tui-hosted-dropdown",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementContainerEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(2,1,o.listState$))}}let Zs=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.listState$=(0,Rt.a)([this.editor.isActive$("orderedList"),this.editor.isActive$("bulletList")]).pipe((0,B.U)(([_,T])=>({ordered:_,unordered:T})))}sinkListItemOrIndent(){Qt(this.editor.getOriginTiptapEditor())?this.editor.sinkListItem():this.editor.indent()}liftListItemOrOutdent(){Qt(this.editor.getOriginTiptapEditor())?this.editor.liftListItem():this.editor.outdent()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-list-configs"]],decls:2,vars:3,consts:[[4,"tuiLet"],[3,"content",4,"tuiLet"],[3,"content"],["list",""],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__ordering-list-button",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["listBtn",""],["listDropdown",""],[1,"t-dropdown"],["tuiIconButton","","type","button","size","s","icon","tuiIconViewListLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOLLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","pseudoPressed","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconIndentLarge","appearance","icon",1,"t-option","t-option_margin",3,"tuiHint","click"],["tuiIconButton","","type","button","size","s","icon","tuiIconOutdentLarge","appearance","icon",1,"t-option",3,"tuiHint","click"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,Gs,3,3,"ng-container",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.texts$))},directives:[Qe.Ls,nt.o1,te.v0,He.D,je.OH],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),Qs=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,He.go,je.$Z,Qe.WD]]}),r})();function Xs(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-palette",7),e.\u0275\u0275listener("selectedColor",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).editor.setFontColor(_)}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit,u=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tuiActiveZoneParent",o)("colors",u.colors)}}function qs(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",1,2),e.\u0275\u0275element(2,"button",3,4),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275element(5,"div",5),e.\u0275\u0275template(6,Xs,1,2,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275reference(7),j=e.\u0275\u0275nextContext();e.\u0275\u0275property("content",T)("tuiDropdownMaxHeight",999),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,9,j.foreColorText$))("tuiHintId",_.id)("tuiDescribedBy",_.id)("pseudoPressed",u.open)("focusable",u.open),e.\u0275\u0275advance(3),e.\u0275\u0275styleProp("background",o)}}let el=(()=>{let r=class{constructor(o,u,_){this.defaultOptions=o,this.editor=u,this.texts$=_,this.colors=this.defaultOptions.colors,this.fontColor$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.getFontColor()||this.defaultOptions.blankColor),(0,ni.x)()),this.foreColorText$=this.texts$.pipe((0,B.U)(T=>T.foreColor))}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(kt),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-text-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["color",""],["tuiIconButton","","type","button","size","s","icon","tuiIconColorLarge","appearance","icon","tuiHintDirection","top-left","automation-id","toolbar__color-button",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["colorBtn",""],[1,"t-plate"],["colorDropdown",""],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,qs,8,11,"tui-hosted-dropdown",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.fontColor$))},directives:[Qe.Ls,nt.o1,Mn.Sw,te.v0,He.D,je.OH,Mo,gt.e],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ne([(0,e.Input)(),(0,ce.TH)()],r.prototype,"colors",void 0),r=ne([se(0,(0,e.Inject)(kt)),se(1,(0,e.Inject)(Ae)),se(2,(0,e.Inject)(Ne))],r),r})(),tl=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,te.fN,nt.jh,Mn.Cu,He.go,je.$Z,So,gt.A,Qe.WD]]}),r})();function nl(r,p){if(1&r&&e.\u0275\u0275element(0,"div",7),2&r){const o=e.\u0275\u0275nextContext().tuiLet;e.\u0275\u0275styleProp("background",o)}}function il(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-palette",8),e.\u0275\u0275listener("selectedColor",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).editor.setBackgroundColor(_)}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit,u=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tuiActiveZoneParent",o)("colors",u.colors)}}function ol(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",1,2),e.\u0275\u0275element(2,"button",3,4),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275template(5,nl,1,2,"div",5),e.\u0275\u0275template(6,il,1,2,"ng-template",null,6,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=p.tuiLet,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275reference(3),T=e.\u0275\u0275reference(7),j=e.\u0275\u0275nextContext();e.\u0275\u0275property("content",T)("tuiDropdownMaxHeight",999),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,8,j.backColorText$))("tuiHintId",_.id)("tuiDescribedBy",_.id)("pseudoPressed",u.open)("focusable",u.open),e.\u0275\u0275advance(3),e.\u0275\u0275property("ngIf",!j.isBlankColor(o))}}let rl=(()=>{let r=class{constructor(o,u,_){this.editor=o,this.texts$=u,this.defaultOptions=_,this.colors=this.defaultOptions.colors,this.backgroundColor$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.getBackgroundColor()||this.defaultOptions.blankColor),(0,ni.x)()),this.backColorText$=this.texts$.pipe((0,B.U)(T=>T.backColor))}isBlankColor(o){return o===this.defaultOptions.blankColor}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne),e.\u0275\u0275directiveInject(kt))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-highlight-color"]],inputs:{colors:"colors"},decls:2,vars:3,consts:[[3,"content","tuiDropdownMaxHeight",4,"tuiLet"],[3,"content","tuiDropdownMaxHeight"],["hilite",""],["tuiIconButton","","type","button","size","s","tuiHintDirection","top-left","appearance","icon","icon","tuiIconHiliteLarge","automation-id","toolbar__hilite-button",1,"t-tool",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["hiliteBtn",""],["class","t-plate",3,"background",4,"ngIf"],["hiliteDropdown",""],[1,"t-plate"],[1,"t-color-picker",3,"tuiActiveZoneParent","colors","selectedColor"]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,ol,8,10,"tui-hosted-dropdown",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(1,1,u.backgroundColor$))},directives:[Qe.Ls,nt.o1,Mn.Sw,te.v0,He.D,je.OH,w.O5,Mo,gt.e],pipes:[w.Ov],styles:[".t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-option[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-option[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-option_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-color-picker[_ngcontent-%COMP%]{box-sizing:border-box;max-width:21.25rem}"],changeDetection:0}),ne([(0,e.Input)(),(0,ce.TH)()],r.prototype,"colors",void 0),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne)),se(2,(0,e.Inject)(kt))],r),r})(),sl=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,So,He.go,je.$Z,Mn.Cu,gt.A,Qe.WD]]}),r})();function ll(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",6),e.\u0275\u0275listener("click",function(){const T=e.\u0275\u0275restoreView(o).index;return e.\u0275\u0275nextContext(2).onCode(!!T)}),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()}if(2&r){const o=p.$implicit;e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o," ")}}function al(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-data-list"),e.\u0275\u0275template(1,ll,2,1,"button",5),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngForOf",e.\u0275\u0275pipeBind1(2,1,o.codeOptionsTexts$))}}let cl=(()=>{let r=class{constructor(o,u,_){this.editor=o,this.texts$=u,this.codeOptionsTexts$=_,this.hintText$=this.texts$.pipe((0,B.U)(T=>T.code)),this.insideCode$=this.editor.stateChange$.pipe((0,B.U)(()=>this.editor.isActive("code")||this.editor.isActive("codeBlock")),(0,ni.x)())}onCode(o){o?this.editor.toggleCodeBlock():this.editor.toggleCode()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne),e.\u0275\u0275directiveInject(Ni))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-code"]],decls:8,vars:10,consts:[[3,"content"],["codes",""],["tuiIconButton","","type","button","size","s","icon","tuiIconCodeLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["codeBtn",""],["codesDropdown",""],["tuiOption","",3,"click",4,"ngFor","ngForOf"],["tuiOption","",3,"click"]],template:function(o,u){if(1&o&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",0,1),e.\u0275\u0275element(2,"button",2,3),e.\u0275\u0275pipe(4,"async"),e.\u0275\u0275pipe(5,"async"),e.\u0275\u0275template(6,al,3,3,"ng-template",null,4,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&o){const _=e.\u0275\u0275reference(1),T=e.\u0275\u0275reference(3),j=e.\u0275\u0275reference(7);e.\u0275\u0275property("content",j),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",e.\u0275\u0275pipeBind1(4,6,u.hintText$))("tuiHintId",T.id)("tuiDescribedBy",T.id)("pseudoPressed",_.open||e.\u0275\u0275pipeBind1(5,8,u.insideCode$))("focusable",_.open)}},directives:[nt.o1,te.v0,He.D,je.OH,it.qi,w.sg,it.vK],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne)),se(2,(0,e.Inject)(Ni))],r),r})(),ul=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,nt.jh,te.fN,He.go,je.$Z,it.pc]]}),r})();function dl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1,2),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().setDetails()}),e.\u0275\u0275elementEnd()}if(2&r){const o=p.ngIf,u=e.\u0275\u0275reference(1);e.\u0275\u0275property("tuiHint",o.setDetails)("tuiHintId",u.id)("tuiDescribedBy",u.id)("focusable",!1)}}function pl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",1,2),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().removeDetails()}),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()}if(2&r){const o=p.ngIf,u=e.\u0275\u0275reference(1),_=e.\u0275\u0275nextContext();e.\u0275\u0275property("tuiHint",o.removeDetails)("tuiHintId",u.id)("tuiDescribedBy",u.id)("focusable",!1)("disabled",!!e.\u0275\u0275pipeBind1(2,5,_.disabled$))}}let fl=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u}setDetails(){this.editor.setDetails()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-details"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click"],["detailBtn",""]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,dl,2,4,"button",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,u.texts$))},directives:[w.O5,te.v0,He.D,je.OH],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),hl=(()=>{let r=class{constructor(o,u){this.editor=o,this.texts$=u,this.disabled$=this.editor.stateChange$.pipe((0,B.U)(()=>!this.editor.isActive("details")),(0,ni.x)())}removeDetails(){this.editor.removeDetails()}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(Ne))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-details-remove"]],decls:2,vars:3,consts:[["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","disabled","click",4,"ngIf"],["tuiIconButton","","type","button","size","s","icon","tuiIconSpoilerDeleteLarge","appearance","icon","tuiHintDirection","top-left",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","disabled","click"],["removeDetailBtn",""]],template:function(o,u){1&o&&(e.\u0275\u0275template(0,pl,3,7,"button",0),e.\u0275\u0275pipe(1,"async")),2&o&&e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(1,1,u.texts$))},directives:[w.O5,te.v0,He.D,je.OH],pipes:[w.Ov],encapsulation:2,changeDetection:0}),r=ne([se(0,(0,e.Inject)(Ae)),se(1,(0,e.Inject)(Ne))],r),r})(),ml=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,te.fN,He.go,je.$Z]]}),r})();const gl=["dropdown"],_l=["new",""];function yl(r,p){1&r&&e.\u0275\u0275elementContainer(0)}function Cl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"button",7,8),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).undo()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"button",9,10),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).redo()}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275reference(4),_=e.\u0275\u0275nextContext().ngIf,T=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",_.undo)("tuiHintId",o.id)("tuiDescribedBy",o.id)("disabled",T.undoDisabled)("focusable",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",_.redo)("tuiHintId",u.id)("tuiDescribedBy",u.id)("disabled",T.redoDisabled)("focusable",!1)}}function bl(r,p){1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275element(1,"tui-font-size",11),e.\u0275\u0275elementEnd())}function vl(r,p){if(1&r&&e.\u0275\u0275element(0,"tui-font-style",17),2&r){const o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("enabledTools",o.toolsSet)}}function xl(r,p){1&r&&e.\u0275\u0275element(0,"tui-align-content",11)}function Tl(r,p){1&r&&e.\u0275\u0275element(0,"tui-list-configs",11)}function Ml(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",18,19),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).toggleQuote()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf,_=e.\u0275\u0275nextContext();e.\u0275\u0275property("tuiHint",u.quote)("tuiHintId",o.id)("tuiDescribedBy",o.id)("pseudoPressed",_.blockquote)("disabled",_.unorderedList||_.orderedList)("focusable",!1)}}function Sl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-edit-link",25,26),e.\u0275\u0275listener("addLink",function(_){e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext();const T=e.\u0275\u0275reference(1);return e.\u0275\u0275nextContext(3).onLink(T,_)})("removeLink",function(){e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext();const _=e.\u0275\u0275reference(1);return e.\u0275\u0275nextContext(3).onLink(_)}),e.\u0275\u0275elementEnd()}}function kl(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-hosted-dropdown",20,21),e.\u0275\u0275element(2,"button",22,23),e.\u0275\u0275template(5,Sl,2,0,"ng-template",null,24,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275reference(1),u=e.\u0275\u0275reference(4),_=e.\u0275\u0275reference(6),T=e.\u0275\u0275nextContext(2).ngIf,j=e.\u0275\u0275nextContext();e.\u0275\u0275property("canOpen",!j.a)("content",_),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiHint",T.link)("tuiHintId",u.id)("tuiDescribedBy",u.id)("pseudoPressed",o.open||j.a)("focusable",o.open)}}function wl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",27,28),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).onAttach()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275property("tuiHint",u.attach)("tuiHintId",o.id)("tuiDescribedBy",o.id)("focusable",!1)}}function Il(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275template(1,vl,1,1,"tui-font-style",12),e.\u0275\u0275template(2,xl,1,0,"tui-align-content",13),e.\u0275\u0275template(3,Tl,1,0,"tui-list-configs",13),e.\u0275\u0275template(4,Ml,3,6,"button",14),e.\u0275\u0275template(5,kl,7,7,"tui-hosted-dropdown",15),e.\u0275\u0275template(6,wl,3,4,"button",16),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.formatEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Align)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.List)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Quote)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Link)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Attach))}}function Ol(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",31,32),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).toggleSubscript()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf,_=e.\u0275\u0275nextContext();e.\u0275\u0275property("tuiHint",u.subscript)("tuiHintId",o.id)("tuiDescribedBy",o.id)("pseudoPressed",_.subscript)("focusable",!1)}}function Dl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",33,34),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).toggleSuperscript()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf,_=e.\u0275\u0275nextContext();e.\u0275\u0275property("tuiHint",u.superscript)("tuiHintId",o.id)("tuiDescribedBy",o.id)("pseudoPressed",_.superscript)("focusable",!1)}}function El(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275template(1,Ol,3,5,"button",29),e.\u0275\u0275template(2,Dl,3,5,"button",30),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Sub)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Sup))}}function Pl(r,p){if(1&r&&e.\u0275\u0275element(0,"tui-text-color",36),2&r){const o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("colors",o.colors)}}function Nl(r,p){if(1&r&&e.\u0275\u0275element(0,"tui-highlight-color",36),2&r){const o=e.\u0275\u0275nextContext(3);e.\u0275\u0275property("colors",o.colors)}}function Rl(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275template(1,Pl,1,1,"tui-text-color",35),e.\u0275\u0275template(2,Nl,1,1,"tui-highlight-color",35),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Color)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Hilite))}}function Al(r,p){1&r&&e.\u0275\u0275element(0,"tui-code",11)}function Bl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",40,41),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).onTeX()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275property("tuiHint",u.tex)("tuiHintId",o.id)("tuiDescribedBy",o.id)("focusable",!1)}}function Fl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",42)(1,"button",43,44),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275reference(4).click()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(3,"input",45,46),e.\u0275\u0275listener("change",function(){e.\u0275\u0275restoreView(o);const _=e.\u0275\u0275reference(4);return e.\u0275\u0275nextContext(3).onImage(_)}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.image)("id",o.id)("tuiHintId",o.id)("focusable",!1),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiFocusable",!1)}}function zl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"button",47,48),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(3).insertHorizontalRule()}),e.\u0275\u0275elementEnd()}if(2&r){const o=e.\u0275\u0275reference(2),u=e.\u0275\u0275nextContext(2).ngIf;e.\u0275\u0275property("tuiHint",u.insertHorizontalRule)("tuiHintId",o.id)("tuiDescribedBy",o.id)("focusable",!1)}}function Ll(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275template(1,Al,1,0,"tui-code",13),e.\u0275\u0275template(2,Bl,3,4,"button",37),e.\u0275\u0275template(3,Fl,5,5,"div",38),e.\u0275\u0275template(4,zl,3,4,"button",39),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Code)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Tex)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Img)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.HR))}}function Hl(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",6)(1,"button",49,50),e.\u0275\u0275listener("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).removeFormat()}),e.\u0275\u0275elementEnd()()}if(2&r){const o=e.\u0275\u0275reference(3),u=e.\u0275\u0275nextContext().ngIf;e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiHint",u.clear)("tuiHintId",o.id)("tuiDescribedBy",o.id)("focusable",!1)}}function jl(r,p){1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275element(1,"tui-details",51)(2,"tui-details-remove",51),e.\u0275\u0275elementEnd())}function Vl(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",6),e.\u0275\u0275element(1,"tui-table-create",51)(2,"tui-table-row-column-manager",51)(3,"tui-table-merge-cells",51)(4,"tui-table-cell-color",36),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(4),e.\u0275\u0275property("colors",o.colors)}}function $l(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"section",4),e.\u0275\u0275template(1,Cl,5,10,"div",5),e.\u0275\u0275template(2,bl,2,0,"div",5),e.\u0275\u0275template(3,Il,7,6,"div",5),e.\u0275\u0275template(4,El,3,2,"div",5),e.\u0275\u0275template(5,Rl,3,2,"div",5),e.\u0275\u0275template(6,Ll,5,4,"div",5),e.\u0275\u0275template(7,Hl,4,4,"div",5),e.\u0275\u0275template(8,jl,3,0,"div",5),e.\u0275\u0275template(9,Vl,5,1,"div",5),e.\u0275\u0275elementStart(10,"div",6),e.\u0275\u0275projection(11),e.\u0275\u0275elementEnd()()),2&r){const o=e.\u0275\u0275nextContext();e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Undo)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Size)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.firstBigBlockEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Sub)||o.enabled(o.TuiEditorTool.Sup)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Color)||o.enabled(o.TuiEditorTool.Hilite)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.secondBigBlockEnabled),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Clear)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Details)),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",o.enabled(o.TuiEditorTool.Table))}}const Ul=["*"];let Eo=(()=>{let r=class{constructor(o){this.elementRef=o}get toolsContainers(){return Array.from(this.elementRef.nativeElement.querySelectorAll("[tuiToolbarTool]"))}onHorizontalNavigation(o){const{toolsContainers:u}=this,_=u.findIndex(Je.KF),j=u[(0,Be.uZ)(_+(o?-1:1),0,u.length-1)],G=o?this.findPreviousTool(j):this.findNextTool(j);G&&(0,Je.NY)(G)}findFirstFocusableTool(o=!1){const u=o?this.toolsContainers.slice().reverse():this.toolsContainers;for(const _ of u){const T=(0,Je.wG)(_)?_:(0,Je.kA)(_,!1,_,!1);if(T)return T}return null}findPreviousTool(o){return(0,Je.wG)(o)?o:(0,Je.kA)(o,!1,o,!1)||(0,Je.kA)(o,!0,this.elementRef.nativeElement,!1)}findNextTool(o){return(0,Je.wG)(o)?o:(0,Je.kA)(o,!1,this.elementRef.nativeElement,!1)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(e.ElementRef))},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["","tuiToolbarNavigationManager",""]],hostBindings:function(o,u){1&o&&e.\u0275\u0275listener("keydown.arrowRight.prevent",function(){return u.onHorizontalNavigation(!1)})("keydown.arrowLeft.prevent",function(){return u.onHorizontalNavigation(!0)})}}),ne([(0,e.HostListener)("keydown.arrowRight.prevent",["false"]),(0,e.HostListener)("keydown.arrowLeft.prevent",["true"])],r.prototype,"onHorizontalNavigation",null),r=ne([se(0,(0,e.Inject)(e.ElementRef))],r),r})(),Po=(()=>{let r=class{constructor(o,u,_,T,j){this.elementRef=o,this.editor=u,this.imageLoader=_,this.texts$=T,this.defaultOptions=j,this.dropdowns=Nt.Mm,this.colors=this.defaultOptions.colors,this.disabled=!1,this.linkAdded=new e.EventEmitter,this.texClicked=new e.EventEmitter,this.attachClicked=new e.EventEmitter,this.TuiEditorTool=K,this.toolsSet=new Set(sn)}set tools(o){this.toolsSet=new Set(o)}get focused(){return(0,Je.KF)(this.elementRef.nativeElement)||!!this.dropdowns.find(({nativeElement:o})=>(0,Je.KF)(o))}get focusable(){return!this.focused&&!this.disabled}get unorderedList(){return this.editor.isActive("bulletList")}get orderedList(){return this.editor.isActive("orderedList")}get blockquote(){return this.editor.isActive("blockquote")}get a(){return this.editor.isActive("link")}get undoDisabled(){return this.editor.undoDisabled()}get redoDisabled(){return this.editor.redoDisabled()}get subscript(){return this.editor.isActive("subscript")}get superscript(){return this.editor.isActive("superscript")}get formatEnabled(){return this.enabled(K.Bold)||this.enabled(K.Italic)||this.enabled(K.Underline)||this.enabled(K.Strikethrough)}get firstBigBlockEnabled(){return this.formatEnabled||this.enabled(K.Align)||this.enabled(K.List)||this.enabled(K.Quote)||this.enabled(K.Link)||this.enabled(K.Attach)}get secondBigBlockEnabled(){return this.enabled(K.Code)||this.enabled(K.Tex)||this.enabled(K.Img)||this.enabled(K.HR)}onMouseDown(o,u){(0,Tt.Q4)(u,"button")||(o.preventDefault(),this.editor.focus())}onBottomFocus(){this.focusLast()}onTopFocus(){this.focusFirst()}onImage(o){var u;const _=null===(u=o.files)||void 0===u?void 0:u[0];o.value="",_&&this.imageLoader(_).pipe((0,vn.q)(1)).subscribe(T=>{this.addImage(T)})}onAttach(){this.attachClicked.emit()}onTeX(){this.texClicked.emit()}onLink(o,u){o.open=!1,u&&(this.editor.toggleLink(u),this.editor.selectClosest())}enabled(o){return this.toolsSet.has(o)}undo(){this.editor.undo()}redo(){this.editor.redo()}insertHorizontalRule(){this.editor.setHorizontalRule()}removeFormat(){this.editor.removeFormat()}toggleOrderedList(){this.editor.toggleOrderedList()}toggleQuote(){this.editor.toggleBlockquote()}toggleSubscript(){this.editor.toggleSubscript()}toggleSuperscript(){this.editor.toggleSuperscript()}addImage(o){this.editor.setImage(o)}focusFirst(){var o;const u=null===(o=this.navigationManager)||void 0===o?void 0:o.findFirstFocusableTool();u&&(0,Je.NY)(u)}focusLast(){var o;const u=null===(o=this.navigationManager)||void 0===o?void 0:o.findFirstFocusableTool(!0);u&&(0,Je.NY)(u)}};return r.\u0275fac=function(o){return new(o||r)(e.\u0275\u0275directiveInject(e.ElementRef,8),e.\u0275\u0275directiveInject(Ae),e.\u0275\u0275directiveInject(li),e.\u0275\u0275directiveInject(Ne),e.\u0275\u0275directiveInject(kt))},r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-toolbar","new",""]],viewQuery:function(o,u){if(1&o&&(e.\u0275\u0275viewQuery(Eo,5),e.\u0275\u0275viewQuery(gl,5,e.ElementRef)),2&o){let _;e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(u.navigationManager=_.first),e.\u0275\u0275queryRefresh(_=e.\u0275\u0275loadQuery())&&(u.dropdowns=_)}},hostAttrs:["role","toolbar"],hostVars:2,hostBindings:function(o,u){1&o&&e.\u0275\u0275listener("mousedown",function(T){return u.onMouseDown(T,T.target)}),2&o&&e.\u0275\u0275classProp("_disabled",u.disabled)},inputs:{colors:"colors",disabled:"disabled",tools:"tools"},outputs:{linkAdded:"linkAdded",texClicked:"texClicked",attachClicked:"attachClicked"},features:[e.\u0275\u0275ProvidersFeature([we.Sm])],attrs:_l,ngContentSelectors:Ul,decls:7,vars:8,consts:[[1,"t-prevent-parent-label-behavior"],[4,"ngIf"],[3,"tuiFocusable","focus"],["tuiToolbarNavigationManager","","class","t-tools-wrapper",4,"ngIf"],["tuiToolbarNavigationManager","",1,"t-tools-wrapper"],["class","t-block",4,"ngIf"],[1,"t-block"],["tuiToolbarTool","","tuiIconButton","","type","button","size","s","icon","tuiIconUndoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","disabled","focusable","click"],["undoBtn",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconRedoLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","disabled","focusable","click"],["redoBtn",""],["tuiToolbarTool","",1,"t-tool","t-wrapper"],["tuiToolbarTool","","class","t-tool t-wrapper",3,"enabledTools",4,"ngIf"],["tuiToolbarTool","","class","t-tool t-wrapper",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","disabled","focusable","click",4,"ngIf"],["tuiToolbarTool","","class","t-wrapper",3,"canOpen","content",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click",4,"ngIf"],["tuiToolbarTool","",1,"t-tool","t-wrapper",3,"enabledTools"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconQuoteLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","disabled","focusable","click"],["button","","quoteBtn",""],["tuiToolbarTool","",1,"t-wrapper",3,"canOpen","content"],["link",""],["tuiIconButton","","type","button","size","s","icon","tuiIconLinkLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable"],["button","","linkBtn",""],["linkDropdown",""],[3,"addLink","removeLink"],["dropdown",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconAttachLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click"],["button","","attachBtn",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable","click",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable","click",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconSubscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable","click"],["button","","subBtn",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconSuperscriptLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","pseudoPressed","focusable","click"],["button","","supBtn",""],["tuiToolbarTool","","class","t-tool t-wrapper",3,"colors",4,"ngIf"],["tuiToolbarTool","",1,"t-tool","t-wrapper",3,"colors"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click",4,"ngIf"],["tuiToolbarTool","","class","t-wrapper",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left","class","t-tool t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click",4,"ngIf"],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconTeXLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click"],["button","","texBtn",""],["tuiToolbarTool","",1,"t-wrapper"],["tuiIconButton","","type","button","size","s","icon","tuiIconImgLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool",3,"tuiHint","id","tuiHintId","focusable","click"],["button",""],["type","file","accept","image/*",1,"t-image",3,"tuiFocusable","change"],["image",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconHrLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click"],["button","","hrBtn",""],["tuiIconButton","","tuiToolbarTool","","type","button","size","s","icon","tuiIconClearFormatLarge","appearance","icon","tuiHintDirection","top-left",1,"t-tool","t-tool_margin",3,"tuiHint","tuiHintId","tuiDescribedBy","focusable","click"],["button","","clearBtn",""],["tuiToolbarTool","",1,"t-tool","t-tool_margin"]],template:function(o,u){1&o&&(e.\u0275\u0275projectionDef(),e.\u0275\u0275element(0,"button",0),e.\u0275\u0275template(1,yl,1,0,"ng-container",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementStart(3,"div",2),e.\u0275\u0275listener("focus",function(){return u.onTopFocus()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(4,"div",2),e.\u0275\u0275listener("focus",function(){return u.onBottomFocus()}),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,$l,12,9,"section",3),e.\u0275\u0275pipe(6,"async")),2&o&&(e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(2,4,u.editor.stateChange$)),e.\u0275\u0275advance(2),e.\u0275\u0275property("tuiFocusable",u.focusable),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiFocusable",u.focusable),e.\u0275\u0275advance(1),e.\u0275\u0275property("ngIf",e.\u0275\u0275pipeBind1(6,6,u.texts$)))},directives:function(){return[w.O5,en.t,Eo,te.v0,Jl,He.D,je.OH,Es,Hs,Ws,Zs,nt.o1,yo,el,rl,cl,fl,hl,ws,gs,Sr,us]},pipes:function(){return[w.Ov]},styles:[".t-tools-wrapper[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;padding:.25rem .75rem;overflow:auto;flex-wrap:wrap;box-shadow:0 .125rem .1875rem rgba(0,0,0,.1)}.t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar, .t-tools-wrapper[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:0 0;width:0;height:0}.t-tools-wrapper._disabled[_ngcontent-%COMP%]{pointer-events:none;opacity:var(--tui-disabled-opacity)}.t-block[_ngcontent-%COMP%]{display:flex;padding:.25rem 0}.t-block[_ngcontent-%COMP%]:not(:last-child):after{content:'';display:block;margin:0 .25rem;width:1px;background:var(--tui-secondary-active)}.t-tool[_ngcontent-%COMP%]{transition-property:background;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out}.t-tool[_ngcontent-%COMP%]     button:hover, button.t-tool[_ngcontent-%COMP%]:hover{background:var(--tui-secondary-hover)}.t-tool_margin[_ngcontent-%COMP%]{margin:0 .25rem}.t-dropdown[_ngcontent-%COMP%]{padding:.75rem}.t-wrapper[_ngcontent-%COMP%]{position:relative;margin:0 .25rem}.t-plate[_ngcontent-%COMP%]{position:absolute;top:1.375rem;left:.25rem;width:1.5rem;height:.25rem;pointer-events:none}.t-plate_paint[_ngcontent-%COMP%]{left:.375rem;width:1.25rem}.t-font[_ngcontent-%COMP%]{padding:.3em 0;outline:0;width:100%;pointer-events:none}.t-image[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;font-size:0;opacity:0;cursor:pointer}.t-image[_ngcontent-%COMP%]::-webkit-file-upload-button{display:none}.t-color-picker[_ngcontent-%COMP%]     tui-color-edit, .t-color-picker[_ngcontent-%COMP%]     tui-color-picker, .t-color-picker[_ngcontent-%COMP%]     tui-hosted-dropdown{display:none}.t-prevent-parent-label-behavior[_ngcontent-%COMP%]{display:none}"],changeDetection:0}),ne([(0,e.ViewChildren)("dropdown",{read:e.ElementRef})],r.prototype,"dropdowns",void 0),ne([(0,e.ViewChild)(Eo)],r.prototype,"navigationManager",void 0),ne([(0,e.Input)(),(0,ce.TH)()],r.prototype,"colors",void 0),ne([(0,e.Input)(),(0,e.HostBinding)("class._disabled"),(0,ce.TH)()],r.prototype,"disabled",void 0),ne([(0,e.Output)()],r.prototype,"linkAdded",void 0),ne([(0,e.Output)()],r.prototype,"texClicked",void 0),ne([(0,e.Output)()],r.prototype,"attachClicked",void 0),ne([(0,e.Input)(),(0,ce.TH)(Wl,"Attach and TeX are not yet implemented in Editor")],r.prototype,"tools",null),ne([(0,e.HostListener)("mousedown",["$event","$event.target"])],r.prototype,"onMouseDown",null),r=ne([se(0,(0,e.Optional)()),se(0,(0,e.Inject)(e.ElementRef)),se(1,(0,e.Inject)(Ae)),se(2,(0,e.Inject)(li)),se(3,(0,e.Inject)(Ne)),se(4,(0,e.Inject)(kt))],r),r})();function Wl(r){return!r.includes(K.Tex)&&!r.includes(K.Attach)}let Jl=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["","tuiToolbarTool",""]]}),r})(),Kl=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,He.go,en.u,te.fN,nt.jh,Bo,je.$Z,kr,ds,_s,Is,Ps,js,Js,Qs,tl,sl,ul,ml]]}),r})();var No,Ji=A(1550),Ko=A(5052),Yl=A(4782),Yo=A(9951),Go=A(1279),Gl=A(3197),Ql=A(6304);let Sn=No=class extends Vo.V7{constructor(p,o,u,_,T,j,G,Ce,pe,Pe,et,tt,Lt,Di){if(super(o,u,_,Ce||T,j),this.refresh$=Pe,this.changeDetectorRef=et,this.ngZone=tt,this.renderer=Lt,this.viewContainerRef=Di,this.visibilityHandler=Nt.Ye,this.position="selection",this.documentRef=G||p,!this.documentRef.createRange)return;this.range=this.documentRef.createRange();const{nativeElement:Ei}=this.elementRef;(0,cn.T)((0,qe.eh)(this.documentRef,"mouseup"),(0,qe.eh)(Ei,"mousedown").pipe((0,Ql.c)((0,qe.eh)(Ei,"mousemove").pipe((0,be.R)((0,qe.eh)(this.documentRef,"mouseup"))))),(0,qe.eh)(Ei,"keyup")).pipe((0,B.U)(()=>{const kn=(0,Je.dO)(this.documentRef),Pi=this.documentRef.getSelection();return(kn instanceof HTMLInputElement||kn instanceof HTMLTextAreaElement)&&Ei.contains(kn)?this.veryVerySadInputFix(kn):(null==Pi?void 0:Pi.rangeCount)?Pi.getRangeAt(0):this.range}),(0,be.R)(pe)).subscribe(kn=>{const Pi=!!kn&&Ei.contains(kn.commonAncestorContainer);this.range=Pi?kn:this.range;const ma=Pi&&(!this.visibilityHandler||!this.range||this.visibilityHandler(this.range));this.toggleDropdownBox(!!kn&&(ma||this.inDropdown(kn)))})}set tuiDropdownSelection(p){if(!p||!this.range)return;const o=this.elementRef.nativeElement.contains(this.range.commonAncestorContainer)&&p(this.range);this.visibilityHandler=p,this.toggleDropdownBox(o)}get clientRect(){const{defaultView:p}=this.documentRef,{rangeRect:o}=this,u=p?p.frameElement:null;if(!u)return o;const _=u.getBoundingClientRect();return{top:o.top+_.top,left:o.left+_.left,right:o.left+_.left+o.width,bottom:o.top+_.top+o.height,width:o.width,height:o.height}}ngOnDestroy(){this.closeDropdownBox(),this.ghost&&this.renderer.removeChild(this.viewContainerRef.element.nativeElement,this.ghost)}get rangeRect(){if(!this.range)return Nt.Jy;switch(this.position){case"tag":{const{commonAncestorContainer:p}=this.range;return(p.nodeType===Node.ELEMENT_NODE?p:p.parentNode).getBoundingClientRect()}case"word":return function Zl(r){const p=r.cloneRange(),{startContainer:o,startOffset:u,endContainer:_,endOffset:T}=p,{ownerDocument:j}=o;if(!j)return p;const G=j.createTreeWalker(j.body,NodeFilter.SHOW_TEXT,Nt.Lw,!1);G.currentNode=o;do{const Ce=G.currentNode,pe=Ce.textContent||"",Pe=Ce===o?pe.slice(0,Math.max(0,u+1)):pe,et=Math.max(Pe.lastIndexOf(" "),Pe.lastIndexOf(Nt.f$),Pe.lastIndexOf(Nt.tU))+1;if(p.setStart(Ce,0),et){p.setStart(Ce,et);break}}while(G.previousNode());G.currentNode=_;do{const Ce=G.currentNode,pe=Ce.textContent||"",Pe=Ce===_?pe.slice(T+1):pe,et=[Pe.indexOf(" "),Pe.indexOf(Nt.f$),Pe.indexOf(Nt.tU)].reduce((tt,Lt)=>-1===tt||-1===Lt?Math.max(tt,Lt):Math.min(tt,Lt),-1);if(p.setEnd(Ce,pe.length),-1!==et){p.setEnd(Ce,et+pe.length-Pe.length);break}}while(G.nextNode());return p}(this.range).getBoundingClientRect();default:return this.range.getBoundingClientRect()}}toggleDropdownBox(p){this.ngZone.run(()=>{p?this.openDropdownBox():this.closeDropdownBox(),this.changeDetectorRef.markForCheck()})}boxContains(p){return!!this.dropdownBoxRef&&this.dropdownBoxRef.location.nativeElement.contains(p)}inDropdown(p){const{startContainer:o,endContainer:u}=p,_=this.boxContains(p.commonAncestorContainer),T=this.boxContains(u)&&this.elementRef.nativeElement.contains(o),j=this.boxContains(o)&&this.elementRef.nativeElement.contains(u);return _||T||j}veryVerySadInputFix(p){const{ghost:o=this.initGhost(p)}=this,{top:u,left:_,width:T,height:j}=p.getBoundingClientRect(),{selectionStart:G,selectionEnd:Ce}=p,pe=this.documentRef.createRange(),Pe=this.elementRef.nativeElement.getBoundingClientRect();return o.style.top=(0,Q.px)(u-Pe.top),o.style.left=(0,Q.px)(_-Pe.left),o.style.width=(0,Q.px)(T),o.style.height=(0,Q.px)(j),o.textContent=Nt.tU+p.value+Nt.f$,pe.setStart(o.firstChild,G||0),pe.setEnd(o.firstChild,Ce||0),pe}initGhost(p){const o=this.renderer.createElement("div"),{nativeElement:u}=this.viewContainerRef.element,{font:_,letterSpacing:T,textTransform:j,padding:G}=getComputedStyle(p);return o.style.position="absolute",o.style.pointerEvents="none",o.style.opacity="0",o.style.whiteSpace="pre-wrap",o.style.font=_,o.style.letterSpacing=T,o.style.textTransform=j,o.style.padding=G,this.renderer.appendChild(u,o),this.ghost=o,o}};Sn.\u0275fac=function(p){return new(p||Sn)(e.\u0275\u0275directiveInject(w.K0),e.\u0275\u0275directiveInject(e.ComponentFactoryResolver),e.\u0275\u0275directiveInject(e.Injector),e.\u0275\u0275directiveInject(Ji.B),e.\u0275\u0275directiveInject(e.ElementRef,1),e.\u0275\u0275directiveInject(gt.e,8),e.\u0275\u0275directiveInject(Re.Qe,8),e.\u0275\u0275directiveInject(Re.zP,8),e.\u0275\u0275directiveInject(Ze.a3),e.\u0275\u0275directiveInject(Ze.b0),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject(e.NgZone),e.\u0275\u0275directiveInject(e.Renderer2),e.\u0275\u0275directiveInject(e.ViewContainerRef))},Sn.\u0275dir=e.\u0275\u0275defineDirective({type:Sn,selectors:[["","tuiDropdownSelection","",5,"ng-container"]],inputs:{position:["tuiDropdownSelectionPosition","position"],tuiDropdownSelection:"tuiDropdownSelection"},features:[e.\u0275\u0275ProvidersFeature([{provide:Re.Jd,useExisting:(0,e.forwardRef)(()=>No)},Ze.b0,Ze.a3]),e.\u0275\u0275InheritDefinitionFeature]}),Sn.ctorParameters=()=>[{type:Document,decorators:[{type:e.Inject,args:[w.K0]}]},{type:e.ComponentFactoryResolver,decorators:[{type:e.Inject,args:[e.ComponentFactoryResolver]}]},{type:e.Injector,decorators:[{type:e.Inject,args:[e.Injector]}]},{type:Ji.B,decorators:[{type:e.Inject,args:[Ji.B]}]},{type:e.ElementRef,decorators:[{type:e.Host},{type:e.Inject,args:[e.ElementRef]}]},{type:gt.e,decorators:[{type:e.Inject,args:[gt.e]},{type:e.Optional}]},{type:Document,decorators:[{type:e.Inject,args:[Re.Qe]},{type:e.Optional}]},{type:e.ElementRef,decorators:[{type:e.Inject,args:[Re.zP]},{type:e.Optional}]},{type:Ze.a3,decorators:[{type:e.Inject,args:[Ze.a3]}]},{type:Ze.b0,decorators:[{type:e.Inject,args:[Ze.b0]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:e.NgZone,decorators:[{type:e.Inject,args:[e.NgZone]}]},{type:e.Renderer2,decorators:[{type:e.Inject,args:[e.Renderer2]}]},{type:e.ViewContainerRef,decorators:[{type:e.Inject,args:[e.ViewContainerRef]}]}],(0,U.gn)([(0,e.Input)()],Sn.prototype,"tuiDropdownSelection",null),(0,U.gn)([(0,e.Input)("tuiDropdownSelectionPosition")],Sn.prototype,"position",void 0),Sn=No=(0,U.gn)([(0,U.fM)(0,(0,e.Inject)(w.K0)),(0,U.fM)(1,(0,e.Inject)(e.ComponentFactoryResolver)),(0,U.fM)(2,(0,e.Inject)(e.Injector)),(0,U.fM)(3,(0,e.Inject)(Ji.B)),(0,U.fM)(4,(0,e.Host)()),(0,U.fM)(4,(0,e.Inject)(e.ElementRef)),(0,U.fM)(5,(0,e.Inject)(gt.e)),(0,U.fM)(5,(0,e.Optional)()),(0,U.fM)(6,(0,e.Inject)(Re.Qe)),(0,U.fM)(6,(0,e.Optional)()),(0,U.fM)(7,(0,e.Inject)(Re.zP)),(0,U.fM)(7,(0,e.Optional)()),(0,U.fM)(8,(0,e.Inject)(Ze.a3)),(0,U.fM)(9,(0,e.Inject)(Ze.b0)),(0,U.fM)(10,(0,e.Inject)(e.ChangeDetectorRef)),(0,U.fM)(11,(0,e.Inject)(e.NgZone)),(0,U.fM)(12,(0,e.Inject)(e.Renderer2)),(0,U.fM)(13,(0,e.Inject)(e.ViewContainerRef))],Sn);let Xl=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[Gl.i]]}),r})();function ea(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"tui-toolbar",10),e.\u0275\u0275projection(1,1),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275property("tools",o.tools)("disabled",!o.interactive)}}function ta(r,p){if(1&r&&(e.\u0275\u0275elementStart(0,"div",11),e.\u0275\u0275text(1),e.\u0275\u0275elementEnd()),2&r){const o=e.\u0275\u0275nextContext(2);e.\u0275\u0275advance(1),e.\u0275\u0275textInterpolate1(" ",o.exampleText," ")}}function na(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",12)(1,"div",13),e.\u0275\u0275listener("valueChange",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).onModelChange(_)})("stateChange",function(){return 0})("click",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).selectLinkIfClosest()}),e.\u0275\u0275elementEnd()()}if(2&r){e.\u0275\u0275nextContext();const o=e.\u0275\u0275reference(9),u=e.\u0275\u0275nextContext();e.\u0275\u0275property("tuiDropdownSelection",u.dropdownSelectionHandler)("tuiDropdownContent",o),e.\u0275\u0275advance(1),e.\u0275\u0275property("value",u.value)("editable",u.interactive)}}function ia(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"tui-edit-link",14),e.\u0275\u0275listener("addLink",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).addLink(_)})("removeLink",function(){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext(2).removeLink()}),e.\u0275\u0275elementEnd()}}function oa(r,p){if(1&r){const o=e.\u0275\u0275getCurrentView();e.\u0275\u0275elementStart(0,"div",2),e.\u0275\u0275listener("tuiHoveredChange",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onHovered(_)})("tuiActiveZoneChange",function(_){return e.\u0275\u0275restoreView(o),e.\u0275\u0275nextContext().onActiveZone(_)}),e.\u0275\u0275elementStart(1,"div",3),e.\u0275\u0275template(2,ea,2,2,"tui-toolbar",4),e.\u0275\u0275elementStart(3,"div",5),e.\u0275\u0275projection(4),e.\u0275\u0275elementEnd(),e.\u0275\u0275template(5,ta,2,1,"div",6),e.\u0275\u0275elementEnd(),e.\u0275\u0275elementStart(6,"tui-scrollbar",7),e.\u0275\u0275template(7,na,2,4,"div",8),e.\u0275\u0275template(8,ia,1,0,"ng-template",null,9,e.\u0275\u0275templateRefExtractor),e.\u0275\u0275element(10,"tui-editor-portal-host"),e.\u0275\u0275elementEnd()()}if(2&r){const o=p.tuiLet,u=e.\u0275\u0275nextContext();e.\u0275\u0275classProp("t-wrapper_disabled",u.disabled),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o),e.\u0275\u0275advance(1),e.\u0275\u0275classProp("t-placeholder_raised",u.placeholderRaised),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",u.hasExampleText),e.\u0275\u0275advance(2),e.\u0275\u0275property("ngIf",o)}}const ra=["*",[["tools"]]];let Zo=(()=>{let r=class extends mt.N9{};return r.\u0275fac=function(){let p;return function(u){return(p||(p=e.\u0275\u0275getInheritedFactory(r)))(u||r)}}(),r.\u0275prov=e.\u0275\u0275defineInjectable({token:r,factory:function(p){return r.\u0275fac(p)}}),r})();const la=[{provide:yn,deps:[Et],useFactory:function aa(r){const p=new Nn.t(1);return Promise.all(r).then(o=>p.next(o)),p}},{provide:Zt,deps:[e.Renderer2],useFactory:function ca(r){return r.createElement("div")}},{provide:$t,deps:[Zt,yn,ai],useFactory:function ua(r,p,o){return(0,Rt.a)([o,p]).pipe((0,vn.q)(1),(0,B.U)(([u,_])=>new u({element:r,extensions:_})),(0,Yl.d)({bufferSize:1,refCount:!0}))}},Ae,Zo];var Ro;let fn=Ro=class extends mt.M${constructor(p,o,u,_){super(p,o),this.editorLoaded$=u,this.editorService=_,this.exampleText="",this.tools=sn,this.isSelectionLink=()=>{var T;return!!(null===(T=this.editor)||void 0===T?void 0:T.isActive("link"))}}get dropdownSelectionHandler(){return this.focused?this.isSelectionLink:Nt.Iy}get editor(){return this.editorService.getOriginTiptapEditor()?this.editorService:null}get focused(){var p;return!!(null===(p=this.editor)||void 0===p?void 0:p.isFocused)||!!this.toolbar&&this.toolbar.focused||!!this.editLink&&(0,Je.KF)(this.editLink.nativeElement)}get placeholderRaised(){return this.computedFocused&&!this.readOnly||this.hasValue}get hasExampleText(){return!!this.exampleText&&this.computedFocused&&!this.hasValue&&!this.readOnly}onHovered(p){this.updateHovered(p)}selectLinkIfClosest(){var p;this.getMarkedLinkBeforeSelectClosest()&&(null===(p=this.editor)||void 0===p||p.selectClosest())}onActiveZone(p){this.updateFocused(p)}onModelChange(p){this.updateValue(p)}addLink(p){var o,u;null===(o=this.editor)||void 0===o||o.selectClosest(),null===(u=this.editor)||void 0===u||u.setLink(p)}removeLink(){var p;null===(p=this.editor)||void 0===p||p.unsetLink()}ngOnDestroy(){var p;null===(p=this.editor)||void 0===p||p.destroy()}getFallbackValue(){return""}get hasValue(){return!!this.value}getMarkedLinkBeforeSelectClosest(){var p;const[o]=(null===(p=this.editor)||void 0===p?void 0:p.state.tr.selection.$anchor.marks())||[];return"link"===(null==o?void 0:o.type.name)?o:null}};fn.\u0275fac=function(p){return new(p||fn)(e.\u0275\u0275directiveInject(ie.NgControl,10),e.\u0275\u0275directiveInject(e.ChangeDetectorRef),e.\u0275\u0275directiveInject($t),e.\u0275\u0275directiveInject(Ae))},fn.\u0275cmp=e.\u0275\u0275defineComponent({type:fn,selectors:[["tui-editor","new",""]],viewQuery:function(p,o){if(1&p&&(e.\u0275\u0275viewQuery(yo,5,e.ElementRef),e.\u0275\u0275viewQuery(Po,5)),2&p){let u;e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.editLink=u.first),e.\u0275\u0275queryRefresh(u=e.\u0275\u0275loadQuery())&&(o.toolbar=u.first)}},inputs:{exampleText:"exampleText",tools:"tools"},features:[e.\u0275\u0275ProvidersFeature([{provide:Ft.KZ,useExisting:(0,e.forwardRef)(()=>Ro)},la]),e.\u0275\u0275InheritDefinitionFeature],attrs:["new",""],ngContentSelectors:["*","tools"],decls:3,vars:8,consts:[["appearance","textfield",1,"t-outline",3,"readOnly","disabled","focused","hovered","invalid"],["class","t-wrapper",3,"t-wrapper_disabled","tuiHoveredChange","tuiActiveZoneChange",4,"tuiLet"],[1,"t-wrapper",3,"tuiHoveredChange","tuiActiveZoneChange"],[1,"t-toolbar-wrapper"],["new","",3,"tools","disabled",4,"ngIf"],[1,"t-placeholder"],["class","t-example-text",4,"ngIf"],["tuiEditorPortal","",1,"t-scrollbar"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdownContent",4,"ngIf"],["dropdown",""],["new","",3,"tools","disabled"],[1,"t-example-text"],["tuiDropdownLimitWidth","auto","tuiDropdownSelectionPosition","tag",3,"tuiDropdownSelection","tuiDropdownContent"],["tuiTiptapEditor","","spellcheck","false",1,"tui-editor-socket",3,"value","editable","valueChange","stateChange","click"],[3,"addLink","removeLink"]],template:function(p,o){1&p&&(e.\u0275\u0275projectionDef(ra),e.\u0275\u0275elementStart(0,"tui-wrapper",0),e.\u0275\u0275template(1,oa,11,7,"div",1),e.\u0275\u0275pipe(2,"async"),e.\u0275\u0275elementEnd()),2&p&&(e.\u0275\u0275property("readOnly",o.readOnly)("disabled",o.disabled)("focused",o.computedFocused)("hovered",o.computedHovered)("invalid",o.computedInvalid),e.\u0275\u0275advance(1),e.\u0275\u0275property("tuiLet",e.\u0275\u0275pipeBind1(2,6,o.editorLoaded$)))},directives:function(){return[Yo.o,Qe.Ls,Ko.co,gt.e,w.O5,Po,Go.IB,da,Sn,br,yo,pa]},pipes:function(){return[w.Ov]},styles:["[_nghost-%COMP%]{position:relative;z-index:0;display:block;font:var(--tui-font-text-m)}[_nghost-%COMP%]     .tui-editor-socket{display:block;border:none}[_nghost-%COMP%]     .tui-editor-socket .ProseMirror{min-height:5.375rem;padding:0 1rem;outline:0;white-space:pre-wrap}.t-outline[_ngcontent-%COMP%]{max-height:inherit;min-height:inherit;border-radius:var(--tui-radius-m)}.t-wrapper[_ngcontent-%COMP%]{display:flex;max-height:inherit;min-height:10rem;cursor:text;overflow:hidden;flex-direction:column}.t-wrapper_disabled[_ngcontent-%COMP%]{cursor:initial}.t-placeholder[_ngcontent-%COMP%]{transition-property:transform,font-size,color,letter-spacing;transition-duration:var(--tui-duration,300ms);transition-timing-function:ease-in-out;font:var(--tui-font-text-s);color:var(--tui-text-01);white-space:nowrap;overflow:hidden;text-overflow:ellipsis;display:block;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;color:var(--tui-text-02);pointer-events:none;will-change:transform;transform:translateY(0);position:absolute;left:1rem;margin-top:1rem;width:95%;font-size:.9375rem}.t-placeholder_raised[_ngcontent-%COMP%]{transform:translateY(-.625rem);width:110%}[data-size='m'][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font:var(--tui-font-text-xs);transform:translateY(-.5rem);letter-spacing:.025rem}._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], ._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill)}[data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused)   .t-placeholder_raised[_ngcontent-%COMP%], [data-mode=onDark]._invalid[_nghost-%COMP%]:not(._focused):hover   .t-placeholder_raised[_ngcontent-%COMP%]{color:var(--tui-error-fill-night)}._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size='l']._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size='m']._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-size='l'][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{font-size:.9375rem}[data-size='l'][_nghost-%COMP%]   .t-placeholder_raised[_ngcontent-%COMP%]{font-size:.8156rem}[data-size='l']._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size='m']._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01)}[data-mode=onDark][_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}[data-size='l'][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%], [data-size='m'][data-mode=onDark]._focused[_nghost-%COMP%]:not(._label-outside)   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}[data-mode=onDark]._focused[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size='l'][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%], [data-size='m'][data-mode=onDark]._focused._label-outside[_nghost-%COMP%]   .t-placeholder[_ngcontent-%COMP%]{color:var(--tui-text-02-night)}@supports (-webkit-hyphens:none){.t-placeholder[_ngcontent-%COMP%]{will-change:unset;transition-property:transform,color,letter-spacing}}.t-example-text[_ngcontent-%COMP%]{position:absolute;left:1rem;margin-top:1.6rem;color:var(--tui-base-06);letter-spacing:normal;text-transform:none}.t-example-text_light[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}.t-example-text_dark[_ngcontent-%COMP%]{color:var(--tui-text-03)}.t-scrollbar[_ngcontent-%COMP%]{display:flex;max-height:inherit;border-top:1.625rem solid transparent;border-bottom:1px solid transparent;box-sizing:border-box}"],changeDetection:0}),fn.ctorParameters=()=>[{type:ie.NgControl,decorators:[{type:e.Optional},{type:e.Self},{type:e.Inject,args:[ie.NgControl]}]},{type:e.ChangeDetectorRef,decorators:[{type:e.Inject,args:[e.ChangeDetectorRef]}]},{type:pt.y,decorators:[{type:e.Inject,args:[$t]}]},{type:Ue,decorators:[{type:e.Inject,args:[Ae]}]}],ne([(0,e.ViewChild)(yo,{read:e.ElementRef})],fn.prototype,"editLink",void 0),ne([(0,e.Input)(),(0,ce.TH)()],fn.prototype,"exampleText",void 0),ne([(0,e.Input)(),(0,ce.TH)()],fn.prototype,"tools",void 0),ne([(0,e.ViewChild)(Po)],fn.prototype,"toolbar",void 0),fn=Ro=ne([se(0,(0,e.Optional)()),se(0,(0,e.Self)()),se(0,(0,e.Inject)(ie.NgControl)),se(1,(0,e.Inject)(e.ChangeDetectorRef)),se(2,(0,e.Inject)($t)),se(3,(0,e.Inject)(Ae))],fn);let da=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275dir=e.\u0275\u0275defineDirective({type:r,selectors:[["","tuiEditorPortal",""]],features:[e.\u0275\u0275ProvidersFeature([{provide:Ji.B,useExisting:Zo}])]}),r})(),pa=(()=>{let r=class extends mt.Er{};return r.\u0275fac=function(){let p;return function(u){return(p||(p=e.\u0275\u0275getInheritedFactory(r)))(u||r)}}(),r.\u0275cmp=e.\u0275\u0275defineComponent({type:r,selectors:[["tui-editor-portal-host"]],features:[e.\u0275\u0275ProvidersFeature([{provide:mt.N9,useExisting:Ji.B}]),e.\u0275\u0275InheritDefinitionFeature],decls:2,vars:0,consts:[["viewContainer",""]],template:function(o,u){1&o&&e.\u0275\u0275elementContainer(0,null,0)},styles:["[_nghost-%COMP%]{position:relative;z-index:1;display:block;height:100%}"],changeDetection:0}),r})(),fa=(()=>{let r=class{};return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,Kl,Yo.W,Ko.VE,Go.Jy,Bo,gt.A,Xl,vr,Qe.WD]]}),r})(),ha=(()=>{class r{}return r.\u0275fac=function(o){return new(o||r)},r.\u0275mod=e.\u0275\u0275defineNgModule({type:r}),r.\u0275inj=e.\u0275\u0275defineInjector({imports:[[w.ez,Qi,Xi.m,re.j,N,O.a,ze.Qf,ie.ReactiveFormsModule,Me.cn,L.Q7,te.fN,hi.C,Ut._H,Xt.Jy,fa,Qe.WD,mi.dS,lo,Mt.iw,ie.FormsModule,qt.zX]]}),r})()},9220:(bt,Fe,A)=>{A.r(Fe),A.d(Fe,{CommandManager:()=>ut,Editor:()=>ki,Extension:()=>Et,InputRule:()=>M,Mark:()=>Qe,Node:()=>dn,NodeView:()=>ao,PasteRule:()=>ge,Tracker:()=>ne,callOrReturn:()=>V,combineTransactionSteps:()=>qn,defaultBlockAt:()=>Jt,escapeForRegEx:()=>se,extensions:()=>at,findChildren:()=>to,findChildrenInRange:()=>mo,findParentNode:()=>Fn,findParentNodeClosestToPos:()=>Hi,generateHTML:()=>wi,generateJSON:()=>$i,generateText:()=>no,getAttributes:()=>Vi,getChangedRanges:()=>ro,getDebugJSON:()=>Ii,getExtensionField:()=>N,getHTMLFromFragment:()=>Qn,getMarkAttributes:()=>Pt,getMarkRange:()=>Be,getMarkType:()=>dt,getMarksBetween:()=>Oi,getNodeAttributes:()=>Wt,getNodeType:()=>S,getSchema:()=>ei,getText:()=>Xn,getTextBetween:()=>yn,getTextContentFromNodes:()=>g,getTextSerializersFromSchema:()=>Cn,inputRulesPlugin:()=>J,isActive:()=>Ln,isList:()=>bi,isMarkActive:()=>an,isNodeActive:()=>qt,isNodeEmpty:()=>Si,isNodeSelection:()=>so,isTextSelection:()=>Kn,markInputRule:()=>ti,markPasteRule:()=>Ui,mergeAttributes:()=>E,nodeInputRule:()=>st,pasteRulesPlugin:()=>sn,posToDOMRect:()=>Hn,textInputRule:()=>_o,textPasteRule:()=>co,textblockTypeInputRule:()=>go,wrappingInputRule:()=>lo});var w=A(6956),ye=A(412),Ve=A(3232),X=A(8197),q=A(3060);const Ee=(i,t)=>!i.selection.empty&&(t&&t(i.tr.deleteSelection().scrollIntoView()),!0),Oe=(i,t,n)=>{let{$cursor:s}=i.selection;if(!s||(n?!n.endOfTextblock("backward",i):s.parentOffset>0))return!1;let l=Te(s);if(!l){let d=s.blockRange(),h=d&&(0,q.k9)(d);return null!=h&&(t&&t(i.tr.lift(d,h).scrollIntoView()),!0)}let a=l.nodeBefore;if(!a.type.spec.isolating&&ze(i,l,t))return!0;if(0==s.parent.content.size&&(be(a,"end")||w.qv.isSelectable(a))){let d=(0,q.dR)(i.doc,s.before(),s.after(),X.p2.empty);if(d&&d.slice.size<d.to-d.from){if(t){let h=i.tr.step(d);h.setSelection(be(a,"end")?w.Y1.findFrom(h.doc.resolve(h.mapping.map(l.pos,-1)),-1):w.qv.create(h.doc,l.pos-a.nodeSize)),t(h.scrollIntoView())}return!0}}return!(!a.isAtom||l.depth!=s.depth-1||(t&&t(i.tr.delete(l.pos-a.nodeSize,l.pos).scrollIntoView()),0))};function be(i,t,n=!1){for(let s=i;s;s="start"==t?s.firstChild:s.lastChild){if(s.isTextblock)return!0;if(n&&1!=s.childCount)return!1}return!1}const ae=(i,t,n)=>{let{$head:s,empty:l}=i.selection,a=s;if(!l)return!1;if(s.parent.isTextblock){if(n?!n.endOfTextblock("backward",i):s.parentOffset>0)return!1;a=Te(s)}let d=a&&a.nodeBefore;return!(!d||!w.qv.isSelectable(d)||(t&&t(i.tr.setSelection(w.qv.create(i.doc,a.pos-d.nodeSize)).scrollIntoView()),0))};function Te(i){if(!i.parent.type.spec.isolating)for(let t=i.depth-1;t>=0;t--){if(i.index(t)>0)return i.doc.resolve(i.before(t+1));if(i.node(t).type.spec.isolating)break}return null}const ke=(i,t,n)=>{let{$cursor:s}=i.selection;if(!s||(n?!n.endOfTextblock("forward",i):s.parentOffset<s.parent.content.size))return!1;let l=ie(s);if(!l)return!1;let a=l.nodeAfter;if(ze(i,l,t))return!0;if(0==s.parent.content.size&&(be(a,"start")||w.qv.isSelectable(a))){let d=(0,q.dR)(i.doc,s.before(),s.after(),X.p2.empty);if(d&&d.slice.size<d.to-d.from){if(t){let h=i.tr.step(d);h.setSelection(be(a,"start")?w.Y1.findFrom(h.doc.resolve(h.mapping.map(l.pos)),1):w.qv.create(h.doc,h.mapping.map(l.pos))),t(h.scrollIntoView())}return!0}}return!(!a.isAtom||l.depth!=s.depth-1||(t&&t(i.tr.delete(l.pos,l.pos+a.nodeSize).scrollIntoView()),0))},ve=(i,t,n)=>{let{$head:s,empty:l}=i.selection,a=s;if(!l)return!1;if(s.parent.isTextblock){if(n?!n.endOfTextblock("forward",i):s.parentOffset<s.parent.content.size)return!1;a=ie(s)}let d=a&&a.nodeAfter;return!(!d||!w.qv.isSelectable(d)||(t&&t(i.tr.setSelection(w.qv.create(i.doc,a.pos)).scrollIntoView()),0))};function ie(i){if(!i.parent.type.spec.isolating)for(let t=i.depth-1;t>=0;t--){let n=i.node(t);if(i.index(t)+1<n.childCount)return i.doc.resolve(i.after(t+1));if(n.type.spec.isolating)break}return null}const Ke=(i,t)=>{let{$head:n,$anchor:s}=i.selection;return!(!n.parent.type.spec.code||!n.sameParent(s)||(t&&t(i.tr.insertText("\n").scrollIntoView()),0))};function Ie(i){for(let t=0;t<i.edgeCount;t++){let{type:n}=i.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}const fe=(i,t)=>{let{$head:n,$anchor:s}=i.selection;if(!n.parent.type.spec.code||!n.sameParent(s))return!1;let l=n.node(-1),a=n.indexAfter(-1),d=Ie(l.contentMatchAt(a));if(!d||!l.canReplaceWith(a,a,d))return!1;if(t){let h=n.after(),m=i.tr.replaceWith(h,h,d.createAndFill());m.setSelection(w.Y1.near(m.doc.resolve(h),1)),t(m.scrollIntoView())}return!0},_e=(i,t)=>{let n=i.selection,{$from:s,$to:l}=n;if(n instanceof w.C1||s.parent.inlineContent||l.parent.inlineContent)return!1;let a=Ie(l.parent.contentMatchAt(l.indexAfter()));if(!a||!a.isTextblock)return!1;if(t){let d=(!s.parentOffset&&l.index()<l.parent.childCount?s:l).pos,h=i.tr.insert(d,a.createAndFill());h.setSelection(w.Bs.create(h.doc,d+1)),t(h.scrollIntoView())}return!0},le=(i,t)=>{let{$cursor:n}=i.selection;if(!n||n.parent.content.size)return!1;if(n.depth>1&&n.after()!=n.end(-1)){let a=n.before();if((0,q.Ax)(i.doc,a))return t&&t(i.tr.split(a).scrollIntoView()),!0}let s=n.blockRange(),l=s&&(0,q.k9)(s);return null!=l&&(t&&t(i.tr.lift(s,l).scrollIntoView()),!0)};function ze(i,t,n){let a,d,s=t.nodeBefore,l=t.nodeAfter;if(s.type.spec.isolating||l.type.spec.isolating)return!1;if(function Ge(i,t,n){let s=t.nodeBefore,l=t.nodeAfter,a=t.index();return!(!(s&&l&&s.type.compatibleContent(l.type))||(!s.content.size&&t.parent.canReplace(a-1,a)?(n&&n(i.tr.delete(t.pos-s.nodeSize,t.pos).scrollIntoView()),0):!t.parent.canReplace(a,a+1)||!l.isTextblock&&!(0,q.Mn)(i.doc,t.pos)||(n&&n(i.tr.clearIncompatible(t.pos,s.type,s.contentMatchAt(s.childCount)).join(t.pos).scrollIntoView()),0)))}(i,t,n))return!0;let h=t.parent.canReplace(t.index(),t.index()+1);if(h&&(a=(d=s.contentMatchAt(s.childCount)).findWrapping(l.type))&&d.matchType(a[0]||l.type).validEnd){if(n){let I=t.pos+l.nodeSize,D=X.HY.empty;for(let W=a.length-1;W>=0;W--)D=X.HY.from(a[W].create(null,D));D=X.HY.from(s.copy(D));let R=i.tr.step(new q.FC(t.pos-1,I,t.pos,I,new X.p2(D,1,0),a.length,!0)),H=I+2*a.length;(0,q.Mn)(R.doc,H)&&R.join(H),n(R.scrollIntoView())}return!0}let m=w.Y1.findFrom(t,1),b=m&&m.$from.blockRange(m.$to),C=b&&(0,q.k9)(b);if(null!=C&&C>=t.depth)return n&&n(i.tr.lift(b,C).scrollIntoView()),!0;if(h&&be(l,"start",!0)&&be(s,"end")){let I=s,D=[];for(;D.push(I),!I.isTextblock;)I=I.lastChild;let R=l,H=1;for(;!R.isTextblock;R=R.firstChild)H++;if(I.canReplace(I.childCount,I.childCount,R.content)){if(n){let W=X.HY.empty;for(let ue=D.length-1;ue>=0;ue--)W=X.HY.from(D[ue].copy(W));n(i.tr.step(new q.FC(t.pos-D.length,t.pos+l.nodeSize,t.pos+H,t.pos+l.nodeSize-H,new X.p2(W,D.length,0),0,!0)).scrollIntoView())}return!0}}return!1}function Mt(i){return function(t,n){let s=t.selection,l=i<0?s.$from:s.$to,a=l.depth;for(;l.node(a).isInline;){if(!a)return!1;a--}return!!l.node(a).isTextblock&&(n&&n(t.tr.setSelection(w.Bs.create(t.doc,i<0?l.start(a):l.end(a)))),!0)}}const Me=Mt(-1),re=Mt(1);function L(i,t=null){return function(n,s){let{from:l,to:a}=n.selection,d=!1;return n.doc.nodesBetween(l,a,(h,m)=>{if(d)return!1;if(h.isTextblock&&!h.hasMarkup(i,t))if(h.type==i)d=!0;else{let b=n.doc.resolve(m),C=b.index();d=b.parent.canReplaceWith(C,C+1,i)}}),!!d&&(s&&s(n.tr.setBlockType(l,a,i,t).scrollIntoView()),!0)}}function De(...i){return function(t,n,s){for(let l=0;l<i.length;l++)if(i[l](t,n,s))return!0;return!1}}let We=De(Ee,Oe,ae),rt=De(Ee,ke,ve);const Le={Enter:De(Ke,_e,le,(i,t)=>{let{$from:n,$to:s}=i.selection;if(i.selection instanceof w.qv&&i.selection.node.isBlock)return!(!n.parentOffset||!(0,q.Ax)(i.doc,n.pos)||(t&&t(i.tr.split(n.pos).scrollIntoView()),0));if(!n.parent.isBlock)return!1;if(t){let l=s.parentOffset==s.parent.content.size,a=i.tr;(i.selection instanceof w.Bs||i.selection instanceof w.C1)&&a.deleteSelection();let d=0==n.depth?null:Ie(n.node(-1).contentMatchAt(n.indexAfter(-1))),h=l&&d?[{type:d}]:void 0,m=(0,q.Ax)(a.doc,a.mapping.map(n.pos),1,h);if(!h&&!m&&(0,q.Ax)(a.doc,a.mapping.map(n.pos),1,d?[{type:d}]:void 0)&&(d&&(h=[{type:d}]),m=!0),m&&(a.split(a.mapping.map(n.pos),1,h),!l&&!n.parentOffset&&n.parent.type!=d)){let b=a.mapping.map(n.before()),C=a.doc.resolve(b);d&&n.node(-1).canReplaceWith(C.index(),C.index()+1,d)&&a.setNodeMarkup(a.mapping.map(n.before()),d)}t(a.scrollIntoView())}return!0}),"Mod-Enter":fe,Backspace:We,"Mod-Backspace":We,"Shift-Backspace":We,Delete:rt,"Mod-Delete":rt,"Mod-a":(i,t)=>(t&&t(i.tr.setSelection(new w.C1(i.doc))),!0)},Yt={"Ctrl-h":Le.Backspace,"Alt-Backspace":Le["Mod-Backspace"],"Ctrl-d":Le.Delete,"Ctrl-Alt-Backspace":Le["Mod-Delete"],"Alt-Delete":Le["Mod-Delete"],"Alt-d":Le["Mod-Delete"],"Ctrl-a":Me,"Ctrl-e":re};for(let i in Le)Yt[i]=Le[i];function Ot(i){const{state:t,transaction:n}=i;let{selection:s}=n,{doc:l}=n,{storedMarks:a}=n;return Ht(he({},t),{apply:t.apply.bind(t),applyTransaction:t.applyTransaction.bind(t),filterTransaction:t.filterTransaction,plugins:t.plugins,schema:t.schema,reconfigure:t.reconfigure.bind(t),toJSON:t.toJSON.bind(t),get storedMarks(){return a},get selection(){return s},get doc(){return l},get tr(){return s=n.selection,l=n.doc,a=n.storedMarks,n}})}"undefined"!=typeof navigator?/Mac|iP(hone|[oa]d)/.test(navigator.platform):"undefined"!=typeof os&&os.platform&&os.platform();class ut{constructor(t){this.editor=t.editor,this.rawCommands=this.editor.extensionManager.commands,this.customState=t.state}get hasCustomState(){return!!this.customState}get state(){return this.customState||this.editor.state}get commands(){const{rawCommands:t,editor:n,state:s}=this,{view:l}=n,{tr:a}=s,d=this.buildProps(a);return Object.fromEntries(Object.entries(t).map(([h,m])=>[h,(...C)=>{const I=m(...C)(d);return!a.getMeta("preventDispatch")&&!this.hasCustomState&&l.dispatch(a),I}]))}get chain(){return()=>this.createChain()}get can(){return()=>this.createCan()}createChain(t,n=!0){const{rawCommands:s,editor:l,state:a}=this,{view:d}=l,h=[],m=!!t,b=t||a.tr,I=Ht(he({},Object.fromEntries(Object.entries(s).map(([D,R])=>[D,(...W)=>{const Y=this.buildProps(b,n),ue=R(...W)(Y);return h.push(ue),I}]))),{run:()=>(!m&&n&&!b.getMeta("preventDispatch")&&!this.hasCustomState&&d.dispatch(b),h.every(D=>!0===D))});return I}createCan(t){const{rawCommands:n,state:s}=this,l=void 0,a=t||s.tr,d=this.buildProps(a,l),h=Object.fromEntries(Object.entries(n).map(([m,b])=>[m,(...C)=>b(...C)(Ht(he({},d),{dispatch:l}))]));return Ht(he({},h),{chain:()=>this.createChain(a,l)})}buildProps(t,n=!0){const{rawCommands:s,editor:l,state:a}=this,{view:d}=l;a.storedMarks&&t.setStoredMarks(a.storedMarks);const h={tr:t,editor:l,view:d,state:Ot({state:a,transaction:t}),dispatch:n?()=>{}:void 0,chain:()=>this.createChain(t),can:()=>this.createCan(t),get commands(){return Object.fromEntries(Object.entries(s).map(([m,b])=>[m,(...C)=>b(...C)(h)]))}};return h}}function N(i,t,n){return void 0===i.config[t]&&i.parent?N(i.parent,t,n):"function"==typeof i.config[t]?i.config[t].bind(Ht(he({},n),{parent:i.parent?N(i.parent,t,n):null})):i.config[t]}function y(i){return{baseExtensions:i.filter(l=>"extension"===l.type),nodeExtensions:i.filter(l=>"node"===l.type),markExtensions:i.filter(l=>"mark"===l.type)}}function x(i){const t=[],{nodeExtensions:n,markExtensions:s}=y(i),l=[...n,...s],a={default:null,rendered:!0,renderHTML:null,parseHTML:null,keepOnSplit:!0,isRequired:!1};return i.forEach(d=>{const m=N(d,"addGlobalAttributes",{name:d.name,options:d.options,storage:d.storage});m&&m().forEach(C=>{C.types.forEach(I=>{Object.entries(C.attributes).forEach(([D,R])=>{t.push({type:I,name:D,attribute:he(he({},a),R)})})})})}),l.forEach(d=>{const m=N(d,"addAttributes",{name:d.name,options:d.options,storage:d.storage});if(!m)return;const b=m();Object.entries(b).forEach(([C,I])=>{const D=he(he({},a),I);I.isRequired&&void 0===I.default&&delete D.default,t.push({type:d.name,name:C,attribute:D})})}),t}function S(i,t){if("string"==typeof i){if(!t.nodes[i])throw Error(`There is no node type named '${i}'. Maybe you forgot to add the extension?`);return t.nodes[i]}return i}function E(...i){return i.filter(t=>!!t).reduce((t,n)=>{const s=he({},t);return Object.entries(n).forEach(([l,a])=>{s[l]=s[l]?"class"===l?[s[l],a].join(" "):"style"===l?[s[l],a].join("; "):a:a}),s},{})}function F(i,t){return t.filter(n=>n.attribute.rendered).map(n=>n.attribute.renderHTML?n.attribute.renderHTML(i.attrs)||{}:{[n.name]:i.attrs[n.name]}).reduce((n,s)=>E(n,s),{})}function z(i){return"function"==typeof i}function V(i,t,...n){return z(i)?t?i.bind(t)(...n):i(...n):i}function de(i,t){return i.style?i:Ht(he({},i),{getAttrs:n=>{const s=i.getAttrs?i.getAttrs(n):i.attrs;if(!1===s)return!1;const l=t.reduce((a,d)=>{const h=d.attribute.parseHTML?d.attribute.parseHTML(n):function ee(i){return"string"!=typeof i?i:i.match(/^[+-]?(?:\d*\.)?\d+$/)?Number(i):"true"===i||"false"!==i&&i}(n.getAttribute(d.name));return null==h?a:Ht(he({},a),{[d.name]:h})},{});return he(he({},s),l)}})}function me(i){return Object.fromEntries(Object.entries(i).filter(([t,n])=>("attrs"!==t||!function Z(i={}){return 0===Object.keys(i).length&&i.constructor===Object}(n))&&null!=n))}function k(i){var t;const n=x(i),{nodeExtensions:s,markExtensions:l}=y(i),a=null===(t=s.find(m=>N(m,"topNode")))||void 0===t?void 0:t.name,d=Object.fromEntries(s.map(m=>{const b=n.filter(Y=>Y.type===m.name),C={name:m.name,options:m.options,storage:m.storage},I=i.reduce((Y,ue)=>{const Ue=N(ue,"extendNodeSchema",C);return he(he({},Y),Ue?Ue(m):{})},{}),D=me(Ht(he({},I),{content:V(N(m,"content",C)),marks:V(N(m,"marks",C)),group:V(N(m,"group",C)),inline:V(N(m,"inline",C)),atom:V(N(m,"atom",C)),selectable:V(N(m,"selectable",C)),draggable:V(N(m,"draggable",C)),code:V(N(m,"code",C)),defining:V(N(m,"defining",C)),isolating:V(N(m,"isolating",C)),attrs:Object.fromEntries(b.map(Y=>{var ue;return[Y.name,{default:null===(ue=null==Y?void 0:Y.attribute)||void 0===ue?void 0:ue.default}]}))})),R=V(N(m,"parseHTML",C));R&&(D.parseDOM=R.map(Y=>de(Y,b)));const H=N(m,"renderHTML",C);H&&(D.toDOM=Y=>H({node:Y,HTMLAttributes:F(Y,b)}));const W=N(m,"renderText",C);return W&&(D.toText=W),[m.name,D]})),h=Object.fromEntries(l.map(m=>{const b=n.filter(W=>W.type===m.name),C={name:m.name,options:m.options,storage:m.storage},I=i.reduce((W,Y)=>{const ue=N(Y,"extendMarkSchema",C);return he(he({},W),ue?ue(m):{})},{}),D=me(Ht(he({},I),{inclusive:V(N(m,"inclusive",C)),excludes:V(N(m,"excludes",C)),group:V(N(m,"group",C)),spanning:V(N(m,"spanning",C)),code:V(N(m,"code",C)),attrs:Object.fromEntries(b.map(W=>{var Y;return[W.name,{default:null===(Y=null==W?void 0:W.attribute)||void 0===Y?void 0:Y.default}]}))})),R=V(N(m,"parseHTML",C));R&&(D.parseDOM=R.map(W=>de(W,b)));const H=N(m,"renderHTML",C);return H&&(D.toDOM=W=>H({mark:W,HTMLAttributes:F(W,b)})),[m.name,D]}));return new X.V_({topNode:a,nodes:d,marks:h})}function c(i,t){return t.nodes[i]||t.marks[i]||null}function f(i,t){return Array.isArray(t)?t.some(n=>("string"==typeof n?n:n.name)===i.name):t}const g=(i,t=500)=>{let n="";return i.parent.nodesBetween(Math.max(0,i.parentOffset-t),i.parentOffset,(s,l,a,d)=>{var h,m;n+=(null===(m=(h=s.type.spec).toText)||void 0===m?void 0:m.call(h,{node:s,pos:l,parent:a,index:d}))||s.textContent||"%leaf%"}),n};function v(i){return"[object RegExp]"===Object.prototype.toString.call(i)}class M{constructor(t){this.find=t.find,this.handler=t.handler}}function B(i){var t;const{editor:n,from:s,to:l,text:a,rules:d,plugin:h}=i,{view:m}=n;if(m.composing)return!1;const b=m.state.doc.resolve(s);if(b.parent.type.spec.code||(null===(t=b.nodeBefore||b.nodeAfter)||void 0===t?void 0:t.marks.find(D=>D.type.spec.code)))return!1;let C=!1;const I=g(b)+a;return d.forEach(D=>{if(C)return;const R=((i,t)=>{if(v(t))return t.exec(i);const n=t(i);if(!n)return null;const s=[];return s.push(n.text),s.index=n.index,s.input=i,s.data=n.data,n.replaceWith&&(n.text.includes(n.replaceWith)||console.warn('[tiptap warn]: "inputRuleMatch.replaceWith" must be part of "inputRuleMatch.text".'),s.push(n.replaceWith)),s})(I,D.find);if(!R)return;const H=m.state.tr,W=Ot({state:m.state,transaction:H}),Y={from:s-(R[0].length-a.length),to:l},{commands:ue,chain:Ue,can:yt}=new ut({editor:n,state:W});null===D.handler({state:W,range:Y,match:R,commands:ue,chain:Ue,can:yt})||!H.steps.length||(H.setMeta(h,{transform:H,from:s,to:l,text:a}),m.dispatch(H),C=!0)}),C}function J(i){const{editor:t,rules:n}=i,s=new w.Sy({state:{init:()=>null,apply:(l,a)=>l.getMeta(s)||(l.selectionSet||l.docChanged?null:a)},props:{handleTextInput:(l,a,d,h)=>B({editor:t,from:a,to:d,text:h,rules:n,plugin:s}),handleDOMEvents:{compositionend:l=>(setTimeout(()=>{const{$cursor:a}=l.state.selection;a&&B({editor:t,from:a.pos,to:a.pos,text:"",rules:n,plugin:s})}),!1)},handleKeyDown(l,a){if("Enter"!==a.key)return!1;const{$cursor:d}=l.state.selection;return!!d&&B({editor:t,from:d.pos,to:d.pos,text:"\n",rules:n,plugin:s})}},isInputRules:!0});return s}class ge{constructor(t){this.find=t.find,this.handler=t.handler}}function sn(i){const{editor:t,rules:n}=i;let s=null,l=!1,a=!1;return n.map(h=>new w.Sy({view(m){const b=C=>{var I;s=(null===(I=m.dom.parentElement)||void 0===I?void 0:I.contains(C.target))?m.dom.parentElement:null};return window.addEventListener("dragstart",b),{destroy(){window.removeEventListener("dragstart",b)}}},props:{handleDOMEvents:{drop:m=>(a=s===m.dom.parentElement,!1),paste:(m,b)=>{var C;const I=null===(C=b.clipboardData)||void 0===C?void 0:C.getData("text/html");return l=!!(null==I?void 0:I.includes("data-pm-slice")),!1}}},appendTransaction:(m,b,C)=>{const I=m[0],D="paste"===I.getMeta("uiEvent")&&!l,R="drop"===I.getMeta("uiEvent")&&!a;if(!D&&!R)return;const H=b.doc.content.findDiffStart(C.doc.content),W=b.doc.content.findDiffEnd(C.doc.content);if(!function K(i){return"number"==typeof i}(H)||!W||H===W.b)return;const Y=C.tr,ue=Ot({state:C,transaction:Y});return function rn(i){const{editor:t,state:n,from:s,to:l,rule:a}=i,{commands:d,chain:h,can:m}=new ut({editor:t,state:n}),b=[];return n.doc.nodesBetween(s,l,(I,D)=>{if(!I.isTextblock||I.type.spec.code)return;const R=Math.max(s,D),H=Math.min(l,D+I.content.size);((i,t)=>{if(v(t))return[...i.matchAll(t)];const n=t(i);return n?n.map(s=>{const l=[];return l.push(s.text),l.index=s.index,l.input=i,l.data=s.data,s.replaceWith&&(s.text.includes(s.replaceWith)||console.warn('[tiptap warn]: "pasteRuleMatch.replaceWith" must be part of "pasteRuleMatch.text".'),l.push(s.replaceWith)),l}):[]})(I.textBetween(R-D,H-D,void 0,"\ufffc"),a.find).forEach(ue=>{if(void 0===ue.index)return;const Ue=R+ue.index+1,yt=Ue+ue[0].length,Tt={from:n.tr.mapping.map(Ue),to:n.tr.mapping.map(yt)},Re=a.handler({state:n,range:Tt,match:ue,commands:d,chain:h,can:m});b.push(Re)})}),b.every(I=>null!==I)}({editor:t,state:ue,from:Math.max(H-1,0),to:W.b,rule:h})&&Y.steps.length?Y:void 0}}))}class _n{constructor(t,n){this.splittableMarks=[],this.editor=n,this.extensions=_n.resolve(t),this.schema=k(this.extensions),this.extensions.forEach(s=>{var l;this.editor.extensionStorage[s.name]=s.storage;const a={name:s.name,options:s.options,storage:s.storage,editor:this.editor,type:c(s.name,this.schema)};"mark"===s.type&&(null===(l=V(N(s,"keepOnSplit",a)))||void 0===l||l)&&this.splittableMarks.push(s.name);const d=N(s,"onBeforeCreate",a);d&&this.editor.on("beforeCreate",d);const h=N(s,"onCreate",a);h&&this.editor.on("create",h);const m=N(s,"onUpdate",a);m&&this.editor.on("update",m);const b=N(s,"onSelectionUpdate",a);b&&this.editor.on("selectionUpdate",b);const C=N(s,"onTransaction",a);C&&this.editor.on("transaction",C);const I=N(s,"onFocus",a);I&&this.editor.on("focus",I);const D=N(s,"onBlur",a);D&&this.editor.on("blur",D);const R=N(s,"onDestroy",a);R&&this.editor.on("destroy",R)})}static resolve(t){const n=_n.sort(_n.flatten(t)),s=function Ki(i){const t=i.filter((n,s)=>i.indexOf(n)!==s);return[...new Set(t)]}(n.map(l=>l.name));return s.length&&console.warn(`[tiptap warn]: Duplicate extension names found: [${s.map(l=>`'${l}'`).join(", ")}]. This can lead to issues.`),n}static flatten(t){return t.map(n=>{const l=N(n,"addExtensions",{name:n.name,options:n.options,storage:n.storage});return l?[n,...this.flatten(l())]:n}).flat(10)}static sort(t){return t.sort((s,l)=>{const a=N(s,"priority")||100,d=N(l,"priority")||100;return a>d?-1:a<d?1:0})}get commands(){return this.extensions.reduce((t,n)=>{const l=N(n,"addCommands",{name:n.name,options:n.options,storage:n.storage,editor:this.editor,type:c(n.name,this.schema)});return l?he(he({},t),l()):t},{})}get plugins(){const{editor:t}=this,n=_n.sort([...this.extensions].reverse()),s=[],l=[],a=n.map(d=>{const h={name:d.name,options:d.options,storage:d.storage,editor:t,type:c(d.name,this.schema)},m=[],b=N(d,"addKeyboardShortcuts",h);if(b){const R=Object.fromEntries(Object.entries(b()).map(([W,Y])=>[W,()=>Y({editor:t})])),H=(0,Ve.h)(R);m.push(H)}const C=N(d,"addInputRules",h);f(d,t.options.enableInputRules)&&C&&s.push(...C());const I=N(d,"addPasteRules",h);f(d,t.options.enablePasteRules)&&I&&l.push(...I());const D=N(d,"addProseMirrorPlugins",h);if(D){const R=D();m.push(...R)}return m}).flat();return[J({editor:t,rules:s}),...sn({editor:t,rules:l}),...a]}get attributes(){return x(this.extensions)}get nodeViews(){const{editor:t}=this,{nodeExtensions:n}=y(this.extensions);return Object.fromEntries(n.filter(s=>!!N(s,"addNodeView")).map(s=>{const l=this.attributes.filter(m=>m.type===s.name),a={name:s.name,options:s.options,storage:s.storage,editor:t,type:S(s.name,this.schema)},d=N(s,"addNodeView",a);return d?[s.name,(m,b,C,I)=>{const D=F(m,l);return d()({editor:t,node:m,getPos:C,decorations:I,HTMLAttributes:D,extension:s})}]:[]}))}}function qe(i){return"Object"===function $n(i){return Object.prototype.toString.call(i).slice(8,-1)}(i)&&i.constructor===Object&&Object.getPrototypeOf(i)===Object.prototype}function Nn(i,t){const n=he({},i);return qe(i)&&qe(t)&&Object.keys(t).forEach(s=>{qe(t[s])?s in i?n[s]=Nn(i[s],t[s]):Object.assign(n,{[s]:t[s]}):Object.assign(n,{[s]:t[s]})}),n}class Et{constructor(t={}){this.type="extension",this.name="extension",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=he(he({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(N(this,"addOptions",{name:this.name}))),this.storage=V(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Et(t)}configure(t={}){const n=this.extend();return n.options=Nn(this.options,t),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new Et(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=V(N(n,"addOptions",{name:n.name})),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}}function yn(i,t,n){const{from:s,to:l}=t,{blockSeparator:a="\n\n",textSerializers:d={}}=n||{};let h="",m=!0;return i.nodesBetween(s,l,(b,C,I,D)=>{var R;const H=null==d?void 0:d[b.type.name];H?(b.isBlock&&!m&&(h+=a,m=!0),I&&(h+=H({node:b,pos:C,parent:I,index:D,range:t}))):b.isText?(h+=null===(R=null==b?void 0:b.text)||void 0===R?void 0:R.slice(Math.max(s,C)-C,l-C),m=!1):b.isBlock&&!m&&(h+=a,m=!0)}),h}function Cn(i){return Object.fromEntries(Object.entries(i.nodes).filter(([,t])=>t.spec.toText).map(([t,n])=>[t,n.spec.toText]))}const kt=Et.create({name:"clipboardTextSerializer",addProseMirrorPlugins(){return[new w.Sy({key:new w.H$("clipboardTextSerializer"),props:{clipboardTextSerializer:()=>{const{editor:i}=this,{state:t,schema:n}=i,{doc:s,selection:l}=t,{ranges:a}=l;return yn(s,{from:Math.min(...a.map(C=>C.$from.pos)),to:Math.max(...a.map(C=>C.$to.pos))},{textSerializers:Cn(n)})}}})]}});function Zt(i,t,n={strict:!0}){const s=Object.keys(t);return!s.length||s.every(l=>n.strict?t[l]===i[l]:v(t[l])?t[l].test(i[l]):t[l]===i[l])}function ci(i,t,n={}){return i.find(s=>s.type===t&&Zt(s.attrs,n))}function Un(i,t,n={}){return!!ci(i,t,n)}function Be(i,t,n={}){if(!i||!t)return;let s=i.parent.childAfter(i.parentOffset);if(i.parentOffset===s.offset&&0!==s.offset&&(s=i.parent.childBefore(i.parentOffset)),!s.node)return;const l=ci([...s.node.marks],t,n);if(!l)return;let a=s.index,d=i.start()+s.offset,h=a+1,m=d+s.node.nodeSize;for(ci([...s.node.marks],t,n);a>0&&l.isInSet(i.parent.child(a-1).marks);)a-=1,d-=i.parent.child(a).nodeSize;for(;h<i.parent.childCount&&Un([...i.parent.child(h).marks],t,n);)m+=i.parent.child(h).nodeSize,h+=1;return{from:d,to:m}}function dt(i,t){if("string"==typeof i){if(!t.marks[i])throw Error(`There is no mark type named '${i}'. Maybe you forgot to add the extension?`);return t.marks[i]}return i}function Jn(i){return i&&"object"==typeof i&&!Array.isArray(i)&&!function Rn(i){var t;return"class"===(null===(t=i.constructor)||void 0===t?void 0:t.toString().substring(0,5))}(i)}function Kn(i){return Jn(i)&&i instanceof w.Bs}function Bt(i=0,t=0,n=0){return Math.min(Math.max(i,t),n)}function Yn(i,t=null){if(!t)return null;const n=w.Y1.atStart(i),s=w.Y1.atEnd(i);if("start"===t||!0===t)return n;if("end"===t)return s;const l=n.from,a=s.to;return"all"===t?w.Bs.create(i,Bt(0,l,a),Bt(i.content.size,l,a)):w.Bs.create(i,Bt(t,l,a),Bt(t,l,a))}function wt(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}function Gn(i){const t=`<body>${i}</body>`;return(new window.DOMParser).parseFromString(t,"text/html").body}function Qt(i,t,n){if(n=he({slice:!0,parseOptions:{}},n),"object"==typeof i&&null!==i)try{return Array.isArray(i)?X.HY.fromArray(i.map(s=>t.nodeFromJSON(s))):t.nodeFromJSON(i)}catch(s){return console.warn("[tiptap warn]: Invalid content.","Passed value:",i,"Error:",s),Qt("",t,n)}if("string"==typeof i){const s=X.aw.fromSchema(t);return n.slice?s.parseSlice(Gn(i),n.parseOptions).content:s.parse(Gn(i),n.parseOptions)}return Qt("",t,n)}function fi(){return"undefined"!=typeof navigator&&/Mac/.test(navigator.platform)}function qt(i,t,n={}){const{from:s,to:l,empty:a}=i.selection,d=t?S(t,i.schema):null,h=[];i.doc.nodesBetween(s,l,(I,D)=>{if(I.isText)return;const R=Math.max(s,D),H=Math.min(l,D+I.nodeSize);h.push({node:I,from:R,to:H})});const m=l-s,b=h.filter(I=>!d||d.name===I.node.type.name).filter(I=>Zt(I.node.attrs,n,{strict:!1}));return a?!!b.length:b.reduce((I,D)=>I+D.to-D.from,0)>=m}function Zn(i,t){return t.nodes[i]?"node":t.marks[i]?"mark":null}function Li(i,t){const n="string"==typeof t?[t]:t;return Object.keys(i).reduce((s,l)=>(n.includes(l)||(s[l]=i[l]),s),{})}function ce(i,t,n={}){return Qt(i,t,{slice:!1,parseOptions:n})}function Pt(i,t){const n=dt(t,i.schema),{from:s,to:l,empty:a}=i.selection,d=[];a?(i.storedMarks&&d.push(...i.storedMarks),d.push(...i.selection.$head.marks())):i.doc.nodesBetween(s,l,m=>{d.push(...m.marks)});const h=d.find(m=>m.type.name===n.name);return h?he({},h.attrs):{}}function yi(i,t,n){return Object.fromEntries(Object.entries(n).filter(([s])=>{const l=i.find(a=>a.type===t&&a.name===s);return!!l&&l.attribute.keepOnSplit}))}function bn(i,t){const n=i.storedMarks||i.selection.$to.parentOffset&&i.selection.$from.marks();if(n){const s=n.filter(l=>null==t?void 0:t.includes(l.type.name));i.tr.ensureMarks(s)}}function Hi(i,t){for(let n=i.depth;n>0;n-=1){const s=i.node(n);if(t(s))return{pos:n>0?i.before(n):0,start:i.start(n),depth:n,node:s}}}function Fn(i){return t=>Hi(t.$from,i)}function bi(i,t){const{nodeExtensions:n}=y(t),s=n.find(d=>d.name===i);if(!s)return!1;const a=V(N(s,"group",{name:s.name,options:s.options,storage:s.storage}));return"string"==typeof a&&a.split(" ").includes("list")}const vi=(i,t)=>{const n=Fn(d=>d.type===t)(i.selection);if(!n)return!0;const s=i.doc.resolve(Math.max(0,n.pos-1)).before(n.depth);if(void 0===s)return!0;const l=i.doc.nodeAt(s);return n.node.type===(null==l?void 0:l.type)&&(0,q.Mn)(i.doc,n.pos)&&i.join(n.pos),!0},xi=(i,t)=>{const n=Fn(d=>d.type===t)(i.selection);if(!n)return!0;const s=i.doc.resolve(n.start).after(n.depth);if(void 0===s)return!0;const l=i.doc.nodeAt(s);return n.node.type===(null==l?void 0:l.type)&&(0,q.Mn)(i.doc,s)&&i.join(s),!0};function an(i,t,n={}){const{empty:s,ranges:l}=i.selection,a=t?dt(t,i.schema):null;if(s)return!!(i.storedMarks||i.selection.$from.marks()).filter(I=>!a||a.name===I.type.name).find(I=>Zt(I.attrs,n,{strict:!1}));let d=0;const h=[];if(l.forEach(({$from:I,$to:D})=>{const R=I.pos,H=D.pos;i.doc.nodesBetween(R,H,(W,Y)=>{if(!W.isText&&!W.marks.length)return;const ue=Math.max(R,Y),Ue=Math.min(H,Y+W.nodeSize);d+=Ue-ue,h.push(...W.marks.map(Tt=>({mark:Tt,from:ue,to:Ue})))})}),0===d)return!1;const m=h.filter(I=>!a||a.name===I.mark.type.name).filter(I=>Zt(I.mark.attrs,n,{strict:!1})).reduce((I,D)=>I+D.to-D.from,0),b=h.filter(I=>!a||I.mark.type!==a&&I.mark.type.excludes(a)).reduce((I,D)=>I+D.to-D.from,0);return(m>0?m+b:m)>=d}var tn=Object.freeze({__proto__:null,blur:()=>({editor:i,view:t})=>(requestAnimationFrame(()=>{var n;i.isDestroyed||(t.dom.blur(),null===(n=null==window?void 0:window.getSelection())||void 0===n||n.removeAllRanges())}),!0),clearContent:(i=!1)=>({commands:t})=>t.setContent("",i),clearNodes:()=>({state:i,tr:t,dispatch:n})=>{const{selection:s}=t,{ranges:l}=s;return n&&l.forEach(({$from:a,$to:d})=>{i.doc.nodesBetween(a.pos,d.pos,(h,m)=>{if(h.type.isText)return;const{doc:b,mapping:C}=t,I=b.resolve(C.map(m)),D=b.resolve(C.map(m+h.nodeSize)),R=I.blockRange(D);if(!R)return;const H=(0,q.k9)(R);if(h.type.isTextblock){const{defaultType:W}=I.parent.contentMatchAt(I.index());t.setNodeMarkup(R.start,W)}(H||0===H)&&t.lift(R,H)})}),!0},command:i=>t=>i(t),createParagraphNear:()=>({state:i,dispatch:t})=>_e(i,t),deleteNode:i=>({tr:t,state:n,dispatch:s})=>{const l=S(i,n.schema),a=t.selection.$anchor;for(let d=a.depth;d>0;d-=1)if(a.node(d).type===l){if(s){const m=a.before(d),b=a.after(d);t.delete(m,b).scrollIntoView()}return!0}return!1},deleteRange:i=>({tr:t,dispatch:n})=>{const{from:s,to:l}=i;return n&&t.delete(s,l),!0},deleteSelection:()=>({state:i,dispatch:t})=>Ee(i,t),enter:()=>({commands:i})=>i.keyboardShortcut("Enter"),exitCode:()=>({state:i,dispatch:t})=>fe(i,t),extendMarkRange:(i,t={})=>({tr:n,state:s,dispatch:l})=>{const a=dt(i,s.schema),{doc:d,selection:h}=n,{$from:m,from:b,to:C}=h;if(l){const I=Be(m,a,t);if(I&&I.from<=b&&I.to>=C){const D=w.Bs.create(d,I.from,I.to);n.setSelection(D)}}return!0},first:i=>t=>{const n="function"==typeof i?i(t):i;for(let s=0;s<n.length;s+=1)if(n[s](t))return!0;return!1},focus:(i=null,t={})=>({editor:n,view:s,tr:l,dispatch:a})=>{t=he({scrollIntoView:!0},t);const d=()=>{wt()&&s.dom.focus(),requestAnimationFrame(()=>{n.isDestroyed||(s.focus(),(null==t?void 0:t.scrollIntoView)&&n.commands.scrollIntoView())})};if(s.hasFocus()&&null===i||!1===i)return!0;if(a&&null===i&&!Kn(n.state.selection))return d(),!0;const h=Yn(n.state.doc,i)||n.state.selection,m=n.state.selection.eq(h);return a&&(m||l.setSelection(h),m&&l.storedMarks&&l.setStoredMarks(l.storedMarks),d()),!0},forEach:(i,t)=>n=>i.every((s,l)=>t(s,Ht(he({},n),{index:l}))),insertContent:(i,t)=>({tr:n,commands:s})=>s.insertContentAt({from:n.selection.from,to:n.selection.to},i,t),insertContentAt:(i,t,n)=>({tr:s,dispatch:l,editor:a})=>{if(l){n=he({parseOptions:{},updateSelection:!0},n);const d=Qt(t,a.schema,{parseOptions:he({preserveWhitespace:"full"},n.parseOptions)});if("<>"===d.toString())return!0;let{from:h,to:m}="number"==typeof i?{from:i,to:i}:i,b=!0,C=!0;if(((i=>i.toString().startsWith("<"))(d)?d:[d]).forEach(D=>{D.check(),b=!!b&&D.isText&&0===D.marks.length,C=!!C&&D.isBlock}),h===m&&C){const{parent:D}=s.doc.resolve(h);D.isTextblock&&!D.type.spec.code&&!D.childCount&&(h-=1,m+=1)}b?s.insertText(t,h,m):s.replaceWith(h,m,d),n.updateSelection&&function Fi(i,t,n){const s=i.steps.length-1;if(s<t)return;const l=i.steps[s];if(!(l instanceof q.Pu||l instanceof q.FC))return;let d=0;i.mapping.maps[s].forEach((h,m,b,C)=>{0===d&&(d=C)}),i.setSelection(w.Y1.near(i.doc.resolve(d),n))}(s,s.steps.length-1,-1)}return!0},joinBackward:()=>({state:i,dispatch:t})=>Oe(i,t),joinForward:()=>({state:i,dispatch:t})=>ke(i,t),keyboardShortcut:i=>({editor:t,view:n,tr:s,dispatch:l})=>{const a=function hi(i){const t=i.split(/-(?!$)/);let s,l,a,d,n=t[t.length-1];"Space"===n&&(n=" ");for(let h=0;h<t.length-1;h+=1){const m=t[h];if(/^(cmd|meta|m)$/i.test(m))d=!0;else if(/^a(lt)?$/i.test(m))s=!0;else if(/^(c|ctrl|control)$/i.test(m))l=!0;else if(/^s(hift)?$/i.test(m))a=!0;else{if(!/^mod$/i.test(m))throw new Error(`Unrecognized modifier name: ${m}`);wt()||fi()?d=!0:l=!0}}return s&&(n=`Alt-${n}`),l&&(n=`Ctrl-${n}`),d&&(n=`Meta-${n}`),a&&(n=`Shift-${n}`),n}(i).split(/-(?!$)/),d=a.find(b=>!["Alt","Ctrl","Meta","Shift"].includes(b)),h=new KeyboardEvent("keydown",{key:"Space"===d?" ":d,altKey:a.includes("Alt"),ctrlKey:a.includes("Ctrl"),metaKey:a.includes("Meta"),shiftKey:a.includes("Shift"),bubbles:!0,cancelable:!0}),m=t.captureTransaction(()=>{n.someProp("handleKeyDown",b=>b(n,h))});return null==m||m.steps.forEach(b=>{const C=b.map(s.mapping);C&&l&&s.maybeStep(C)}),!0},lift:(i,t={})=>({state:n,dispatch:s})=>!!qt(n,S(i,n.schema),t)&&((i,t)=>{let{$from:n,$to:s}=i.selection,l=n.blockRange(s),a=l&&(0,q.k9)(l);return null!=a&&(t&&t(i.tr.lift(l,a).scrollIntoView()),!0)})(n,s),liftEmptyBlock:()=>({state:i,dispatch:t})=>le(i,t),liftListItem:i=>({state:t,dispatch:n})=>function It(i){return function(t,n){let{$from:s,$to:l}=t.selection,a=s.blockRange(l,d=>d.childCount>0&&d.firstChild.type==i);return!!a&&(!n||(s.node(a.depth-1).type==i?function Gt(i,t,n,s){let l=i.tr,a=s.end,d=s.$to.end(s.depth);a<d&&(l.step(new q.FC(a-1,d,a,d,new X.p2(X.HY.from(n.create(null,s.parent.copy())),1,0),1,!0)),s=new X.Ts(l.doc.resolve(s.$from.pos),l.doc.resolve(d),s.depth));const h=(0,q.k9)(s);return null!=h&&(t(l.lift(s,h).scrollIntoView()),!0)}(t,n,i,a):function En(i,t,n){let s=i.tr,l=n.parent;for(let R=n.end,H=n.endIndex-1,W=n.startIndex;H>W;H--)R-=l.child(H).nodeSize,s.delete(R-1,R+1);let a=s.doc.resolve(n.start),d=a.nodeAfter;if(s.mapping.map(n.end)!=n.start+a.nodeAfter.nodeSize)return!1;let h=0==n.startIndex,m=n.endIndex==l.childCount,b=a.node(-1),C=a.index(-1);if(!b.canReplace(C+(h?0:1),C+1,d.content.append(m?X.HY.empty:X.HY.from(l))))return!1;let I=a.pos,D=I+d.nodeSize;return s.step(new q.FC(I-(h?1:0),D+(m?1:0),I+1,D-1,new X.p2((h?X.HY.empty:X.HY.from(l.copy(X.HY.empty))).append(m?X.HY.empty:X.HY.from(l.copy(X.HY.empty))),h?0:1,m?0:1),h?0:1)),t(s.scrollIntoView()),!0}(t,n,a)))}}(S(i,t.schema))(t,n),newlineInCode:()=>({state:i,dispatch:t})=>Ke(i,t),resetAttributes:(i,t)=>({tr:n,state:s,dispatch:l})=>{let a=null,d=null;const h=Zn("string"==typeof i?i:i.name,s.schema);return!!h&&("node"===h&&(a=S(i,s.schema)),"mark"===h&&(d=dt(i,s.schema)),l&&n.selection.ranges.forEach(m=>{s.doc.nodesBetween(m.$from.pos,m.$to.pos,(b,C)=>{a&&a===b.type&&n.setNodeMarkup(C,void 0,Li(b.attrs,t)),d&&b.marks.length&&b.marks.forEach(I=>{d===I.type&&n.addMark(C,C+b.nodeSize,d.create(Li(I.attrs,t)))})})}),!0)},scrollIntoView:()=>({tr:i,dispatch:t})=>(t&&i.scrollIntoView(),!0),selectAll:()=>({tr:i,commands:t})=>t.setTextSelection({from:0,to:i.doc.content.size}),selectNodeBackward:()=>({state:i,dispatch:t})=>ae(i,t),selectNodeForward:()=>({state:i,dispatch:t})=>ve(i,t),selectParentNode:()=>({state:i,dispatch:t})=>((i,t)=>{let l,{$from:n,to:s}=i.selection,a=n.sharedDepth(s);return 0!=a&&(l=n.before(a),t&&t(i.tr.setSelection(w.qv.create(i.doc,l))),!0)})(i,t),selectTextblockEnd:()=>({state:i,dispatch:t})=>re(i,t),selectTextblockStart:()=>({state:i,dispatch:t})=>Me(i,t),setContent:(i,t=!1,n={})=>({tr:s,editor:l,dispatch:a})=>{const{doc:d}=s,h=ce(i,l.schema,n),m=w.Bs.create(d,0,d.content.size);return a&&s.setSelection(m).replaceSelectionWith(h,!1).setMeta("preventUpdate",!t),!0},setMark:(i,t={})=>({tr:n,state:s,dispatch:l})=>{const{selection:a}=n,{empty:d,ranges:h}=a,m=dt(i,s.schema);if(l)if(d){const b=Pt(s,m);n.addStoredMark(m.create(he(he({},b),t)))}else h.forEach(b=>{const C=b.$from.pos,I=b.$to.pos;s.doc.nodesBetween(C,I,(D,R)=>{const H=Math.max(R,C),W=Math.min(R+D.nodeSize,I);D.marks.find(ue=>ue.type===m)?D.marks.forEach(ue=>{m===ue.type&&n.addMark(H,W,m.create(he(he({},ue.attrs),t)))}):n.addMark(H,W,m.create(t))})});return!0},setMeta:(i,t)=>({tr:n})=>(n.setMeta(i,t),!0),setNode:(i,t={})=>({state:n,dispatch:s,chain:l})=>{const a=S(i,n.schema);return a.isTextblock?l().command(({commands:d})=>!!L(a,t)(n)||d.clearNodes()).command(({state:d})=>L(a,t)(d,s)).run():(console.warn('[tiptap warn]: Currently "setNode()" only supports text block nodes.'),!1)},setNodeSelection:i=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,l=w.Y1.atStart(s).from,a=w.Y1.atEnd(s).to,d=Bt(i,l,a),h=w.qv.create(s,d);t.setSelection(h)}return!0},setTextSelection:i=>({tr:t,dispatch:n})=>{if(n){const{doc:s}=t,{from:l,to:a}="number"==typeof i?{from:i,to:i}:i,d=w.Bs.atStart(s).from,h=w.Bs.atEnd(s).to,m=Bt(l,d,h),b=Bt(a,d,h),C=w.Bs.create(s,m,b);t.setSelection(C)}return!0},sinkListItem:i=>({state:t,dispatch:n})=>function Pn(i){return function(t,n){let{$from:s,$to:l}=t.selection,a=s.blockRange(l,b=>b.childCount>0&&b.firstChild.type==i);if(!a)return!1;let d=a.startIndex;if(0==d)return!1;let h=a.parent,m=h.child(d-1);if(m.type!=i)return!1;if(n){let b=m.lastChild&&m.lastChild.type==h.type,C=X.HY.from(b?i.create():null),I=new X.p2(X.HY.from(i.create(null,X.HY.from(h.type.create(null,C)))),b?3:1,0),D=a.start,R=a.end;n(t.tr.step(new q.FC(D-(b?3:1),R,D,R,I,1,!0)).scrollIntoView())}return!0}}(S(i,t.schema))(t,n),splitBlock:({keepMarks:i=!0}={})=>({tr:t,state:n,dispatch:s,editor:l})=>{const{selection:a,doc:d}=t,{$from:h,$to:m}=a,C=yi(l.extensionManager.attributes,h.node().type.name,h.node().attrs);if(a instanceof w.qv&&a.node.isBlock)return!(!h.parentOffset||!(0,q.Ax)(d,h.pos)||(s&&(i&&bn(n,l.extensionManager.splittableMarks),t.split(h.pos).scrollIntoView()),0));if(!h.parent.isBlock)return!1;if(s){const I=m.parentOffset===m.parent.content.size;a instanceof w.Bs&&t.deleteSelection();const D=0===h.depth?void 0:function fo(i){for(let t=0;t<i.edgeCount;t+=1){const{type:n}=i.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}(h.node(-1).contentMatchAt(h.indexAfter(-1)));let R=I&&D?[{type:D,attrs:C}]:void 0,H=(0,q.Ax)(t.doc,t.mapping.map(h.pos),1,R);if(!R&&!H&&(0,q.Ax)(t.doc,t.mapping.map(h.pos),1,D?[{type:D}]:void 0)&&(H=!0,R=D?[{type:D,attrs:C}]:void 0),H&&(t.split(t.mapping.map(h.pos),1,R),D&&!I&&!h.parentOffset&&h.parent.type!==D)){const W=t.mapping.map(h.before()),Y=t.doc.resolve(W);h.node(-1).canReplaceWith(Y.index(),Y.index()+1,D)&&t.setNodeMarkup(t.mapping.map(h.before()),D)}i&&bn(n,l.extensionManager.splittableMarks),t.scrollIntoView()}return!0},splitListItem:i=>({tr:t,state:n,dispatch:s,editor:l})=>{var a;const d=S(i,n.schema),{$from:h,$to:m}=n.selection,b=n.selection.node;if(b&&b.isBlock||h.depth<2||!h.sameParent(m))return!1;const C=h.node(-1);if(C.type!==d)return!1;const I=l.extensionManager.attributes;if(0===h.parent.content.size&&h.node(-1).childCount===h.indexAfter(-1)){if(2===h.depth||h.node(-3).type!==d||h.index(-2)!==h.node(-2).childCount-1)return!1;if(s){let Y=X.HY.empty;const ue=h.index(-1)?1:h.index(-2)?2:3;for(let zt=h.depth-ue;zt>=h.depth-3;zt-=1)Y=X.HY.from(h.node(zt).copy(Y));const Ue=h.indexAfter(-1)<h.node(-2).childCount?1:h.indexAfter(-2)<h.node(-3).childCount?2:3,yt=yi(I,h.node().type.name,h.node().attrs),Tt=(null===(a=d.contentMatch.defaultType)||void 0===a?void 0:a.createAndFill(yt))||void 0;Y=Y.append(X.HY.from(d.createAndFill(null,Tt)||void 0));const Re=h.before(h.depth-(ue-1));t.replace(Re,h.after(-Ue),new X.p2(Y,4-ue,0));let Kt=-1;t.doc.nodesBetween(Re,t.doc.content.size,(zt,we)=>{if(Kt>-1)return!1;zt.isTextblock&&0===zt.content.size&&(Kt=we+1)}),Kt>-1&&t.setSelection(w.Bs.near(t.doc.resolve(Kt))),t.scrollIntoView()}return!0}const D=m.pos===h.end()?C.contentMatchAt(0).defaultType:null,R=yi(I,C.type.name,C.attrs),H=yi(I,h.node().type.name,h.node().attrs);t.delete(h.pos,m.pos);const W=D?[{type:d,attrs:R},{type:D,attrs:H}]:[{type:d,attrs:R}];return!!(0,q.Ax)(t.doc,h.pos,2)&&(s&&t.split(h.pos,2,W).scrollIntoView(),!0)},toggleList:(i,t)=>({editor:n,tr:s,state:l,dispatch:a,chain:d,commands:h,can:m})=>{const{extensions:b}=n.extensionManager,C=S(i,l.schema),I=S(t,l.schema),{selection:D}=l,{$from:R,$to:H}=D,W=R.blockRange(H);if(!W)return!1;const Y=Fn(ue=>bi(ue.type.name,b))(D);if(W.depth>=1&&Y&&W.depth-Y.depth<=1){if(Y.node.type===C)return h.liftListItem(I);if(bi(Y.node.type.name,b)&&C.validContent(Y.node.content)&&a)return d().command(()=>(s.setNodeMarkup(Y.pos,C),!0)).command(()=>vi(s,C)).command(()=>xi(s,C)).run()}return d().command(()=>!!m().wrapInList(C)||h.clearNodes()).wrapInList(C).command(()=>vi(s,C)).command(()=>xi(s,C)).run()},toggleMark:(i,t={},n={})=>({state:s,commands:l})=>{const{extendEmptyMarkRange:a=!1}=n,d=dt(i,s.schema);return an(s,d,t)?l.unsetMark(d,{extendEmptyMarkRange:a}):l.setMark(d,t)},toggleNode:(i,t,n={})=>({state:s,commands:l})=>{const a=S(i,s.schema),d=S(t,s.schema);return qt(s,a,n)?l.setNode(d):l.setNode(a,n)},toggleWrap:(i,t={})=>({state:n,commands:s})=>{const l=S(i,n.schema);return qt(n,l,t)?s.lift(l):s.wrapIn(l,t)},undoInputRule:()=>({state:i,dispatch:t})=>{const n=i.plugins;for(let s=0;s<n.length;s+=1){const l=n[s];let a;if(l.spec.isInputRules&&(a=l.getState(i))){if(t){const d=i.tr,h=a.transform;for(let m=h.steps.length-1;m>=0;m-=1)d.step(h.steps[m].invert(h.docs[m]));if(a.text){const m=d.doc.resolve(a.from).marks();d.replaceWith(a.from,a.to,i.schema.text(a.text,m))}else d.delete(a.from,a.to)}return!0}}return!1},unsetAllMarks:()=>({tr:i,dispatch:t})=>{const{selection:n}=i,{empty:s,ranges:l}=n;return s||t&&l.forEach(a=>{i.removeMark(a.$from.pos,a.$to.pos)}),!0},unsetMark:(i,t={})=>({tr:n,state:s,dispatch:l})=>{var a;const{extendEmptyMarkRange:d=!1}=t,{selection:h}=n,m=dt(i,s.schema),{$from:b,empty:C,ranges:I}=h;if(!l)return!0;if(C&&d){let{from:D,to:R}=h;const H=null===(a=b.marks().find(Y=>Y.type===m))||void 0===a?void 0:a.attrs,W=Be(b,m,H);W&&(D=W.from,R=W.to),n.removeMark(D,R,m)}else I.forEach(D=>{n.removeMark(D.$from.pos,D.$to.pos,m)});return n.removeStoredMark(m),!0},updateAttributes:(i,t={})=>({tr:n,state:s,dispatch:l})=>{let a=null,d=null;const h=Zn("string"==typeof i?i:i.name,s.schema);return!!h&&("node"===h&&(a=S(i,s.schema)),"mark"===h&&(d=dt(i,s.schema)),l&&n.selection.ranges.forEach(m=>{const b=m.$from.pos,C=m.$to.pos;s.doc.nodesBetween(b,C,(I,D)=>{a&&a===I.type&&n.setNodeMarkup(D,void 0,he(he({},I.attrs),t)),d&&I.marks.length&&I.marks.forEach(R=>{if(d===R.type){const H=Math.max(D,b),W=Math.min(D+I.nodeSize,C);n.addMark(H,W,d.create(he(he({},R.attrs),t)))}})})}),!0)},wrapIn:(i,t={})=>({state:n,dispatch:s})=>function O(i,t=null){return function(n,s){let{$from:l,$to:a}=n.selection,d=l.blockRange(a),h=d&&(0,q.nd)(d,i,t);return!!h&&(s&&s(n.tr.wrap(d,h).scrollIntoView()),!0)}}(S(i,n.schema),t)(n,s),wrapInList:(i,t={})=>({state:n,dispatch:s})=>function ct(i,t=null){return function(n,s){let{$from:l,$to:a}=n.selection,d=l.blockRange(a),h=!1,m=d;if(!d)return!1;if(d.depth>=2&&l.node(d.depth-1).type.compatibleContent(i)&&0==d.startIndex){if(0==l.index(d.depth-1))return!1;let C=n.doc.resolve(d.start-2);m=new X.Ts(C,C,d.depth),d.endIndex<d.parent.childCount&&(d=new X.Ts(l,n.doc.resolve(a.end(d.depth)),d.depth)),h=!0}let b=(0,q.nd)(m,i,t,d);return!!b&&(s&&s(function On(i,t,n,s,l){let a=X.HY.empty;for(let C=n.length-1;C>=0;C--)a=X.HY.from(n[C].type.create(n[C].attrs,a));i.step(new q.FC(t.start-(s?2:0),t.end,t.start,t.end,new X.p2(a,0,0),n.length,!0));let d=0;for(let C=0;C<n.length;C++)n[C].type==l&&(d=C+1);let h=n.length-d,m=t.start+n.length-(s?2:0),b=t.parent;for(let C=t.startIndex,I=t.endIndex,D=!0;C<I;C++,D=!1)!D&&(0,q.Ax)(i.doc,m,h)&&(i.split(m,h),m+=2*h),m+=b.child(C).nodeSize;return i}(n.tr,d,b,h,i).scrollIntoView()),!0)}}(S(i,n.schema),t)(n,s)});const xn=Et.create({name:"commands",addCommands:()=>he({},tn)}),pt=Et.create({name:"editable",addProseMirrorPlugins(){return[new w.Sy({key:new w.H$("editable"),props:{editable:()=>this.editor.options.editable}})]}}),cn=Et.create({name:"focusEvents",addProseMirrorPlugins(){const{editor:i}=this;return[new w.Sy({key:new w.H$("focusEvents"),props:{handleDOMEvents:{focus:(t,n)=>{i.isFocused=!0;const s=i.state.tr.setMeta("focus",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1},blur:(t,n)=>{i.isFocused=!1;const s=i.state.tr.setMeta("blur",{event:n}).setMeta("addToHistory",!1);return t.dispatch(s),!1}}}})]}}),Rt=Et.create({name:"keymap",addKeyboardShortcuts(){const i=()=>this.editor.commands.first(({commands:d})=>[()=>d.undoInputRule(),()=>d.command(({tr:h})=>{const{selection:m,doc:b}=h,{empty:C,$anchor:I}=m,{pos:D,parent:R}=I,H=w.Y1.atStart(b).from===D;return!(!(C&&H&&R.type.isTextblock)||R.textContent.length)&&d.clearNodes()}),()=>d.deleteSelection(),()=>d.joinBackward(),()=>d.selectNodeBackward()]),t=()=>this.editor.commands.first(({commands:d})=>[()=>d.deleteSelection(),()=>d.joinForward(),()=>d.selectNodeForward()]),s={Enter:()=>this.editor.commands.first(({commands:d})=>[()=>d.newlineInCode(),()=>d.createParagraphNear(),()=>d.liftEmptyBlock(),()=>d.splitBlock()]),"Mod-Enter":()=>this.editor.commands.exitCode(),Backspace:i,"Mod-Backspace":i,"Shift-Backspace":i,Delete:t,"Mod-Delete":t,"Mod-a":()=>this.editor.commands.selectAll()},l=he({},s),a=Ht(he({},s),{"Ctrl-h":i,"Alt-Backspace":i,"Ctrl-d":t,"Ctrl-Alt-Backspace":t,"Alt-Delete":t,"Alt-d":t,"Ctrl-a":()=>this.editor.commands.selectTextblockStart(),"Ctrl-e":()=>this.editor.commands.selectTextblockEnd()});return wt()||fi()?a:l},addProseMirrorPlugins(){return[new w.Sy({key:new w.H$("clearDocument"),appendTransaction:(i,t,n)=>{if(!i.some(H=>H.docChanged)||t.doc.eq(n.doc))return;const{empty:l,from:a,to:d}=t.selection,h=w.Y1.atStart(t.doc).from,m=w.Y1.atEnd(t.doc).to,b=a===h&&d===m,C=0===n.doc.textBetween(0,n.doc.content.size," "," ").length;if(l||!b||!C)return;const I=n.tr,D=Ot({state:n,transaction:I}),{commands:R}=new ut({editor:this.editor,state:D});return R.clearNodes(),I.steps.length?I:void 0}})]}}),lt=Et.create({name:"tabindex",addProseMirrorPlugins(){return[new w.Sy({key:new w.H$("tabindex"),props:{attributes:this.editor.isEditable?{tabindex:"0"}:{}}})]}});var at=Object.freeze({__proto__:null,ClipboardTextSerializer:kt,Commands:xn,Editable:pt,FocusEvents:cn,Keymap:Rt,Tabindex:lt});function Wt(i,t){const n=S(t,i.schema),{from:s,to:l}=i.selection,a=[];i.doc.nodesBetween(s,l,h=>{a.push(h)});const d=a.reverse().find(h=>h.type.name===n.name);return d?he({},d.attrs):{}}function Vi(i,t){const n=Zn("string"==typeof t?t:t.name,i.schema);return"node"===n?Wt(i,t):"mark"===n?Pt(i,t):{}}function Qn(i,t){const n=X.PW.fromSchema(t).serializeFragment(i),l=document.implementation.createHTMLDocument().createElement("div");return l.appendChild(n),l.innerHTML}function Xn(i,t){return yn(i,{from:0,to:i.content.size},t)}function Ln(i,t,n={}){if(!t)return qt(i,null,n)||an(i,null,n);const s=Zn(t,i.schema);return"node"===s?qt(i,t,n):"mark"===s&&an(i,t,n)}function Si(i){var t;const n=null===(t=i.type.createAndFill())||void 0===t?void 0:t.toJSON(),s=i.toJSON();return JSON.stringify(n)===JSON.stringify(s)}class ki extends class Dt{constructor(){this.callbacks={}}on(t,n){return this.callbacks[t]||(this.callbacks[t]=[]),this.callbacks[t].push(n),this}emit(t,...n){const s=this.callbacks[t];return s&&s.forEach(l=>l.apply(this,n)),this}off(t,n){const s=this.callbacks[t];return s&&(n?this.callbacks[t]=s.filter(l=>l!==n):delete this.callbacks[t]),this}removeAllListeners(){this.callbacks={}}}{constructor(t={}){super(),this.isFocused=!1,this.extensionStorage={},this.options={element:document.createElement("div"),content:"",injectCSS:!0,injectNonce:void 0,extensions:[],autofocus:!1,editable:!0,editorProps:{},parseOptions:{},enableInputRules:!0,enablePasteRules:!0,enableCoreExtensions:!0,onBeforeCreate:()=>null,onCreate:()=>null,onUpdate:()=>null,onSelectionUpdate:()=>null,onTransaction:()=>null,onFocus:()=>null,onBlur:()=>null,onDestroy:()=>null},this.isCapturingTransaction=!1,this.capturedTransaction=null,this.setOptions(t),this.createExtensionManager(),this.createCommandManager(),this.createSchema(),this.on("beforeCreate",this.options.onBeforeCreate),this.emit("beforeCreate",{editor:this}),this.createView(),this.injectCSS(),this.on("create",this.options.onCreate),this.on("update",this.options.onUpdate),this.on("selectionUpdate",this.options.onSelectionUpdate),this.on("transaction",this.options.onTransaction),this.on("focus",this.options.onFocus),this.on("blur",this.options.onBlur),this.on("destroy",this.options.onDestroy),window.setTimeout(()=>{this.isDestroyed||(this.commands.focus(this.options.autofocus),this.emit("create",{editor:this}))},0)}get storage(){return this.extensionStorage}get commands(){return this.commandManager.commands}chain(){return this.commandManager.chain()}can(){return this.commandManager.can()}injectCSS(){this.options.injectCSS&&document&&(this.css=function un(i,t){const n=document.querySelector("style[data-tiptap-style]");if(null!==n)return n;const s=document.createElement("style");return t&&s.setAttribute("nonce",t),s.setAttribute("data-tiptap-style",""),s.innerHTML=i,document.getElementsByTagName("head")[0].appendChild(s),s}('.ProseMirror {\n  position: relative;\n}\n\n.ProseMirror {\n  word-wrap: break-word;\n  white-space: pre-wrap;\n  white-space: break-spaces;\n  -webkit-font-variant-ligatures: none;\n  font-variant-ligatures: none;\n  font-feature-settings: "liga" 0; /* the above doesn\'t seem to work in Edge */\n}\n\n.ProseMirror [contenteditable="false"] {\n  white-space: normal;\n}\n\n.ProseMirror [contenteditable="false"] [contenteditable="true"] {\n  white-space: pre-wrap;\n}\n\n.ProseMirror pre {\n  white-space: pre-wrap;\n}\n\nimg.ProseMirror-separator {\n  display: inline !important;\n  border: none !important;\n  margin: 0 !important;\n  width: 1px !important;\n  height: 1px !important;\n}\n\n.ProseMirror-gapcursor {\n  display: none;\n  pointer-events: none;\n  position: absolute;\n  margin: 0;\n}\n\n.ProseMirror-gapcursor:after {\n  content: "";\n  display: block;\n  position: absolute;\n  top: -2px;\n  width: 20px;\n  border-top: 1px solid black;\n  animation: ProseMirror-cursor-blink 1.1s steps(2, start) infinite;\n}\n\n@keyframes ProseMirror-cursor-blink {\n  to {\n    visibility: hidden;\n  }\n}\n\n.ProseMirror-hideselection *::selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection *::-moz-selection {\n  background: transparent;\n}\n\n.ProseMirror-hideselection * {\n  caret-color: transparent;\n}\n\n.ProseMirror-focused .ProseMirror-gapcursor {\n  display: block;\n}\n\n.tippy-box[data-animation=fade][data-state=hidden] {\n  opacity: 0\n}',this.options.injectNonce))}setOptions(t={}){this.options=he(he({},this.options),t),this.view&&this.state&&!this.isDestroyed&&(this.options.editorProps&&this.view.setProps(this.options.editorProps),this.view.updateState(this.state))}setEditable(t){this.setOptions({editable:t})}get isEditable(){return this.options.editable&&this.view&&this.view.editable}get state(){return this.view.state}registerPlugin(t,n){const s=z(n)?n(t,[...this.state.plugins]):[...this.state.plugins,t],l=this.state.reconfigure({plugins:s});this.view.updateState(l)}unregisterPlugin(t){if(this.isDestroyed)return;const n="string"==typeof t?`${t}$`:t.key,s=this.state.reconfigure({plugins:this.state.plugins.filter(l=>!l.key.startsWith(n))});this.view.updateState(s)}createExtensionManager(){const n=[...this.options.enableCoreExtensions?Object.values(at):[],...this.options.extensions].filter(s=>["extension","node","mark"].includes(null==s?void 0:s.type));this.extensionManager=new _n(n,this)}createCommandManager(){this.commandManager=new ut({editor:this})}createSchema(){this.schema=this.extensionManager.schema}createView(){const t=ce(this.options.content,this.schema,this.options.parseOptions),n=Yn(t,this.options.autofocus);this.view=new ye.tk(this.options.element,Ht(he({},this.options.editorProps),{dispatchTransaction:this.dispatchTransaction.bind(this),state:w.yy.create({doc:t,selection:n||void 0})}));const s=this.state.reconfigure({plugins:this.extensionManager.plugins});this.view.updateState(s),this.createNodeViews(),this.view.dom.editor=this}createNodeViews(){this.view.setProps({nodeViews:this.extensionManager.nodeViews})}captureTransaction(t){this.isCapturingTransaction=!0,t(),this.isCapturingTransaction=!1;const n=this.capturedTransaction;return this.capturedTransaction=null,n}dispatchTransaction(t){if(this.isCapturingTransaction)return this.capturedTransaction?void t.steps.forEach(d=>{var h;return null===(h=this.capturedTransaction)||void 0===h?void 0:h.step(d)}):void(this.capturedTransaction=t);const n=this.state.apply(t),s=!this.state.selection.eq(n.selection);this.view.updateState(n),this.emit("transaction",{editor:this,transaction:t}),s&&this.emit("selectionUpdate",{editor:this,transaction:t});const l=t.getMeta("focus"),a=t.getMeta("blur");l&&this.emit("focus",{editor:this,event:l.event,transaction:t}),a&&this.emit("blur",{editor:this,event:a.event,transaction:t}),t.docChanged&&!t.getMeta("preventUpdate")&&this.emit("update",{editor:this,transaction:t})}getAttributes(t){return Vi(this.state,t)}isActive(t,n){return Ln(this.state,"string"==typeof t?t:null,"string"==typeof t?n:t)}getJSON(){return this.state.doc.toJSON()}getHTML(){return Qn(this.state.doc.content,this.schema)}getText(t){const{blockSeparator:n="\n\n",textSerializers:s={}}=t||{};return Xn(this.state.doc,{blockSeparator:n,textSerializers:he(he({},s),Cn(this.schema))})}get isEmpty(){return Si(this.state.doc)}getCharacterCount(){return console.warn('[tiptap warn]: "editor.getCharacterCount()" is deprecated. Please use "editor.storage.characterCount.characters()" instead.'),this.state.doc.content.size-2}destroy(){this.emit("destroy"),this.view&&this.view.destroy(),this.removeAllListeners()}get isDestroyed(){var t;return!(null===(t=this.view)||void 0===t?void 0:t.docView)}}function qn(i,t){const n=new q.wx(i);return t.forEach(s=>{s.steps.forEach(l=>{n.step(l)})}),n}function Jt(i){for(let t=0;t<i.edgeCount;t+=1){const{type:n}=i.edge(t);if(n.isTextblock&&!n.hasRequiredAttrs())return n}return null}function to(i,t){const n=[];return i.descendants((s,l)=>{t(s)&&n.push({node:s,pos:l})}),n}function mo(i,t,n){const s=[];return i.nodesBetween(t.from,t.to,(l,a)=>{n(l)&&s.push({node:l,pos:a})}),s}function ei(i){return k(_n.resolve(i))}function wi(i,t){const n=ei(t);return Qn(X.NB.fromJSON(n,i).content,n)}function $i(i,t){const n=ei(t),s=Gn(i);return X.aw.fromSchema(n).parse(s).toJSON()}function no(i,t,n){const{blockSeparator:s="\n\n",textSerializers:l={}}=n||{},a=ei(t);return Xn(X.NB.fromJSON(a,i),{blockSeparator:s,textSerializers:he(he({},l),Cn(a))})}function ro(i){const{mapping:t,steps:n}=i,s=[];return t.maps.forEach((l,a)=>{const d=[];if(l.ranges.length)l.forEach((h,m)=>{d.push({from:h,to:m})});else{const{from:h,to:m}=n[a];if(void 0===h||void 0===m)return;d.push({from:h,to:m})}d.forEach(({from:h,to:m})=>{const b=t.slice(a).map(h,-1),C=t.slice(a).map(m),I=t.invert().map(b,-1),D=t.invert().map(C);s.push({oldRange:{from:I,to:D},newRange:{from:b,to:C}})})}),function oo(i){const t=function io(i,t=JSON.stringify){const n={};return i.filter(s=>{const l=t(s);return!Object.prototype.hasOwnProperty.call(n,l)&&(n[l]=!0)})}(i);return 1===t.length?t:t.filter((n,s)=>!t.filter((a,d)=>d!==s).some(a=>n.oldRange.from>=a.oldRange.from&&n.oldRange.to<=a.oldRange.to&&n.newRange.from>=a.newRange.from&&n.newRange.to<=a.newRange.to))}(s)}function Ii(i,t=0){const s=i.type===i.type.schema.topNodeType?0:1,l=t,a=l+i.nodeSize,d=i.marks.map(b=>{const C={type:b.type.name};return Object.keys(b.attrs).length&&(C.attrs=he({},b.attrs)),C}),h=he({},i.attrs),m={type:i.type.name,from:l,to:a};return Object.keys(h).length&&(m.attrs=h),d.length&&(m.marks=d),i.content.childCount&&(m.content=[],i.forEach((b,C)=>{var I;null===(I=m.content)||void 0===I||I.push(Ii(b,t+C+s))})),i.text&&(m.text=i.text),m}function Oi(i,t,n){const s=[];return i===t?n.resolve(i).marks().forEach(l=>{const d=Be(n.resolve(i-1),l.type);!d||s.push(he({mark:l},d))}):n.nodesBetween(i,t,(l,a)=>{s.push(...l.marks.map(d=>({from:a,to:a+l.nodeSize,mark:d})))}),s}function so(i){return Jn(i)&&i instanceof w.qv}function Hn(i,t,n){const l=i.state.doc.content.size,a=Bt(t,0,l),d=Bt(n,0,l),h=i.coordsAtPos(a),m=i.coordsAtPos(d,-1),b=Math.min(h.top,m.top),C=Math.max(h.bottom,m.bottom),I=Math.min(h.left,m.left),D=Math.max(h.right,m.right),ue={top:b,bottom:C,left:I,right:D,width:D-I,height:C-b,x:I,y:b};return Ht(he({},ue),{toJSON:()=>ue})}function ti(i){return new M({find:i.find,handler:({state:t,range:n,match:s})=>{const l=V(i.getAttributes,void 0,s);if(!1===l||null===l)return null;const{tr:a}=t,d=s[s.length-1],h=s[0];let m=n.to;if(d){const b=h.search(/\S/),C=n.from+h.indexOf(d),I=C+d.length;if(Oi(n.from,n.to,t.doc).filter(R=>R.mark.type.excluded.find(W=>W===i.type&&W!==R.mark.type)).filter(R=>R.to>C).length)return null;I<n.to&&a.delete(I,n.to),C>n.from&&a.delete(n.from+b,C),m=n.from+b+d.length,a.addMark(n.from+b,m,i.type.create(l||{})),a.removeStoredMark(i.type)}}})}function st(i){return new M({find:i.find,handler:({state:t,range:n,match:s})=>{const l=V(i.getAttributes,void 0,s)||{},{tr:a}=t,d=n.from;let h=n.to;if(s[1]){let b=d+s[0].lastIndexOf(s[1]);b>h?b=h:h=b+s[1].length,a.insertText(s[0][s[0].length-1],d+s[0].length-1),a.replaceWith(b,h,i.type.create(l))}else s[0]&&a.replaceWith(d,h,i.type.create(l))}})}function go(i){return new M({find:i.find,handler:({state:t,range:n,match:s})=>{const l=t.doc.resolve(n.from),a=V(i.getAttributes,void 0,s)||{};if(!l.node(-1).canReplaceWith(l.index(-1),l.indexAfter(-1),i.type))return null;t.tr.delete(n.from,n.to).setBlockType(n.from,n.from,i.type,a)}})}function _o(i){return new M({find:i.find,handler:({state:t,range:n,match:s})=>{let l=i.replace,a=n.from;const d=n.to;if(s[1]){const h=s[0].lastIndexOf(s[1]);l+=s[0].slice(h+s[1].length),a+=h;const m=a-d;m>0&&(l=s[0].slice(h-m,h)+l,a=d)}t.tr.insertText(l,a,d)}})}function lo(i){return new M({find:i.find,handler:({state:t,range:n,match:s})=>{const l=V(i.getAttributes,void 0,s)||{},a=t.tr.delete(n.from,n.to),h=a.doc.resolve(n.from).blockRange(),m=h&&(0,q.nd)(h,i.type,l);if(!m)return null;a.wrap(h,m);const b=a.doc.resolve(n.from-1).nodeBefore;b&&b.type===i.type&&(0,q.Mn)(a.doc,n.from-1)&&(!i.joinPredicate||i.joinPredicate(s,b))&&a.join(n.from-1)}})}class Qe{constructor(t={}){this.type="mark",this.name="mark",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=he(he({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(N(this,"addOptions",{name:this.name}))),this.storage=V(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new Qe(t)}configure(t={}){const n=this.extend();return n.options=Nn(this.options,t),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new Qe(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=V(N(n,"addOptions",{name:n.name})),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}}class dn{constructor(t={}){this.type="node",this.name="node",this.parent=null,this.child=null,this.config={name:this.name,defaultOptions:{}},this.config=he(he({},this.config),t),this.name=this.config.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${this.name}".`),this.options=this.config.defaultOptions,this.config.addOptions&&(this.options=V(N(this,"addOptions",{name:this.name}))),this.storage=V(N(this,"addStorage",{name:this.name,options:this.options}))||{}}static create(t={}){return new dn(t)}configure(t={}){const n=this.extend();return n.options=Nn(this.options,t),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}extend(t={}){const n=new dn(t);return n.parent=this,this.child=n,n.name=t.name?t.name:n.parent.name,t.defaultOptions&&console.warn(`[tiptap warn]: BREAKING CHANGE: "defaultOptions" is deprecated. Please use "addOptions" instead. Found in extension: "${n.name}".`),n.options=V(N(n,"addOptions",{name:n.name})),n.storage=V(N(n,"addStorage",{name:n.name,options:n.options})),n}}class ao{constructor(t,n,s){this.isDragging=!1,this.component=t,this.editor=n.editor,this.options=he({stopEvent:null,ignoreMutation:null},s),this.extension=n.extension,this.node=n.node,this.decorations=n.decorations,this.getPos=n.getPos,this.mount()}mount(){}get dom(){return this.editor.view.dom}get contentDOM(){return null}onDragStart(t){var n,s,l,a,d,h,m;const{view:b}=this.editor,C=t.target,I=3===C.nodeType?null===(n=C.parentElement)||void 0===n?void 0:n.closest("[data-drag-handle]"):C.closest("[data-drag-handle]");if(!this.dom||(null===(s=this.contentDOM)||void 0===s?void 0:s.contains(C))||!I)return;let D=0,R=0;if(this.dom!==I){const Y=this.dom.getBoundingClientRect(),ue=I.getBoundingClientRect(),Ue=null!==(l=t.offsetX)&&void 0!==l?l:null===(a=t.nativeEvent)||void 0===a?void 0:a.offsetX,yt=null!==(d=t.offsetY)&&void 0!==d?d:null===(h=t.nativeEvent)||void 0===h?void 0:h.offsetY;D=ue.x-Y.x+Ue,R=ue.y-Y.y+yt}null===(m=t.dataTransfer)||void 0===m||m.setDragImage(this.dom,D,R);const H=w.qv.create(b.state.doc,this.getPos()),W=b.state.tr.setSelection(H);b.dispatch(W)}stopEvent(t){var n;if(!this.dom)return!1;if("function"==typeof this.options.stopEvent)return this.options.stopEvent({event:t});const s=t.target;if(!this.dom.contains(s)||(null===(n=this.contentDOM)||void 0===n?void 0:n.contains(s)))return!1;const a="drop"===t.type;if((["INPUT","BUTTON","SELECT","TEXTAREA"].includes(s.tagName)||s.isContentEditable)&&!a)return!0;const{isEditable:h}=this.editor,{isDragging:m}=this,b=!!this.node.type.spec.draggable,C=w.qv.isSelectable(this.node),I="copy"===t.type,D="paste"===t.type,R="cut"===t.type,H="mousedown"===t.type,W=t.type.startsWith("drag");if(!b&&C&&W&&t.preventDefault(),b&&W&&!m)return t.preventDefault(),!1;if(b&&h&&!m&&H){const Y=s.closest("[data-drag-handle]");Y&&(this.dom===Y||this.dom.contains(Y))&&(this.isDragging=!0,document.addEventListener("dragend",()=>{this.isDragging=!1},{once:!0}),document.addEventListener("mouseup",()=>{this.isDragging=!1},{once:!0}))}return!(m||a||I||D||R||H&&C)}ignoreMutation(t){return!this.dom||!this.contentDOM||("function"==typeof this.options.ignoreMutation?this.options.ignoreMutation({mutation:t}):!(!this.node.isLeaf&&!this.node.isAtom&&("selection"===t.type||this.dom.contains(t.target)&&"childList"===t.type&&wt()&&this.editor.isFocused&&[...Array.from(t.addedNodes),...Array.from(t.removedNodes)].every(s=>s.isContentEditable)||(this.contentDOM!==t.target||"attributes"!==t.type)&&this.contentDOM.contains(t.target))))}updateAttributes(t){this.editor.commands.command(({tr:n})=>{const s=this.getPos();return n.setNodeMarkup(s,void 0,he(he({},this.node.attrs),t)),!0})}deleteNode(){const t=this.getPos();this.editor.commands.deleteRange({from:t,to:t+this.node.nodeSize})}}function Ui(i){return new ge({find:i.find,handler:({state:t,range:n,match:s})=>{const l=V(i.getAttributes,void 0,s);if(!1===l||null===l)return null;const{tr:a}=t,d=s[s.length-1],h=s[0];let m=n.to;if(d){const b=h.search(/\S/),C=n.from+h.indexOf(d),I=C+d.length;if(Oi(n.from,n.to,t.doc).filter(R=>R.mark.type.excluded.find(W=>W===i.type&&W!==R.mark.type)).filter(R=>R.to>C).length)return null;I<n.to&&a.delete(I,n.to),C>n.from&&a.delete(n.from+b,C),m=n.from+b+d.length,a.addMark(n.from+b,m,i.type.create(l||{})),a.removeStoredMark(i.type)}}})}function co(i){return new ge({find:i.find,handler:({state:t,range:n,match:s})=>{let l=i.replace,a=n.from;const d=n.to;if(s[1]){const h=s[0].lastIndexOf(s[1]);l+=s[0].slice(h+s[1].length),a+=h;const m=a-d;m>0&&(l=s[0].slice(h-m,h)+l,a=d)}t.tr.insertText(l,a,d)}})}class ne{constructor(t){this.transaction=t,this.currentStep=this.transaction.steps.length}map(t){let n=!1;return{position:this.transaction.steps.slice(this.currentStep).reduce((l,a)=>{const d=a.getMap().mapResult(l);return d.deleted&&(n=!0),d.pos},t),deleted:n}}}function se(i){return i.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}},7792:(bt,Fe,A)=>{A.r(Fe),A.d(Fe,{TextStyle:()=>ye,default:()=>ye});var w=A(9220);const ye=w.Mark.create({name:"textStyle",addOptions:()=>({HTMLAttributes:{}}),parseHTML:()=>[{tag:"span",getAttrs:Ve=>!!Ve.hasAttribute("style")&&{}}],renderHTML({HTMLAttributes:Ve}){return["span",(0,w.mergeAttributes)(this.options.HTMLAttributes,Ve),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:Ve,commands:X})=>{const q=(0,w.getMarkAttributes)(Ve,this.type);return!!Object.entries(q).some(([,Oe])=>!!Oe)||X.unsetMark(this.name)}}}})},3232:(bt,Fe,A)=>{A.d(Fe,{$:()=>Ie,h:()=>Ke});for(var w={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",229:"q"},ye={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"',229:"Q"},Ve="undefined"!=typeof navigator&&/Chrome\/(\d+)/.exec(navigator.userAgent),X="undefined"!=typeof navigator&&/Apple Computer/.test(navigator.vendor),q="undefined"!=typeof navigator&&/Gecko\/\d+/.test(navigator.userAgent),Ee="undefined"!=typeof navigator&&/Mac/.test(navigator.platform),Oe="undefined"!=typeof navigator&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),be=Ve&&(Ee||+Ve[1]<57)||q&&Ee,ae=0;ae<10;ae++)w[48+ae]=w[96+ae]=String(ae);for(ae=1;ae<=24;ae++)w[ae+111]="F"+ae;for(ae=65;ae<=90;ae++)w[ae]=String.fromCharCode(ae+32),ye[ae]=String.fromCharCode(ae);for(var Te in w)ye.hasOwnProperty(Te)||(ye[Te]=w[Te]);var ve=A(6956);const ie="undefined"!=typeof navigator&&/Mac|iP(hone|[oa]d)/.test(navigator.platform);function Se(fe){let te,Xe,Ye,$e,_e=fe.split(/-(?!$)/),le=_e[_e.length-1];"Space"==le&&(le=" ");for(let Ge=0;Ge<_e.length-1;Ge++){let ze=_e[Ge];if(/^(cmd|meta|m)$/i.test(ze))$e=!0;else if(/^a(lt)?$/i.test(ze))te=!0;else if(/^(c|ctrl|control)$/i.test(ze))Xe=!0;else if(/^s(hift)?$/i.test(ze))Ye=!0;else{if(!/^mod$/i.test(ze))throw new Error("Unrecognized modifier name: "+ze);ie?$e=!0:Xe=!0}}return te&&(le="Alt-"+le),Xe&&(le="Ctrl-"+le),$e&&(le="Meta-"+le),Ye&&(le="Shift-"+le),le}function e(fe,_e,le){return _e.altKey&&(fe="Alt-"+fe),_e.ctrlKey&&(fe="Ctrl-"+fe),_e.metaKey&&(fe="Meta-"+fe),!1!==le&&_e.shiftKey&&(fe="Shift-"+fe),fe}function Ke(fe){return new ve.Sy({props:{handleKeyDown:Ie(fe)}})}function Ie(fe){let _e=function ot(fe){let _e=Object.create(null);for(let le in fe)_e[Se(le)]=fe[le];return _e}(fe);return function(le,te){let $e,Xe=function ke(fe){var le=!(be&&(fe.ctrlKey||fe.altKey||fe.metaKey)||(X||Oe)&&fe.shiftKey&&fe.key&&1==fe.key.length)&&fe.key||(fe.shiftKey?ye:w)[fe.keyCode]||fe.key||"Unidentified";return"Esc"==le&&(le="Escape"),"Del"==le&&(le="Delete"),"Left"==le&&(le="ArrowLeft"),"Up"==le&&(le="ArrowUp"),"Right"==le&&(le="ArrowRight"),"Down"==le&&(le="ArrowDown"),le}(te),Ye=1==Xe.length&&" "!=Xe,Ge=_e[e(Xe,te,!Ye)];if(Ge&&Ge(le.state,le.dispatch,le))return!0;if(Ye&&(te.shiftKey||te.altKey||te.metaKey||Xe.charCodeAt(0)>127)&&($e=w[te.keyCode])&&$e!=Xe){let ze=_e[e($e,te,!0)];if(ze&&ze(le.state,le.dispatch,le))return!0}else if(Ye&&te.shiftKey){let ze=_e[e(Xe,te,!0)];if(ze&&ze(le.state,le.dispatch,le))return!0}return!1}}},8197:(bt,Fe,A)=>{function w(k){this.content=k}A.d(Fe,{aw:()=>It,PW:()=>ee,HY:()=>q,vc:()=>ae,ZU:()=>ct,NB:()=>re,Ts:()=>Mt,e4:()=>Te,V_:()=>On,p2:()=>ke}),w.prototype={constructor:w,find:function(k){for(var c=0;c<this.content.length;c+=2)if(this.content[c]===k)return c;return-1},get:function(k){var c=this.find(k);return-1==c?void 0:this.content[c+1]},update:function(k,c,f){var g=f&&f!=k?this.remove(f):this,v=g.find(k),M=g.content.slice();return-1==v?M.push(f||k,c):(M[v+1]=c,f&&(M[v]=f)),new w(M)},remove:function(k){var c=this.find(k);if(-1==c)return this;var f=this.content.slice();return f.splice(c,2),new w(f)},addToStart:function(k,c){return new w([k,c].concat(this.remove(k).content))},addToEnd:function(k,c){var f=this.remove(k).content.slice();return f.push(k,c),new w(f)},addBefore:function(k,c,f){var g=this.remove(c),v=g.content.slice(),M=g.find(k);return v.splice(-1==M?v.length:M,0,c,f),new w(v)},forEach:function(k){for(var c=0;c<this.content.length;c+=2)k(this.content[c],this.content[c+1])},prepend:function(k){return(k=w.from(k)).size?new w(k.content.concat(this.subtract(k).content)):this},append:function(k){return(k=w.from(k)).size?new w(this.subtract(k).content.concat(k.content)):this},subtract:function(k){var c=this;k=w.from(k);for(var f=0;f<k.content.length;f+=2)c=c.remove(k.content[f]);return c},get size(){return this.content.length>>1}},w.from=function(k){if(k instanceof w)return k;var c=[];if(k)for(var f in k)c.push(f,k[f]);return new w(c)};const ye=w;function Ve(k,c,f){for(let g=0;;g++){if(g==k.childCount||g==c.childCount)return k.childCount==c.childCount?null:f;let v=k.child(g),M=c.child(g);if(v!=M){if(!v.sameMarkup(M))return f;if(v.isText&&v.text!=M.text){for(let P=0;v.text[P]==M.text[P];P++)f++;return f}if(v.content.size||M.content.size){let P=Ve(v.content,M.content,f+1);if(null!=P)return P}f+=v.nodeSize}else f+=v.nodeSize}}function X(k,c,f,g){for(let v=k.childCount,M=c.childCount;;){if(0==v||0==M)return v==M?null:{a:f,b:g};let P=k.child(--v),B=c.child(--M),J=P.nodeSize;if(P!=B){if(!P.sameMarkup(B))return{a:f,b:g};if(P.isText&&P.text!=B.text){let K=0,ge=Math.min(P.text.length,B.text.length);for(;K<ge&&P.text[P.text.length-K-1]==B.text[B.text.length-K-1];)K++,f--,g--;return{a:f,b:g}}if(P.content.size||B.content.size){let K=X(P.content,B.content,f-1,g-1);if(K)return K}f-=J,g-=J}else f-=J,g-=J}}class q{constructor(c,f){if(this.content=c,this.size=f||0,null==f)for(let g=0;g<c.length;g++)this.size+=c[g].nodeSize}nodesBetween(c,f,g,v=0,M){for(let P=0,B=0;B<f;P++){let J=this.content[P],K=B+J.nodeSize;if(K>c&&!1!==g(J,v+B,M||null,P)&&J.content.size){let ge=B+1;J.nodesBetween(Math.max(0,c-ge),Math.min(J.content.size,f-ge),g,v+ge)}B=K}}descendants(c){this.nodesBetween(0,this.size,c)}textBetween(c,f,g,v){let M="",P=!0;return this.nodesBetween(c,f,(B,J)=>{B.isText?(M+=B.text.slice(Math.max(c,J)-J,f-J),P=!g):B.isLeaf?(v?M+="function"==typeof v?v(B):v:B.type.spec.leafText&&(M+=B.type.spec.leafText(B)),P=!g):!P&&B.isBlock&&(M+=g,P=!0)},0),M}append(c){if(!c.size)return this;if(!this.size)return c;let f=this.lastChild,g=c.firstChild,v=this.content.slice(),M=0;for(f.isText&&f.sameMarkup(g)&&(v[v.length-1]=f.withText(f.text+g.text),M=1);M<c.content.length;M++)v.push(c.content[M]);return new q(v,this.size+c.size)}cut(c,f=this.size){if(0==c&&f==this.size)return this;let g=[],v=0;if(f>c)for(let M=0,P=0;P<f;M++){let B=this.content[M],J=P+B.nodeSize;J>c&&((P<c||J>f)&&(B=B.isText?B.cut(Math.max(0,c-P),Math.min(B.text.length,f-P)):B.cut(Math.max(0,c-P-1),Math.min(B.content.size,f-P-1))),g.push(B),v+=B.nodeSize),P=J}return new q(g,v)}cutByIndex(c,f){return c==f?q.empty:0==c&&f==this.content.length?this:new q(this.content.slice(c,f))}replaceChild(c,f){let g=this.content[c];if(g==f)return this;let v=this.content.slice(),M=this.size+f.nodeSize-g.nodeSize;return v[c]=f,new q(v,M)}addToStart(c){return new q([c].concat(this.content),this.size+c.nodeSize)}addToEnd(c){return new q(this.content.concat(c),this.size+c.nodeSize)}eq(c){if(this.content.length!=c.content.length)return!1;for(let f=0;f<this.content.length;f++)if(!this.content[f].eq(c.content[f]))return!1;return!0}get firstChild(){return this.content.length?this.content[0]:null}get lastChild(){return this.content.length?this.content[this.content.length-1]:null}get childCount(){return this.content.length}child(c){let f=this.content[c];if(!f)throw new RangeError("Index "+c+" out of range for "+this);return f}maybeChild(c){return this.content[c]||null}forEach(c){for(let f=0,g=0;f<this.content.length;f++){let v=this.content[f];c(v,g,f),g+=v.nodeSize}}findDiffStart(c,f=0){return Ve(this,c,f)}findDiffEnd(c,f=this.size,g=c.size){return X(this,c,f,g)}findIndex(c,f=-1){if(0==c)return Oe(0,c);if(c==this.size)return Oe(this.content.length,c);if(c>this.size||c<0)throw new RangeError(`Position ${c} outside of fragment (${this})`);for(let g=0,v=0;;g++){let P=v+this.child(g).nodeSize;if(P>=c)return P==c||f>0?Oe(g+1,P):Oe(g,v);v=P}}toString(){return"<"+this.toStringInner()+">"}toStringInner(){return this.content.join(", ")}toJSON(){return this.content.length?this.content.map(c=>c.toJSON()):null}static fromJSON(c,f){if(!f)return q.empty;if(!Array.isArray(f))throw new RangeError("Invalid input for Fragment.fromJSON");return new q(f.map(c.nodeFromJSON))}static fromArray(c){if(!c.length)return q.empty;let f,g=0;for(let v=0;v<c.length;v++){let M=c[v];g+=M.nodeSize,v&&M.isText&&c[v-1].sameMarkup(M)?(f||(f=c.slice(0,v)),f[f.length-1]=M.withText(f[f.length-1].text+M.text)):f&&f.push(M)}return new q(f||c,g)}static from(c){if(!c)return q.empty;if(c instanceof q)return c;if(Array.isArray(c))return this.fromArray(c);if(c.attrs)return new q([c],c.nodeSize);throw new RangeError("Can not convert "+c+" to a Fragment"+(c.nodesBetween?" (looks like multiple versions of prosemirror-model were loaded)":""))}}q.empty=new q([],0);const Ee={index:0,offset:0};function Oe(k,c){return Ee.index=k,Ee.offset=c,Ee}function be(k,c){if(k===c)return!0;if(!k||"object"!=typeof k||!c||"object"!=typeof c)return!1;let f=Array.isArray(k);if(Array.isArray(c)!=f)return!1;if(f){if(k.length!=c.length)return!1;for(let g=0;g<k.length;g++)if(!be(k[g],c[g]))return!1}else{for(let g in k)if(!(g in c)||!be(k[g],c[g]))return!1;for(let g in c)if(!(g in k))return!1}return!0}let ae=(()=>{class k{constructor(f,g){this.type=f,this.attrs=g}addToSet(f){let g,v=!1;for(let M=0;M<f.length;M++){let P=f[M];if(this.eq(P))return f;if(this.type.excludes(P.type))g||(g=f.slice(0,M));else{if(P.type.excludes(this.type))return f;!v&&P.type.rank>this.type.rank&&(g||(g=f.slice(0,M)),g.push(this),v=!0),g&&g.push(P)}}return g||(g=f.slice()),v||g.push(this),g}removeFromSet(f){for(let g=0;g<f.length;g++)if(this.eq(f[g]))return f.slice(0,g).concat(f.slice(g+1));return f}isInSet(f){for(let g=0;g<f.length;g++)if(this.eq(f[g]))return!0;return!1}eq(f){return this==f||this.type==f.type&&be(this.attrs,f.attrs)}toJSON(){let f={type:this.type.name};for(let g in this.attrs){f.attrs=this.attrs;break}return f}static fromJSON(f,g){if(!g)throw new RangeError("Invalid input for Mark.fromJSON");let v=f.marks[g.type];if(!v)throw new RangeError(`There is no mark type ${g.type} in this schema`);return v.create(g.attrs)}static sameSet(f,g){if(f==g)return!0;if(f.length!=g.length)return!1;for(let v=0;v<f.length;v++)if(!f[v].eq(g[v]))return!1;return!0}static setFrom(f){if(!f||Array.isArray(f)&&0==f.length)return k.none;if(f instanceof k)return[f];let g=f.slice();return g.sort((v,M)=>v.type.rank-M.type.rank),g}}return k.none=[],k})();class Te extends Error{}class ke{constructor(c,f,g){this.content=c,this.openStart=f,this.openEnd=g}get size(){return this.content.size-this.openStart-this.openEnd}insertAt(c,f){let g=ie(this.content,c+this.openStart,f);return g&&new ke(g,this.openStart,this.openEnd)}removeBetween(c,f){return new ke(ve(this.content,c+this.openStart,f+this.openStart),this.openStart,this.openEnd)}eq(c){return this.content.eq(c.content)&&this.openStart==c.openStart&&this.openEnd==c.openEnd}toString(){return this.content+"("+this.openStart+","+this.openEnd+")"}toJSON(){if(!this.content.size)return null;let c={content:this.content.toJSON()};return this.openStart>0&&(c.openStart=this.openStart),this.openEnd>0&&(c.openEnd=this.openEnd),c}static fromJSON(c,f){if(!f)return ke.empty;let g=f.openStart||0,v=f.openEnd||0;if("number"!=typeof g||"number"!=typeof v)throw new RangeError("Invalid input for Slice.fromJSON");return new ke(q.fromJSON(c,f.content),g,v)}static maxOpen(c,f=!0){let g=0,v=0;for(let M=c.firstChild;M&&!M.isLeaf&&(f||!M.type.spec.isolating);M=M.firstChild)g++;for(let M=c.lastChild;M&&!M.isLeaf&&(f||!M.type.spec.isolating);M=M.lastChild)v++;return new ke(c,g,v)}}function ve(k,c,f){let{index:g,offset:v}=k.findIndex(c),M=k.maybeChild(g),{index:P,offset:B}=k.findIndex(f);if(v==c||M.isText){if(B!=f&&!k.child(P).isText)throw new RangeError("Removing non-flat range");return k.cut(0,c).append(k.cut(f))}if(g!=P)throw new RangeError("Removing non-flat range");return k.replaceChild(g,M.copy(ve(M.content,c-v-1,f-v-1)))}function ie(k,c,f,g){let{index:v,offset:M}=k.findIndex(c),P=k.maybeChild(v);if(M==c||P.isText)return g&&!g.canReplace(v,v,f)?null:k.cut(0,c).append(f).append(k.cut(c));let B=ie(P.content,c-M-1,f);return B&&k.replaceChild(v,P.copy(B))}function Se(k,c,f){if(f.openStart>k.depth)throw new Te("Inserted content deeper than insertion position");if(k.depth-f.openStart!=c.depth-f.openEnd)throw new Te("Inconsistent open depths");return ot(k,c,f,0)}function ot(k,c,f,g){let v=k.index(g),M=k.node(g);if(v==c.index(g)&&g<k.depth-f.openStart){let P=ot(k,c,f,g+1);return M.copy(M.content.replaceChild(v,P))}if(f.content.size){if(f.openStart||f.openEnd||k.depth!=g||c.depth!=g){let{start:P,end:B}=function Xe(k,c){let f=c.depth-k.openStart,v=c.node(f).copy(k.content);for(let M=f-1;M>=0;M--)v=c.node(M).copy(q.from(v));return{start:v.resolveNoCache(k.openStart+f),end:v.resolveNoCache(v.content.size-k.openEnd-f)}}(f,k);return _e(M,le(k,P,B,c,g))}{let P=k.parent,B=P.content;return _e(P,B.cut(0,k.parentOffset).append(f.content).append(B.cut(c.parentOffset)))}}return _e(M,te(k,c,g))}function e(k,c){if(!c.type.compatibleContent(k.type))throw new Te("Cannot join "+c.type.name+" onto "+k.type.name)}function Ke(k,c,f){let g=k.node(f);return e(g,c.node(f)),g}function Ie(k,c){let f=c.length-1;f>=0&&k.isText&&k.sameMarkup(c[f])?c[f]=k.withText(c[f].text+k.text):c.push(k)}function fe(k,c,f,g){let v=(c||k).node(f),M=0,P=c?c.index(f):v.childCount;k&&(M=k.index(f),k.depth>f?M++:k.textOffset&&(Ie(k.nodeAfter,g),M++));for(let B=M;B<P;B++)Ie(v.child(B),g);c&&c.depth==f&&c.textOffset&&Ie(c.nodeBefore,g)}function _e(k,c){if(!k.type.validContent(c))throw new Te("Invalid content for node "+k.type.name);return k.copy(c)}function le(k,c,f,g,v){let M=k.depth>v&&Ke(k,c,v+1),P=g.depth>v&&Ke(f,g,v+1),B=[];return fe(null,k,v,B),M&&P&&c.index(v)==f.index(v)?(e(M,P),Ie(_e(M,le(k,c,f,g,v+1)),B)):(M&&Ie(_e(M,te(k,c,v+1)),B),fe(c,f,v,B),P&&Ie(_e(P,te(f,g,v+1)),B)),fe(g,null,v,B),new q(B)}function te(k,c,f){let g=[];return fe(null,k,f,g),k.depth>f&&Ie(_e(Ke(k,c,f+1),te(k,c,f+1)),g),fe(c,null,f,g),new q(g)}ke.empty=new ke(q.empty,0,0);class Ye{constructor(c,f,g){this.pos=c,this.path=f,this.parentOffset=g,this.depth=f.length/3-1}resolveDepth(c){return null==c?this.depth:c<0?this.depth+c:c}get parent(){return this.node(this.depth)}get doc(){return this.node(0)}node(c){return this.path[3*this.resolveDepth(c)]}index(c){return this.path[3*this.resolveDepth(c)+1]}indexAfter(c){return c=this.resolveDepth(c),this.index(c)+(c!=this.depth||this.textOffset?1:0)}start(c){return 0==(c=this.resolveDepth(c))?0:this.path[3*c-1]+1}end(c){return c=this.resolveDepth(c),this.start(c)+this.node(c).content.size}before(c){if(!(c=this.resolveDepth(c)))throw new RangeError("There is no position before the top-level node");return c==this.depth+1?this.pos:this.path[3*c-1]}after(c){if(!(c=this.resolveDepth(c)))throw new RangeError("There is no position after the top-level node");return c==this.depth+1?this.pos:this.path[3*c-1]+this.path[3*c].nodeSize}get textOffset(){return this.pos-this.path[this.path.length-1]}get nodeAfter(){let c=this.parent,f=this.index(this.depth);if(f==c.childCount)return null;let g=this.pos-this.path[this.path.length-1],v=c.child(f);return g?c.child(f).cut(g):v}get nodeBefore(){let c=this.index(this.depth),f=this.pos-this.path[this.path.length-1];return f?this.parent.child(c).cut(0,f):0==c?null:this.parent.child(c-1)}posAtIndex(c,f){f=this.resolveDepth(f);let g=this.path[3*f],v=0==f?0:this.path[3*f-1]+1;for(let M=0;M<c;M++)v+=g.child(M).nodeSize;return v}marks(){let c=this.parent,f=this.index();if(0==c.content.size)return ae.none;if(this.textOffset)return c.child(f).marks;let g=c.maybeChild(f-1),v=c.maybeChild(f);if(!g){let B=g;g=v,v=B}let M=g.marks;for(var P=0;P<M.length;P++)!1===M[P].type.spec.inclusive&&(!v||!M[P].isInSet(v.marks))&&(M=M[P--].removeFromSet(M));return M}marksAcross(c){let f=this.parent.maybeChild(this.index());if(!f||!f.isInline)return null;let g=f.marks,v=c.parent.maybeChild(c.index());for(var M=0;M<g.length;M++)!1===g[M].type.spec.inclusive&&(!v||!g[M].isInSet(v.marks))&&(g=g[M--].removeFromSet(g));return g}sharedDepth(c){for(let f=this.depth;f>0;f--)if(this.start(f)<=c&&this.end(f)>=c)return f;return 0}blockRange(c=this,f){if(c.pos<this.pos)return c.blockRange(this);for(let g=this.depth-(this.parent.inlineContent||this.pos==c.pos?1:0);g>=0;g--)if(c.pos<=this.end(g)&&(!f||f(this.node(g))))return new Mt(this,c,g);return null}sameParent(c){return this.pos-this.parentOffset==c.pos-c.parentOffset}max(c){return c.pos>this.pos?c:this}min(c){return c.pos<this.pos?c:this}toString(){let c="";for(let f=1;f<=this.depth;f++)c+=(c?"/":"")+this.node(f).type.name+"_"+this.index(f-1);return c+":"+this.parentOffset}static resolve(c,f){if(!(f>=0&&f<=c.content.size))throw new RangeError("Position "+f+" out of range");let g=[],v=0,M=f;for(let P=c;;){let{index:B,offset:J}=P.content.findIndex(M),K=M-J;if(g.push(P,B,v+J),!K||(P=P.child(B),P.isText))break;M=K-1,v+=J+1}return new Ye(f,g,M)}static resolveCached(c,f){for(let v=0;v<$e.length;v++){let M=$e[v];if(M.pos==f&&M.doc==c)return M}let g=$e[Ge]=Ye.resolve(c,f);return Ge=(Ge+1)%ze,g}}let $e=[],Ge=0,ze=12;class Mt{constructor(c,f,g){this.$from=c,this.$to=f,this.depth=g}get start(){return this.$from.before(this.depth+1)}get end(){return this.$to.after(this.depth+1)}get parent(){return this.$from.node(this.depth)}get startIndex(){return this.$from.index(this.depth)}get endIndex(){return this.$to.indexAfter(this.depth)}}const Me=Object.create(null);class re{constructor(c,f,g,v=ae.none){this.type=c,this.attrs=f,this.marks=v,this.content=g||q.empty}get nodeSize(){return this.isLeaf?1:2+this.content.size}get childCount(){return this.content.childCount}child(c){return this.content.child(c)}maybeChild(c){return this.content.maybeChild(c)}forEach(c){this.content.forEach(c)}nodesBetween(c,f,g,v=0){this.content.nodesBetween(c,f,g,v,this)}descendants(c){this.nodesBetween(0,this.content.size,c)}get textContent(){return this.isLeaf&&this.type.spec.leafText?this.type.spec.leafText(this):this.textBetween(0,this.content.size,"")}textBetween(c,f,g,v){return this.content.textBetween(c,f,g,v)}get firstChild(){return this.content.firstChild}get lastChild(){return this.content.lastChild}eq(c){return this==c||this.sameMarkup(c)&&this.content.eq(c.content)}sameMarkup(c){return this.hasMarkup(c.type,c.attrs,c.marks)}hasMarkup(c,f,g){return this.type==c&&be(this.attrs,f||c.defaultAttrs||Me)&&ae.sameSet(this.marks,g||ae.none)}copy(c=null){return c==this.content?this:new re(this.type,this.attrs,c,this.marks)}mark(c){return c==this.marks?this:new re(this.type,this.attrs,this.content,c)}cut(c,f=this.content.size){return 0==c&&f==this.content.size?this:this.copy(this.content.cut(c,f))}slice(c,f=this.content.size,g=!1){if(c==f)return ke.empty;let v=this.resolve(c),M=this.resolve(f),P=g?0:v.sharedDepth(f),B=v.start(P),K=v.node(P).content.cut(v.pos-B,M.pos-B);return new ke(K,v.depth-P,M.depth-P)}replace(c,f,g){return Se(this.resolve(c),this.resolve(f),g)}nodeAt(c){for(let f=this;;){let{index:g,offset:v}=f.content.findIndex(c);if(f=f.maybeChild(g),!f)return null;if(v==c||f.isText)return f;c-=v+1}}childAfter(c){let{index:f,offset:g}=this.content.findIndex(c);return{node:this.content.maybeChild(f),index:f,offset:g}}childBefore(c){if(0==c)return{node:null,index:0,offset:0};let{index:f,offset:g}=this.content.findIndex(c);if(g<c)return{node:this.content.child(f),index:f,offset:g};let v=this.content.child(f-1);return{node:v,index:f-1,offset:g-v.nodeSize}}resolve(c){return Ye.resolveCached(this,c)}resolveNoCache(c){return Ye.resolve(this,c)}rangeHasMark(c,f,g){let v=!1;return f>c&&this.nodesBetween(c,f,M=>(g.isInSet(M.marks)&&(v=!0),!v)),v}get isBlock(){return this.type.isBlock}get isTextblock(){return this.type.isTextblock}get inlineContent(){return this.type.inlineContent}get isInline(){return this.type.isInline}get isText(){return this.type.isText}get isLeaf(){return this.type.isLeaf}get isAtom(){return this.type.isAtom}toString(){if(this.type.spec.toDebugString)return this.type.spec.toDebugString(this);let c=this.type.name;return this.content.size&&(c+="("+this.content.toStringInner()+")"),L(this.marks,c)}contentMatchAt(c){let f=this.type.contentMatch.matchFragment(this.content,0,c);if(!f)throw new Error("Called contentMatchAt on a node with invalid content");return f}canReplace(c,f,g=q.empty,v=0,M=g.childCount){let P=this.contentMatchAt(c).matchFragment(g,v,M),B=P&&P.matchFragment(this.content,f);if(!B||!B.validEnd)return!1;for(let J=v;J<M;J++)if(!this.type.allowsMarks(g.child(J).marks))return!1;return!0}canReplaceWith(c,f,g,v){if(v&&!this.type.allowsMarks(v))return!1;let M=this.contentMatchAt(c).matchType(g),P=M&&M.matchFragment(this.content,f);return!!P&&P.validEnd}canAppend(c){return c.content.size?this.canReplace(this.childCount,this.childCount,c.content):this.type.compatibleContent(c.type)}check(){if(!this.type.validContent(this.content))throw new RangeError(`Invalid content for node ${this.type.name}: ${this.content.toString().slice(0,50)}`);let c=ae.none;for(let f=0;f<this.marks.length;f++)c=this.marks[f].addToSet(c);if(!ae.sameSet(c,this.marks))throw new RangeError(`Invalid collection of marks for node ${this.type.name}: ${this.marks.map(f=>f.type.name)}`);this.content.forEach(f=>f.check())}toJSON(){let c={type:this.type.name};for(let f in this.attrs){c.attrs=this.attrs;break}return this.content.size&&(c.content=this.content.toJSON()),this.marks.length&&(c.marks=this.marks.map(f=>f.toJSON())),c}static fromJSON(c,f){if(!f)throw new RangeError("Invalid input for Node.fromJSON");let g=null;if(f.marks){if(!Array.isArray(f.marks))throw new RangeError("Invalid mark data for Node.fromJSON");g=f.marks.map(c.markFromJSON)}if("text"==f.type){if("string"!=typeof f.text)throw new RangeError("Invalid text node in JSON");return c.text(f.text,g)}let v=q.fromJSON(c,f.content);return c.nodeType(f.type).create(f.attrs,v,g)}}re.prototype.text=void 0;class O extends re{constructor(c,f,g,v){if(super(c,f,null,v),!g)throw new RangeError("Empty text nodes are not allowed");this.text=g}toString(){return this.type.spec.toDebugString?this.type.spec.toDebugString(this):L(this.marks,JSON.stringify(this.text))}get textContent(){return this.text}textBetween(c,f){return this.text.slice(c,f)}get nodeSize(){return this.text.length}mark(c){return c==this.marks?this:new O(this.type,this.attrs,this.text,c)}withText(c){return c==this.text?this:new O(this.type,this.attrs,c,this.marks)}cut(c=0,f=this.text.length){return 0==c&&f==this.text.length?this:this.withText(this.text.slice(c,f))}eq(c){return this.sameMarkup(c)&&this.text==c.text}toJSON(){let c=super.toJSON();return c.text=this.text,c}}function L(k,c){for(let f=k.length-1;f>=0;f--)c=k[f].type.name+"("+c+")";return c}class ${constructor(c){this.validEnd=c,this.next=[],this.wrapCache=[]}static parse(c,f){let g=new Q(c,f);if(null==g.next)return $.empty;let v=oe(g);g.next&&g.err("Unexpected trailing text");let M=function mn(k){let c=Object.create(null);return function f(g){let v=[];g.forEach(P=>{k[P].forEach(({term:B,to:J})=>{if(!B)return;let K;for(let ge=0;ge<v.length;ge++)v[ge][0]==B&&(K=v[ge][1]);hn(k,J).forEach(ge=>{K||v.push([B,K=[]]),-1==K.indexOf(ge)&&K.push(ge)})})});let M=c[g.join(",")]=new $(g.indexOf(k.length-1)>-1);for(let P=0;P<v.length;P++){let B=v[P][1].sort(wn);M.next.push({type:v[P][0],next:c[B.join(",")]||f(B)})}return M}(hn(k,0))}(function jt(k){let c=[[]];return v(function M(P,B){if("choice"==P.type)return P.exprs.reduce((J,K)=>J.concat(M(K,B)),[]);if("seq"!=P.type){if("star"==P.type){let J=f();return g(B,J),v(M(P.expr,J),J),[g(J)]}if("plus"==P.type){let J=f();return v(M(P.expr,B),J),v(M(P.expr,J),J),[g(J)]}if("opt"==P.type)return[g(B)].concat(M(P.expr,B));if("range"==P.type){let J=B;for(let K=0;K<P.min;K++){let ge=f();v(M(P.expr,J),ge),J=ge}if(-1==P.max)v(M(P.expr,J),J);else for(let K=P.min;K<P.max;K++){let ge=f();g(J,ge),v(M(P.expr,J),ge),J=ge}return[g(J)]}if("name"==P.type)return[g(B,void 0,P.value)];throw new Error("Unknown expr type")}for(let J=0;;J++){let K=M(P.exprs[J],B);if(J==P.exprs.length-1)return K;v(K,B=f())}}(k,0),f()),c;function f(){return c.push([])-1}function g(P,B,J){let K={term:J,to:B};return c[P].push(K),K}function v(P,B){P.forEach(J=>J.to=B)}}(v));return function on(k,c){for(let f=0,g=[k];f<g.length;f++){let v=g[f],M=!v.validEnd,P=[];for(let B=0;B<v.next.length;B++){let{type:J,next:K}=v.next[B];P.push(J.name),M&&!(J.isText||J.hasRequiredAttrs())&&(M=!1),-1==g.indexOf(K)&&g.push(K)}M&&c.err("Only non-generatable nodes ("+P.join(", ")+") in a required position (see https://prosemirror.net/docs/guide/#generatable)")}}(M,g),M}matchType(c){for(let f=0;f<this.next.length;f++)if(this.next[f].type==c)return this.next[f].next;return null}matchFragment(c,f=0,g=c.childCount){let v=this;for(let M=f;v&&M<g;M++)v=v.matchType(c.child(M).type);return v}get inlineContent(){return this.next.length&&this.next[0].type.isInline}get defaultType(){for(let c=0;c<this.next.length;c++){let{type:f}=this.next[c];if(!f.isText&&!f.hasRequiredAttrs())return f}return null}compatible(c){for(let f=0;f<this.next.length;f++)for(let g=0;g<c.next.length;g++)if(this.next[f].type==c.next[g].type)return!0;return!1}fillBefore(c,f=!1,g=0){let v=[this];return function M(P,B){let J=P.matchFragment(c,g);if(J&&(!f||J.validEnd))return q.from(B.map(K=>K.createAndFill()));for(let K=0;K<P.next.length;K++){let{type:ge,next:_t}=P.next[K];if(!ge.isText&&!ge.hasRequiredAttrs()&&-1==v.indexOf(_t)){v.push(_t);let rn=M(_t,B.concat(ge));if(rn)return rn}}return null}(this,[])}findWrapping(c){for(let g=0;g<this.wrapCache.length;g+=2)if(this.wrapCache[g]==c)return this.wrapCache[g+1];let f=this.computeWrapping(c);return this.wrapCache.push(c,f),f}computeWrapping(c){let f=Object.create(null),g=[{match:this,type:null,via:null}];for(;g.length;){let v=g.shift(),M=v.match;if(M.matchType(c)){let P=[];for(let B=v;B.type;B=B.via)P.push(B.type);return P.reverse()}for(let P=0;P<M.next.length;P++){let{type:B,next:J}=M.next[P];!B.isLeaf&&!B.hasRequiredAttrs()&&!(B.name in f)&&(!v.type||J.validEnd)&&(g.push({match:B.contentMatch,type:B,via:v}),f[B.name]=!0)}}return null}get edgeCount(){return this.next.length}edge(c){if(c>=this.next.length)throw new RangeError(`There's no ${c}th edge in this content match`);return this.next[c]}toString(){let c=[];return function f(g){c.push(g);for(let v=0;v<g.next.length;v++)-1==c.indexOf(g.next[v].next)&&f(g.next[v].next)}(this),c.map((g,v)=>{let M=v+(g.validEnd?"*":" ")+" ";for(let P=0;P<g.next.length;P++)M+=(P?", ":"")+g.next[P].type.name+"->"+c.indexOf(g.next[P].next);return M}).join("\n")}}$.empty=new $(!0);class Q{constructor(c,f){this.string=c,this.nodeTypes=f,this.inline=null,this.pos=0,this.tokens=c.split(/\s*(?=\b|\W|$)/),""==this.tokens[this.tokens.length-1]&&this.tokens.pop(),""==this.tokens[0]&&this.tokens.shift()}get next(){return this.tokens[this.pos]}eat(c){return this.next==c&&(this.pos++||!0)}err(c){throw new SyntaxError(c+" (in content expression '"+this.string+"')")}}function oe(k){let c=[];do{c.push(xe(k))}while(k.eat("|"));return 1==c.length?c[0]:{type:"choice",exprs:c}}function xe(k){let c=[];do{c.push(De(k))}while(k.next&&")"!=k.next&&"|"!=k.next);return 1==c.length?c[0]:{type:"seq",exprs:c}}function De(k){let c=function Yt(k){if(k.eat("(")){let c=oe(k);return k.eat(")")||k.err("Missing closing paren"),c}if(!/\W/.test(k.next)){let c=function Le(k,c){let f=k.nodeTypes,g=f[c];if(g)return[g];let v=[];for(let M in f){let P=f[M];P.groups.indexOf(c)>-1&&v.push(P)}return 0==v.length&&k.err("No node type or group '"+c+"' found"),v}(k,k.next).map(f=>(null==k.inline?k.inline=f.isInline:k.inline!=f.isInline&&k.err("Mixing inline and block content"),{type:"name",value:f}));return k.pos++,1==c.length?c[0]:{type:"choice",exprs:c}}k.err("Unexpected token '"+k.next+"'")}(k);for(;;)if(k.eat("+"))c={type:"plus",expr:c};else if(k.eat("*"))c={type:"star",expr:c};else if(k.eat("?"))c={type:"opt",expr:c};else{if(!k.eat("{"))break;c=rt(k,c)}return c}function We(k){/\D/.test(k.next)&&k.err("Expected number, got '"+k.next+"'");let c=Number(k.next);return k.pos++,c}function rt(k,c){let f=We(k),g=f;return k.eat(",")&&(g="}"!=k.next?We(k):-1),k.eat("}")||k.err("Unclosed braced range"),{type:"range",min:f,max:g,expr:c}}function wn(k,c){return c-k}function hn(k,c){let f=[];return function g(v){let M=k[v];if(1==M.length&&!M[0].term)return g(M[0].to);f.push(v);for(let P=0;P<M.length;P++){let{term:B,to:J}=M[P];!B&&-1==f.indexOf(J)&&g(J)}}(c),f.sort(wn)}function gn(k){let c=Object.create(null);for(let f in k){let g=k[f];if(!g.hasDefault)return null;c[f]=g.default}return c}function Vt(k,c){let f=Object.create(null);for(let g in k){let v=c&&c[g];if(void 0===v){let M=k[g];if(!M.hasDefault)throw new RangeError("No value supplied for attribute "+g);v=M.default}f[g]=v}return f}function At(k){let c=Object.create(null);if(k)for(let f in k)c[f]=new In(k[f]);return c}class St{constructor(c,f,g){this.name=c,this.schema=f,this.spec=g,this.markSet=null,this.groups=g.group?g.group.split(" "):[],this.attrs=At(g.attrs),this.defaultAttrs=gn(this.attrs),this.contentMatch=null,this.inlineContent=null,this.isBlock=!(g.inline||"text"==c),this.isText="text"==c}get isInline(){return!this.isBlock}get isTextblock(){return this.isBlock&&this.inlineContent}get isLeaf(){return this.contentMatch==$.empty}get isAtom(){return this.isLeaf||!!this.spec.atom}get whitespace(){return this.spec.whitespace||(this.spec.code?"pre":"normal")}hasRequiredAttrs(){for(let c in this.attrs)if(this.attrs[c].isRequired)return!0;return!1}compatibleContent(c){return this==c||this.contentMatch.compatible(c.contentMatch)}computeAttrs(c){return!c&&this.defaultAttrs?this.defaultAttrs:Vt(this.attrs,c)}create(c=null,f,g){if(this.isText)throw new Error("NodeType.create can't construct text nodes");return new re(this,this.computeAttrs(c),q.from(f),ae.setFrom(g))}createChecked(c=null,f,g){if(f=q.from(f),!this.validContent(f))throw new RangeError("Invalid content for node "+this.name);return new re(this,this.computeAttrs(c),f,ae.setFrom(g))}createAndFill(c=null,f,g){if(c=this.computeAttrs(c),(f=q.from(f)).size){let P=this.contentMatch.fillBefore(f);if(!P)return null;f=P.append(f)}let v=this.contentMatch.matchFragment(f),M=v&&v.fillBefore(q.empty,!0);return M?new re(this,c,f.append(M),ae.setFrom(g)):null}validContent(c){let f=this.contentMatch.matchFragment(c);if(!f||!f.validEnd)return!1;for(let g=0;g<c.childCount;g++)if(!this.allowsMarks(c.child(g).marks))return!1;return!0}allowsMarkType(c){return null==this.markSet||this.markSet.indexOf(c)>-1}allowsMarks(c){if(null==this.markSet)return!0;for(let f=0;f<c.length;f++)if(!this.allowsMarkType(c[f].type))return!1;return!0}allowedMarks(c){if(null==this.markSet)return c;let f;for(let g=0;g<c.length;g++)this.allowsMarkType(c[g].type)?f&&f.push(c[g]):f||(f=c.slice(0,g));return f?f.length?f:ae.none:c}static compile(c,f){let g=Object.create(null);c.forEach((M,P)=>g[M]=new St(M,f,P));let v=f.spec.topNode||"doc";if(!g[v])throw new RangeError("Schema is missing its top node type ('"+v+"')");if(!g.text)throw new RangeError("Every schema needs a 'text' type");for(let M in g.text.attrs)throw new RangeError("The text node type should not have attributes");return g}}class In{constructor(c){this.hasDefault=Object.prototype.hasOwnProperty.call(c,"default"),this.default=c.default}get isRequired(){return!this.hasDefault}}class ct{constructor(c,f,g,v){this.name=c,this.rank=f,this.schema=g,this.spec=v,this.attrs=At(v.attrs),this.excluded=null;let M=gn(this.attrs);this.instance=M?new ae(this,M):null}create(c=null){return!c&&this.instance?this.instance:new ae(this,Vt(this.attrs,c))}static compile(c,f){let g=Object.create(null),v=0;return c.forEach((M,P)=>g[M]=new ct(M,v++,f,P)),g}removeFromSet(c){for(var f=0;f<c.length;f++)c[f].type==this&&(c=c.slice(0,f).concat(c.slice(f+1)),f--);return c}isInSet(c){for(let f=0;f<c.length;f++)if(c[f].type==this)return c[f]}excludes(c){return this.excluded.indexOf(c)>-1}}class On{constructor(c){this.cached=Object.create(null),this.spec={nodes:ye.from(c.nodes),marks:ye.from(c.marks||{}),topNode:c.topNode},this.nodes=St.compile(this.spec.nodes,this),this.marks=ct.compile(this.spec.marks,this);let f=Object.create(null);for(let g in this.nodes){if(g in this.marks)throw new RangeError(g+" can not be both a node and a mark");let v=this.nodes[g],M=v.spec.content||"",P=v.spec.marks;v.contentMatch=f[M]||(f[M]=$.parse(M,this.nodes)),v.inlineContent=v.contentMatch.inlineContent,v.markSet="_"==P?null:P?Dn(this,P.split(" ")):""!=P&&v.inlineContent?null:[]}for(let g in this.marks){let v=this.marks[g],M=v.spec.excludes;v.excluded=null==M?[v]:""==M?[]:Dn(this,M.split(" "))}this.nodeFromJSON=this.nodeFromJSON.bind(this),this.markFromJSON=this.markFromJSON.bind(this),this.topNodeType=this.nodes[this.spec.topNode||"doc"],this.cached.wrappings=Object.create(null)}node(c,f=null,g,v){if("string"==typeof c)c=this.nodeType(c);else{if(!(c instanceof St))throw new RangeError("Invalid node type: "+c);if(c.schema!=this)throw new RangeError("Node type from different schema used ("+c.name+")")}return c.createChecked(f,g,v)}text(c,f){let g=this.nodes.text;return new O(g,g.defaultAttrs,c,ae.setFrom(f))}mark(c,f){return"string"==typeof c&&(c=this.marks[c]),c.create(f)}nodeFromJSON(c){return re.fromJSON(this,c)}markFromJSON(c){return ae.fromJSON(this,c)}nodeType(c){let f=this.nodes[c];if(!f)throw new RangeError("Unknown node type: "+c);return f}}function Dn(k,c){let f=[];for(let g=0;g<c.length;g++){let v=c[g],M=k.marks[v],P=M;if(M)f.push(M);else for(let B in k.marks){let J=k.marks[B];("_"==v||J.spec.group&&J.spec.group.split(" ").indexOf(v)>-1)&&f.push(P=J)}if(!P)throw new SyntaxError("Unknown mark type: '"+c[g]+"'")}return f}class It{constructor(c,f){this.schema=c,this.rules=f,this.tags=[],this.styles=[],f.forEach(g=>{g.tag?this.tags.push(g):g.style&&this.styles.push(g)}),this.normalizeLists=!this.tags.some(g=>{if(!/^(ul|ol)\b/.test(g.tag)||!g.node)return!1;let v=c.nodes[g.node];return v.contentMatch.matchType(v)})}parse(c,f={}){let g=new x(this,f,!1);return g.addAll(c,f.from,f.to),g.finish()}parseSlice(c,f={}){let g=new x(this,f,!0);return g.addAll(c,f.from,f.to),ke.maxOpen(g.finish())}matchTag(c,f,g){for(let v=g?this.tags.indexOf(g)+1:0;v<this.tags.length;v++){let M=this.tags[v];if(E(c,M.tag)&&(void 0===M.namespace||c.namespaceURI==M.namespace)&&(!M.context||f.matchesContext(M.context))){if(M.getAttrs){let P=M.getAttrs(c);if(!1===P)continue;M.attrs=P||void 0}return M}}}matchStyle(c,f,g,v){for(let M=v?this.styles.indexOf(v)+1:0;M<this.styles.length;M++){let P=this.styles[M],B=P.style;if(!(0!=B.indexOf(c)||P.context&&!g.matchesContext(P.context)||B.length>c.length&&(61!=B.charCodeAt(c.length)||B.slice(c.length+1)!=f))){if(P.getAttrs){let J=P.getAttrs(f);if(!1===J)continue;P.attrs=J||void 0}return P}}}static schemaRules(c){let f=[];function g(v){let M=null==v.priority?50:v.priority,P=0;for(;P<f.length;P++){let B=f[P];if((null==B.priority?50:B.priority)<M)break}f.splice(P,0,v)}for(let v in c.marks){let M=c.marks[v].spec.parseDOM;M&&M.forEach(P=>{g(P=z(P)),P.mark=v})}for(let v in c.nodes){let M=c.nodes[v].spec.parseDOM;M&&M.forEach(P=>{g(P=z(P)),P.node=v})}return f}static fromSchema(c){return c.cached.domParser||(c.cached.domParser=new It(c,It.schemaRules(c)))}}const Gt={address:!0,article:!0,aside:!0,blockquote:!0,canvas:!0,dd:!0,div:!0,dl:!0,fieldset:!0,figcaption:!0,figure:!0,footer:!0,form:!0,h1:!0,h2:!0,h3:!0,h4:!0,h5:!0,h6:!0,header:!0,hgroup:!0,hr:!0,li:!0,noscript:!0,ol:!0,output:!0,p:!0,pre:!0,section:!0,table:!0,tfoot:!0,ul:!0},En={head:!0,noscript:!0,object:!0,script:!0,style:!0,title:!0},Pn={ol:!0,ul:!0};function N(k,c,f){return null!=c?(c?1:0)|("full"===c?2:0):k&&"pre"==k.whitespace?3:-5&f}class y{constructor(c,f,g,v,M,P,B){this.type=c,this.attrs=f,this.marks=g,this.pendingMarks=v,this.solid=M,this.options=B,this.content=[],this.activeMarks=ae.none,this.stashMarks=[],this.match=P||(4&B?null:c.contentMatch)}findWrapping(c){if(!this.match){if(!this.type)return[];let f=this.type.contentMatch.fillBefore(q.from(c));if(!f){let v,g=this.type.contentMatch;return(v=g.findWrapping(c.type))?(this.match=g,v):null}this.match=this.type.contentMatch.matchFragment(f)}return this.match.findWrapping(c.type)}finish(c){if(!(1&this.options)){let v,g=this.content[this.content.length-1];if(g&&g.isText&&(v=/[ \t\r\n\u000c]+$/.exec(g.text))){let M=g;g.text.length==v[0].length?this.content.pop():this.content[this.content.length-1]=M.withText(M.text.slice(0,M.text.length-v[0].length))}}let f=q.from(this.content);return!c&&this.match&&(f=f.append(this.match.fillBefore(q.empty,!0))),this.type?this.type.create(this.attrs,f,this.marks):f}popFromStashMark(c){for(let f=this.stashMarks.length-1;f>=0;f--)if(c.eq(this.stashMarks[f]))return this.stashMarks.splice(f,1)[0]}applyPending(c){for(let f=0,g=this.pendingMarks;f<g.length;f++){let v=g[f];(this.type?this.type.allowsMarkType(v.type):V(v.type,c))&&!v.isInSet(this.activeMarks)&&(this.activeMarks=v.addToSet(this.activeMarks),this.pendingMarks=v.removeFromSet(this.pendingMarks))}}inlineContext(c){return this.type?this.type.inlineContent:this.content.length?this.content[0].isInline:c.parentNode&&!Gt.hasOwnProperty(c.parentNode.nodeName.toLowerCase())}}class x{constructor(c,f,g){this.parser=c,this.options=f,this.isOpen=g,this.open=0;let M,v=f.topNode,P=N(null,f.preserveWhitespace,0)|(g?4:0);M=v?new y(v.type,v.attrs,ae.none,ae.none,!0,f.topMatch||v.type.contentMatch,P):new y(g?null:c.schema.topNodeType,null,ae.none,ae.none,!0,null,P),this.nodes=[M],this.find=f.findPositions,this.needsBlock=!1}get top(){return this.nodes[this.open]}addDOM(c){if(3==c.nodeType)this.addTextNode(c);else if(1==c.nodeType){let f=c.getAttribute("style"),g=f?this.readStyles(function F(k){let f,c=/\s*([\w-]+)\s*:\s*([^;]+)/g,g=[];for(;f=c.exec(k);)g.push(f[1],f[2].trim());return g}(f)):null,v=this.top;if(null!=g)for(let M=0;M<g.length;M++)this.addPendingMark(g[M]);if(this.addElement(c),null!=g)for(let M=0;M<g.length;M++)this.removePendingMark(g[M],v)}}addTextNode(c){let f=c.nodeValue,g=this.top;if(2&g.options||g.inlineContext(c)||/[^ \t\r\n\u000c]/.test(f)){if(1&g.options)f=2&g.options?f.replace(/\r\n?/g,"\n"):f.replace(/\r?\n|\r/g," ");else if(f=f.replace(/[ \t\r\n\u000c]+/g," "),/^[ \t\r\n\u000c]/.test(f)&&this.open==this.nodes.length-1){let v=g.content[g.content.length-1],M=c.previousSibling;(!v||M&&"BR"==M.nodeName||v.isText&&/[ \t\r\n\u000c]$/.test(v.text))&&(f=f.slice(1))}f&&this.insertNode(this.parser.schema.text(f)),this.findInText(c)}else this.findInside(c)}addElement(c,f){let v,g=c.nodeName.toLowerCase();Pn.hasOwnProperty(g)&&this.parser.normalizeLists&&function S(k){for(let c=k.firstChild,f=null;c;c=c.nextSibling){let g=1==c.nodeType?c.nodeName.toLowerCase():null;g&&Pn.hasOwnProperty(g)&&f?(f.appendChild(c),c=f):"li"==g?f=c:g&&(f=null)}}(c);let M=this.options.ruleFromNode&&this.options.ruleFromNode(c)||(v=this.parser.matchTag(c,this,f));if(M?M.ignore:En.hasOwnProperty(g))this.findInside(c),this.ignoreFallback(c);else if(!M||M.skip||M.closeParent){M&&M.closeParent?this.open=Math.max(0,this.open-1):M&&M.skip.nodeType&&(c=M.skip);let P,B=this.top,J=this.needsBlock;if(Gt.hasOwnProperty(g))P=!0,B.type||(this.needsBlock=!0);else if(!c.firstChild)return void this.leafFallback(c);this.addAll(c),P&&this.sync(B),this.needsBlock=J}else this.addElementByRule(c,M,!1===M.consuming?v:void 0)}leafFallback(c){"BR"==c.nodeName&&this.top.type&&this.top.type.inlineContent&&this.addTextNode(c.ownerDocument.createTextNode("\n"))}ignoreFallback(c){"BR"==c.nodeName&&(!this.top.type||!this.top.type.inlineContent)&&this.findPlace(this.parser.schema.text("-"))}readStyles(c){let f=ae.none;e:for(let g=0;g<c.length;g+=2)for(let v;;){let M=this.parser.matchStyle(c[g],c[g+1],this,v);if(!M)continue e;if(M.ignore)return null;if(f=this.parser.schema.marks[M.mark].create(M.attrs).addToSet(f),!1!==M.consuming)break;v=M}return f}addElementByRule(c,f,g){let v,M,P;f.node?(M=this.parser.schema.nodes[f.node],M.isLeaf?this.insertNode(M.create(f.attrs))||this.leafFallback(c):v=this.enter(M,f.attrs||null,f.preserveWhitespace)):(P=this.parser.schema.marks[f.mark].create(f.attrs),this.addPendingMark(P));let B=this.top;if(M&&M.isLeaf)this.findInside(c);else if(g)this.addElement(c,g);else if(f.getContent)this.findInside(c),f.getContent(c,this.parser.schema).forEach(J=>this.insertNode(J));else{let J=c;"string"==typeof f.contentElement?J=c.querySelector(f.contentElement):"function"==typeof f.contentElement?J=f.contentElement(c):f.contentElement&&(J=f.contentElement),this.findAround(c,J,!0),this.addAll(J)}v&&this.sync(B)&&this.open--,P&&this.removePendingMark(P,B)}addAll(c,f,g){let v=f||0;for(let M=f?c.childNodes[f]:c.firstChild,P=null==g?null:c.childNodes[g];M!=P;M=M.nextSibling,++v)this.findAtPoint(c,v),this.addDOM(M);this.findAtPoint(c,v)}findPlace(c){let f,g;for(let v=this.open;v>=0;v--){let M=this.nodes[v],P=M.findWrapping(c);if(P&&(!f||f.length>P.length)&&(f=P,g=M,!P.length)||M.solid)break}if(!f)return!1;this.sync(g);for(let v=0;v<f.length;v++)this.enterInner(f[v],null,!1);return!0}insertNode(c){if(c.isInline&&this.needsBlock&&!this.top.type){let f=this.textblockFromContext();f&&this.enterInner(f)}if(this.findPlace(c)){this.closeExtra();let f=this.top;f.applyPending(c.type),f.match&&(f.match=f.match.matchType(c.type));let g=f.activeMarks;for(let v=0;v<c.marks.length;v++)(!f.type||f.type.allowsMarkType(c.marks[v].type))&&(g=c.marks[v].addToSet(g));return f.content.push(c.mark(g)),!0}return!1}enter(c,f,g){let v=this.findPlace(c.create(f));return v&&this.enterInner(c,f,!0,g),v}enterInner(c,f=null,g=!1,v){this.closeExtra();let M=this.top;M.applyPending(c),M.match=M.match&&M.match.matchType(c);let P=N(c,v,M.options);4&M.options&&0==M.content.length&&(P|=4),this.nodes.push(new y(c,f,M.activeMarks,M.pendingMarks,g,null,P)),this.open++}closeExtra(c=!1){let f=this.nodes.length-1;if(f>this.open){for(;f>this.open;f--)this.nodes[f-1].content.push(this.nodes[f].finish(c));this.nodes.length=this.open+1}}finish(){return this.open=0,this.closeExtra(this.isOpen),this.nodes[0].finish(this.isOpen||this.options.topOpen)}sync(c){for(let f=this.open;f>=0;f--)if(this.nodes[f]==c)return this.open=f,!0;return!1}get currentPos(){this.closeExtra();let c=0;for(let f=this.open;f>=0;f--){let g=this.nodes[f].content;for(let v=g.length-1;v>=0;v--)c+=g[v].nodeSize;f&&c++}return c}findAtPoint(c,f){if(this.find)for(let g=0;g<this.find.length;g++)this.find[g].node==c&&this.find[g].offset==f&&(this.find[g].pos=this.currentPos)}findInside(c){if(this.find)for(let f=0;f<this.find.length;f++)null==this.find[f].pos&&1==c.nodeType&&c.contains(this.find[f].node)&&(this.find[f].pos=this.currentPos)}findAround(c,f,g){if(c!=f&&this.find)for(let v=0;v<this.find.length;v++)null==this.find[v].pos&&1==c.nodeType&&c.contains(this.find[v].node)&&f.compareDocumentPosition(this.find[v].node)&(g?2:4)&&(this.find[v].pos=this.currentPos)}findInText(c){if(this.find)for(let f=0;f<this.find.length;f++)this.find[f].node==c&&(this.find[f].pos=this.currentPos-(c.nodeValue.length-this.find[f].offset))}matchesContext(c){if(c.indexOf("|")>-1)return c.split(/\s*\|\s*/).some(this.matchesContext,this);let f=c.split("/"),g=this.options.context,v=!(this.isOpen||g&&g.parent.type!=this.nodes[0].type),M=(v?0:1)-(g?g.depth+1:0),P=(B,J)=>{for(;B>=0;B--){let K=f[B];if(""==K){if(B==f.length-1||0==B)continue;for(;J>=M;J--)if(P(B-1,J))return!0;return!1}{let ge=J>0||0==J&&v?this.nodes[J].type:g&&J>=M?g.node(J-M).type:null;if(!ge||ge.name!=K&&-1==ge.groups.indexOf(K))return!1;J--}}return!0};return P(f.length-1,this.open)}textblockFromContext(){let c=this.options.context;if(c)for(let f=c.depth;f>=0;f--){let g=c.node(f).contentMatchAt(c.indexAfter(f)).defaultType;if(g&&g.isTextblock&&g.defaultAttrs)return g}for(let f in this.parser.schema.nodes){let g=this.parser.schema.nodes[f];if(g.isTextblock&&g.defaultAttrs)return g}}addPendingMark(c){let f=function Z(k,c){for(let f=0;f<c.length;f++)if(k.eq(c[f]))return c[f]}(c,this.top.pendingMarks);f&&this.top.stashMarks.push(f),this.top.pendingMarks=c.addToSet(this.top.pendingMarks)}removePendingMark(c,f){for(let g=this.open;g>=0;g--){let v=this.nodes[g];if(v.pendingMarks.lastIndexOf(c)>-1)v.pendingMarks=c.removeFromSet(v.pendingMarks);else{v.activeMarks=c.removeFromSet(v.activeMarks);let P=v.popFromStashMark(c);P&&v.type&&v.type.allowsMarkType(P.type)&&(v.activeMarks=P.addToSet(v.activeMarks))}if(v==f)break}}}function E(k,c){return(k.matches||k.msMatchesSelector||k.webkitMatchesSelector||k.mozMatchesSelector).call(k,c)}function z(k){let c={};for(let f in k)c[f]=k[f];return c}function V(k,c){let f=c.schema.nodes;for(let g in f){let v=f[g];if(!v.allowsMarkType(k))continue;let M=[],P=B=>{M.push(B);for(let J=0;J<B.edgeCount;J++){let{type:K,next:ge}=B.edge(J);if(K==c||M.indexOf(ge)<0&&P(ge))return!0}};if(P(v.contentMatch))return!0}}class ee{constructor(c,f){this.nodes=c,this.marks=f}serializeFragment(c,f={},g){g||(g=me(f).createDocumentFragment());let v=g,M=[];return c.forEach(P=>{if(M.length||P.marks.length){let B=0,J=0;for(;B<M.length&&J<P.marks.length;){let K=P.marks[J];if(this.marks[K.type.name]){if(!K.eq(M[B][0])||!1===K.type.spec.spanning)break;B++,J++}else J++}for(;B<M.length;)v=M.pop()[1];for(;J<P.marks.length;){let K=P.marks[J++],ge=this.serializeMark(K,P.isInline,f);ge&&(M.push([K,v]),v.appendChild(ge.dom),v=ge.contentDOM||ge.dom)}}v.appendChild(this.serializeNodeInner(P,f))}),g}serializeNodeInner(c,f){let{dom:g,contentDOM:v}=ee.renderSpec(me(f),this.nodes[c.type.name](c));if(v){if(c.isLeaf)throw new RangeError("Content hole not allowed in a leaf node spec");this.serializeFragment(c.content,f,v)}return g}serializeNode(c,f={}){let g=this.serializeNodeInner(c,f);for(let v=c.marks.length-1;v>=0;v--){let M=this.serializeMark(c.marks[v],c.isInline,f);M&&((M.contentDOM||M.dom).appendChild(g),g=M.dom)}return g}serializeMark(c,f,g={}){let v=this.marks[c.type.name];return v&&ee.renderSpec(me(g),v(c,f))}static renderSpec(c,f,g=null){if("string"==typeof f)return{dom:c.createTextNode(f)};if(null!=f.nodeType)return{dom:f};if(f.dom&&null!=f.dom.nodeType)return f;let v=f[0],M=v.indexOf(" ");M>0&&(g=v.slice(0,M),v=v.slice(M+1));let P,B=g?c.createElementNS(g,v):c.createElement(v),J=f[1],K=1;if(J&&"object"==typeof J&&null==J.nodeType&&!Array.isArray(J)){K=2;for(let ge in J)if(null!=J[ge]){let _t=ge.indexOf(" ");_t>0?B.setAttributeNS(ge.slice(0,_t),ge.slice(_t+1),J[ge]):B.setAttribute(ge,J[ge])}}for(let ge=K;ge<f.length;ge++){let _t=f[ge];if(0===_t){if(ge<f.length-1||ge>K)throw new RangeError("Content hole must be the only child of its parent node");return{dom:B,contentDOM:B}}{let{dom:rn,contentDOM:sn}=ee.renderSpec(c,_t,g);if(B.appendChild(rn),sn){if(P)throw new RangeError("Multiple content holes");P=sn}}}return{dom:B,contentDOM:P}}static fromSchema(c){return c.cached.domSerializer||(c.cached.domSerializer=new ee(this.nodesFromSchema(c),this.marksFromSchema(c)))}static nodesFromSchema(c){let f=de(c.nodes);return f.text||(f.text=g=>g.text),f}static marksFromSchema(c){return de(c.marks)}}function de(k){let c={};for(let f in k){let g=k[f].spec.toDOM;g&&(c[f]=g)}return c}function me(k){return k.document||window.document}},6956:(bt,Fe,A)=>{A.d(Fe,{Bs:()=>be,C1:()=>ve,H$:()=>Me,Sy:()=>Ge,Y1:()=>X,qv:()=>Te,xm:()=>q,yy:()=>Ye});var w=A(8197),ye=A(3060);const Ve=Object.create(null);class X{constructor(O,L,$){this.$anchor=O,this.$head=L,this.ranges=$||[new q(O.min(L),O.max(L))]}get anchor(){return this.$anchor.pos}get head(){return this.$head.pos}get from(){return this.$from.pos}get to(){return this.$to.pos}get $from(){return this.ranges[0].$from}get $to(){return this.ranges[0].$to}get empty(){let O=this.ranges;for(let L=0;L<O.length;L++)if(O[L].$from.pos!=O[L].$to.pos)return!1;return!0}content(){return this.$from.doc.slice(this.from,this.to,!0)}replace(O,L=w.p2.empty){let $=L.content.lastChild,Q=null;for(let De=0;De<L.openEnd;De++)Q=$,$=$.lastChild;let oe=O.steps.length,xe=this.ranges;for(let De=0;De<xe.length;De++){let{$from:We,$to:rt}=xe[De],Le=O.mapping.slice(oe);O.replaceRange(Le.map(We.pos),Le.map(rt.pos),De?w.p2.empty:L),0==De&&ot(O,oe,($?$.isInline:Q&&Q.isTextblock)?-1:1)}}replaceWith(O,L){let $=O.steps.length,Q=this.ranges;for(let oe=0;oe<Q.length;oe++){let{$from:xe,$to:De}=Q[oe],We=O.mapping.slice($),rt=We.map(xe.pos),Le=We.map(De.pos);oe?O.deleteRange(rt,Le):(O.replaceRangeWith(rt,Le,L),ot(O,$,L.isInline?-1:1))}}static findFrom(O,L,$=!1){let Q=O.parent.inlineContent?new be(O):Se(O.node(0),O.parent,O.pos,O.index(),L,$);if(Q)return Q;for(let oe=O.depth-1;oe>=0;oe--){let xe=L<0?Se(O.node(0),O.node(oe),O.before(oe+1),O.index(oe),L,$):Se(O.node(0),O.node(oe),O.after(oe+1),O.index(oe)+1,L,$);if(xe)return xe}return null}static near(O,L=1){return this.findFrom(O,L)||this.findFrom(O,-L)||new ve(O.node(0))}static atStart(O){return Se(O,O,0,0,1)||new ve(O)}static atEnd(O){return Se(O,O,O.content.size,O.childCount,-1)||new ve(O)}static fromJSON(O,L){if(!L||!L.type)throw new RangeError("Invalid input for Selection.fromJSON");let $=Ve[L.type];if(!$)throw new RangeError(`No selection type ${L.type} defined`);return $.fromJSON(O,L)}static jsonID(O,L){if(O in Ve)throw new RangeError("Duplicate use of selection JSON ID "+O);return Ve[O]=L,L.prototype.jsonID=O,L}getBookmark(){return be.between(this.$anchor,this.$head).getBookmark()}}X.prototype.visible=!0;class q{constructor(O,L){this.$from=O,this.$to=L}}let Ee=!1;function Oe(re){!Ee&&!re.parent.inlineContent&&(Ee=!0,console.warn("TextSelection endpoint not pointing into a node with inline content ("+re.parent.type.name+")"))}class be extends X{constructor(O,L=O){Oe(O),Oe(L),super(O,L)}get $cursor(){return this.$anchor.pos==this.$head.pos?this.$head:null}map(O,L){let $=O.resolve(L.map(this.head));if(!$.parent.inlineContent)return X.near($);let Q=O.resolve(L.map(this.anchor));return new be(Q.parent.inlineContent?Q:$,$)}replace(O,L=w.p2.empty){if(super.replace(O,L),L==w.p2.empty){let $=this.$from.marksAcross(this.$to);$&&O.ensureMarks($)}}eq(O){return O instanceof be&&O.anchor==this.anchor&&O.head==this.head}getBookmark(){return new ae(this.anchor,this.head)}toJSON(){return{type:"text",anchor:this.anchor,head:this.head}}static fromJSON(O,L){if("number"!=typeof L.anchor||"number"!=typeof L.head)throw new RangeError("Invalid input for TextSelection.fromJSON");return new be(O.resolve(L.anchor),O.resolve(L.head))}static create(O,L,$=L){let Q=O.resolve(L);return new this(Q,$==L?Q:O.resolve($))}static between(O,L,$){let Q=O.pos-L.pos;if((!$||Q)&&($=Q>=0?1:-1),!L.parent.inlineContent){let oe=X.findFrom(L,$,!0)||X.findFrom(L,-$,!0);if(!oe)return X.near(L,$);L=oe.$head}return O.parent.inlineContent||(0==Q||(O=(X.findFrom(O,-$,!0)||X.findFrom(O,$,!0)).$anchor).pos<L.pos!=Q<0)&&(O=L),new be(O,L)}}X.jsonID("text",be);class ae{constructor(O,L){this.anchor=O,this.head=L}map(O){return new ae(O.map(this.anchor),O.map(this.head))}resolve(O){return be.between(O.resolve(this.anchor),O.resolve(this.head))}}class Te extends X{constructor(O){let L=O.nodeAfter,$=O.node(0).resolve(O.pos+L.nodeSize);super(O,$),this.node=L}map(O,L){let{deleted:$,pos:Q}=L.mapResult(this.anchor),oe=O.resolve(Q);return $?X.near(oe):new Te(oe)}content(){return new w.p2(w.HY.from(this.node),0,0)}eq(O){return O instanceof Te&&O.anchor==this.anchor}toJSON(){return{type:"node",anchor:this.anchor}}getBookmark(){return new ke(this.anchor)}static fromJSON(O,L){if("number"!=typeof L.anchor)throw new RangeError("Invalid input for NodeSelection.fromJSON");return new Te(O.resolve(L.anchor))}static create(O,L){return new Te(O.resolve(L))}static isSelectable(O){return!O.isText&&!1!==O.type.spec.selectable}}Te.prototype.visible=!1,X.jsonID("node",Te);class ke{constructor(O){this.anchor=O}map(O){let{deleted:L,pos:$}=O.mapResult(this.anchor);return L?new ae($,$):new ke($)}resolve(O){let L=O.resolve(this.anchor),$=L.nodeAfter;return $&&Te.isSelectable($)?new Te(L):X.near(L)}}class ve extends X{constructor(O){super(O.resolve(0),O.resolve(O.content.size))}replace(O,L=w.p2.empty){if(L==w.p2.empty){O.delete(0,O.doc.content.size);let $=X.atStart(O.doc);$.eq(O.selection)||O.setSelection($)}else super.replace(O,L)}toJSON(){return{type:"all"}}static fromJSON(O){return new ve(O)}map(O){return new ve(O)}eq(O){return O instanceof ve}getBookmark(){return ie}}X.jsonID("all",ve);const ie={map(){return this},resolve:re=>new ve(re)};function Se(re,O,L,$,Q,oe=!1){if(O.inlineContent)return be.create(re,L);for(let xe=$-(Q>0?0:1);Q>0?xe<O.childCount:xe>=0;xe+=Q){let De=O.child(xe);if(De.isAtom){if(!oe&&Te.isSelectable(De))return Te.create(re,L-(Q<0?De.nodeSize:0))}else{let We=Se(re,De,L+Q,Q<0?De.childCount:0,Q,oe);if(We)return We}L+=De.nodeSize*Q}return null}function ot(re,O,L){let $=re.steps.length-1;if($<O)return;let xe,Q=re.steps[$];(Q instanceof ye.Pu||Q instanceof ye.FC)&&(re.mapping.maps[$].forEach((De,We,rt,Le)=>{null==xe&&(xe=Le)}),re.setSelection(X.near(re.doc.resolve(xe),L)))}class fe extends ye.wx{constructor(O){super(O.doc),this.curSelectionFor=0,this.updated=0,this.meta=Object.create(null),this.time=Date.now(),this.curSelection=O.selection,this.storedMarks=O.storedMarks}get selection(){return this.curSelectionFor<this.steps.length&&(this.curSelection=this.curSelection.map(this.doc,this.mapping.slice(this.curSelectionFor)),this.curSelectionFor=this.steps.length),this.curSelection}setSelection(O){if(O.$from.doc!=this.doc)throw new RangeError("Selection passed to setSelection must point at the current document");return this.curSelection=O,this.curSelectionFor=this.steps.length,this.updated=-3&(1|this.updated),this.storedMarks=null,this}get selectionSet(){return(1&this.updated)>0}setStoredMarks(O){return this.storedMarks=O,this.updated|=2,this}ensureMarks(O){return w.vc.sameSet(this.storedMarks||this.selection.$from.marks(),O)||this.setStoredMarks(O),this}addStoredMark(O){return this.ensureMarks(O.addToSet(this.storedMarks||this.selection.$head.marks()))}removeStoredMark(O){return this.ensureMarks(O.removeFromSet(this.storedMarks||this.selection.$head.marks()))}get storedMarksSet(){return(2&this.updated)>0}addStep(O,L){super.addStep(O,L),this.updated=-3&this.updated,this.storedMarks=null}setTime(O){return this.time=O,this}replaceSelection(O){return this.selection.replace(this,O),this}replaceSelectionWith(O,L=!0){let $=this.selection;return L&&(O=O.mark(this.storedMarks||($.empty?$.$from.marks():$.$from.marksAcross($.$to)||w.vc.none))),$.replaceWith(this,O),this}deleteSelection(){return this.selection.replace(this),this}insertText(O,L,$){let Q=this.doc.type.schema;if(null==L)return O?this.replaceSelectionWith(Q.text(O),!0):this.deleteSelection();{if(null==$&&($=L),$=null==$?L:$,!O)return this.deleteRange(L,$);let oe=this.storedMarks;if(!oe){let xe=this.doc.resolve(L);oe=$==L?xe.marks():xe.marksAcross(this.doc.resolve($))}return this.replaceRangeWith(L,$,Q.text(O,oe)),this.selection.empty||this.setSelection(X.near(this.selection.$to)),this}}setMeta(O,L){return this.meta["string"==typeof O?O:O.key]=L,this}getMeta(O){return this.meta["string"==typeof O?O:O.key]}get isGeneric(){for(let O in this.meta)return!1;return!0}scrollIntoView(){return this.updated|=4,this}get scrolledIntoView(){return(4&this.updated)>0}}function _e(re,O){return O&&re?re.bind(O):re}class le{constructor(O,L,$){this.name=O,this.init=_e(L.init,$),this.apply=_e(L.apply,$)}}const te=[new le("doc",{init:re=>re.doc||re.schema.topNodeType.createAndFill(),apply:re=>re.doc}),new le("selection",{init:(re,O)=>re.selection||X.atStart(O.doc),apply:re=>re.selection}),new le("storedMarks",{init:re=>re.storedMarks||null,apply:(re,O,L,$)=>$.selection.$cursor?re.storedMarks:null}),new le("scrollToSelection",{init:()=>0,apply:(re,O)=>re.scrolledIntoView?O+1:O})];class Xe{constructor(O,L){this.schema=O,this.plugins=[],this.pluginsByKey=Object.create(null),this.fields=te.slice(),L&&L.forEach($=>{if(this.pluginsByKey[$.key])throw new RangeError("Adding different instances of a keyed plugin ("+$.key+")");this.plugins.push($),this.pluginsByKey[$.key]=$,$.spec.state&&this.fields.push(new le($.key,$.spec.state,$))})}}class Ye{constructor(O){this.config=O}get schema(){return this.config.schema}get plugins(){return this.config.plugins}apply(O){return this.applyTransaction(O).state}filterTransaction(O,L=-1){for(let $=0;$<this.config.plugins.length;$++)if($!=L){let Q=this.config.plugins[$];if(Q.spec.filterTransaction&&!Q.spec.filterTransaction.call(Q,O,this))return!1}return!0}applyTransaction(O){if(!this.filterTransaction(O))return{state:this,transactions:[]};let L=[O],$=this.applyInner(O),Q=null;for(;;){let oe=!1;for(let xe=0;xe<this.config.plugins.length;xe++){let De=this.config.plugins[xe];if(De.spec.appendTransaction){let We=Q?Q[xe].n:0,rt=Q?Q[xe].state:this,Le=We<L.length&&De.spec.appendTransaction.call(De,We?L.slice(We):L,rt,$);if(Le&&$.filterTransaction(Le,xe)){if(Le.setMeta("appendedTransaction",O),!Q){Q=[];for(let Yt=0;Yt<this.config.plugins.length;Yt++)Q.push(Yt<xe?{state:$,n:L.length}:{state:this,n:0})}L.push(Le),$=$.applyInner(Le),oe=!0}Q&&(Q[xe]={state:$,n:L.length})}}if(!oe)return{state:$,transactions:L}}}applyInner(O){if(!O.before.eq(this.doc))throw new RangeError("Applying a mismatched transaction");let L=new Ye(this.config),$=this.config.fields;for(let Q=0;Q<$.length;Q++){let oe=$[Q];L[oe.name]=oe.apply(O,this[oe.name],this,L)}return L}get tr(){return new fe(this)}static create(O){let L=new Xe(O.doc?O.doc.type.schema:O.schema,O.plugins),$=new Ye(L);for(let Q=0;Q<L.fields.length;Q++)$[L.fields[Q].name]=L.fields[Q].init(O,$);return $}reconfigure(O){let L=new Xe(this.schema,O.plugins),$=L.fields,Q=new Ye(L);for(let oe=0;oe<$.length;oe++){let xe=$[oe].name;Q[xe]=this.hasOwnProperty(xe)?this[xe]:$[oe].init(O,Q)}return Q}toJSON(O){let L={doc:this.doc.toJSON(),selection:this.selection.toJSON()};if(this.storedMarks&&(L.storedMarks=this.storedMarks.map($=>$.toJSON())),O&&"object"==typeof O)for(let $ in O){if("doc"==$||"selection"==$)throw new RangeError("The JSON fields `doc` and `selection` are reserved");let Q=O[$],oe=Q.spec.state;oe&&oe.toJSON&&(L[$]=oe.toJSON.call(Q,this[Q.key]))}return L}static fromJSON(O,L,$){if(!L)throw new RangeError("Invalid input for EditorState.fromJSON");if(!O.schema)throw new RangeError("Required config field 'schema' missing");let Q=new Xe(O.schema,O.plugins),oe=new Ye(Q);return Q.fields.forEach(xe=>{if("doc"==xe.name)oe.doc=w.NB.fromJSON(O.schema,L.doc);else if("selection"==xe.name)oe.selection=X.fromJSON(oe.doc,L.selection);else if("storedMarks"==xe.name)L.storedMarks&&(oe.storedMarks=L.storedMarks.map(O.schema.markFromJSON));else{if($)for(let De in $){let We=$[De],rt=We.spec.state;if(We.key==xe.name&&rt&&rt.fromJSON&&Object.prototype.hasOwnProperty.call(L,De))return void(oe[xe.name]=rt.fromJSON.call(We,O,L[De],oe))}oe[xe.name]=xe.init(O,oe)}}),oe}}function $e(re,O,L){for(let $ in re){let Q=re[$];Q instanceof Function?Q=Q.bind(O):"handleDOMEvents"==$&&(Q=$e(Q,O,{})),L[$]=Q}return L}class Ge{constructor(O){this.spec=O,this.props={},O.props&&$e(O.props,this,this.props),this.key=O.key?O.key.key:Mt("plugin")}getState(O){return O[this.key]}}const ze=Object.create(null);function Mt(re){return re in ze?re+"$"+ ++ze[re]:(ze[re]=0,re+"$")}class Me{constructor(O="key"){this.key=Mt(O)}get(O){return O.config.pluginsByKey[this.key]}getState(O){return O[this.key]}}},3060:(bt,Fe,A)=>{A.d(Fe,{Ax:()=>De,FC:()=>le,Mn:()=>rt,Pu:()=>_e,dR:()=>mn,k9:()=>ze,nd:()=>Me,nj:()=>hn,vs:()=>ie,wx:()=>Dt});var w=A(8197);const Ve=Math.pow(2,16);function X(N,y){return N+y*Ve}function q(N){return 65535&N}class ke{constructor(y,x,S){this.pos=y,this.delInfo=x,this.recover=S}get deleted(){return(8&this.delInfo)>0}get deletedBefore(){return(5&this.delInfo)>0}get deletedAfter(){return(6&this.delInfo)>0}get deletedAcross(){return(4&this.delInfo)>0}}class ve{constructor(y,x=!1){if(this.ranges=y,this.inverted=x,!y.length&&ve.empty)return ve.empty}recover(y){let x=0,S=q(y);if(!this.inverted)for(let E=0;E<S;E++)x+=this.ranges[3*E+2]-this.ranges[3*E+1];return this.ranges[3*S]+x+function Ee(N){return(N-(65535&N))/Ve}(y)}mapResult(y,x=1){return this._map(y,x,!1)}map(y,x=1){return this._map(y,x,!0)}_map(y,x,S){let E=0,F=this.inverted?2:1,z=this.inverted?1:2;for(let V=0;V<this.ranges.length;V+=3){let Z=this.ranges[V]-(this.inverted?E:0);if(Z>y)break;let ee=this.ranges[V+F],de=this.ranges[V+z],me=Z+ee;if(y<=me){let c=Z+E+((ee?y==Z?-1:y==me?1:x:x)<0?0:de);if(S)return c;let f=y==(x<0?Z:me)?null:X(V/3,y-Z),g=y==Z?2:y==me?1:4;return(x<0?y!=Z:y!=me)&&(g|=8),new ke(c,g,f)}E+=de-ee}return S?y+E:new ke(y+E,0,null)}touches(y,x){let S=0,E=q(x),F=this.inverted?2:1,z=this.inverted?1:2;for(let V=0;V<this.ranges.length;V+=3){let Z=this.ranges[V]-(this.inverted?S:0);if(Z>y)break;let ee=this.ranges[V+F];if(y<=Z+ee&&V==3*E)return!0;S+=this.ranges[V+z]-ee}return!1}forEach(y){let x=this.inverted?2:1,S=this.inverted?1:2;for(let E=0,F=0;E<this.ranges.length;E+=3){let z=this.ranges[E],V=z-(this.inverted?F:0),Z=z+(this.inverted?0:F),ee=this.ranges[E+x],de=this.ranges[E+S];y(V,V+ee,Z,Z+de),F+=de-ee}}invert(){return new ve(this.ranges,!this.inverted)}toString(){return(this.inverted?"-":"")+JSON.stringify(this.ranges)}static offset(y){return 0==y?ve.empty:new ve(y<0?[0,-y,0]:[0,0,y])}}ve.empty=new ve([]);class ie{constructor(y=[],x,S=0,E=y.length){this.maps=y,this.mirror=x,this.from=S,this.to=E}slice(y=0,x=this.maps.length){return new ie(this.maps,this.mirror,y,x)}copy(){return new ie(this.maps.slice(),this.mirror&&this.mirror.slice(),this.from,this.to)}appendMap(y,x){this.to=this.maps.push(y),null!=x&&this.setMirror(this.maps.length-1,x)}appendMapping(y){for(let x=0,S=this.maps.length;x<y.maps.length;x++){let E=y.getMirror(x);this.appendMap(y.maps[x],null!=E&&E<x?S+E:void 0)}}getMirror(y){if(this.mirror)for(let x=0;x<this.mirror.length;x++)if(this.mirror[x]==y)return this.mirror[x+(x%2?-1:1)]}setMirror(y,x){this.mirror||(this.mirror=[]),this.mirror.push(y,x)}appendMappingInverted(y){for(let x=y.maps.length-1,S=this.maps.length+y.maps.length;x>=0;x--){let E=y.getMirror(x);this.appendMap(y.maps[x].invert(),null!=E&&E>x?S-E-1:void 0)}}invert(){let y=new ie;return y.appendMappingInverted(this),y}map(y,x=1){if(this.mirror)return this._map(y,x,!0);for(let S=this.from;S<this.to;S++)y=this.maps[S].map(y,x);return y}mapResult(y,x=1){return this._map(y,x,!1)}_map(y,x,S){let E=0;for(let F=this.from;F<this.to;F++){let V=this.maps[F].mapResult(y,x);if(null!=V.recover){let Z=this.getMirror(F);if(null!=Z&&Z>F&&Z<this.to){F=Z,y=this.maps[Z].recover(V.recover);continue}}E|=V.delInfo,y=V.pos}return S?y:new ke(y,E,null)}}const Se=Object.create(null);class ot{getMap(){return ve.empty}merge(y){return null}static fromJSON(y,x){if(!x||!x.stepType)throw new RangeError("Invalid input for Step.fromJSON");let S=Se[x.stepType];if(!S)throw new RangeError(`No step type ${x.stepType} defined`);return S.fromJSON(y,x)}static jsonID(y,x){if(y in Se)throw new RangeError("Duplicate use of step JSON ID "+y);return Se[y]=x,x.prototype.jsonID=y,x}}class e{constructor(y,x){this.doc=y,this.failed=x}static ok(y){return new e(y,null)}static fail(y){return new e(null,y)}static fromReplace(y,x,S,E){try{return e.ok(y.replace(x,S,E))}catch(F){if(F instanceof w.e4)return e.fail(F.message);throw F}}}function Ke(N,y,x){let S=[];for(let E=0;E<N.childCount;E++){let F=N.child(E);F.content.size&&(F=F.copy(Ke(F.content,y,F))),F.isInline&&(F=y(F,x,E)),S.push(F)}return w.HY.fromArray(S)}class Ie extends ot{constructor(y,x,S){super(),this.from=y,this.to=x,this.mark=S}apply(y){let x=y.slice(this.from,this.to),S=y.resolve(this.from),E=S.node(S.sharedDepth(this.to)),F=new w.p2(Ke(x.content,(z,V)=>z.isAtom&&V.type.allowsMarkType(this.mark.type)?z.mark(this.mark.addToSet(z.marks)):z,E),x.openStart,x.openEnd);return e.fromReplace(y,this.from,this.to,F)}invert(){return new fe(this.from,this.to,this.mark)}map(y){let x=y.mapResult(this.from,1),S=y.mapResult(this.to,-1);return x.deleted&&S.deleted||x.pos>=S.pos?null:new Ie(x.pos,S.pos,this.mark)}merge(y){return y instanceof Ie&&y.mark.eq(this.mark)&&this.from<=y.to&&this.to>=y.from?new Ie(Math.min(this.from,y.from),Math.max(this.to,y.to),this.mark):null}toJSON(){return{stepType:"addMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(y,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for AddMarkStep.fromJSON");return new Ie(x.from,x.to,y.markFromJSON(x.mark))}}ot.jsonID("addMark",Ie);class fe extends ot{constructor(y,x,S){super(),this.from=y,this.to=x,this.mark=S}apply(y){let x=y.slice(this.from,this.to),S=new w.p2(Ke(x.content,E=>E.mark(this.mark.removeFromSet(E.marks)),y),x.openStart,x.openEnd);return e.fromReplace(y,this.from,this.to,S)}invert(){return new Ie(this.from,this.to,this.mark)}map(y){let x=y.mapResult(this.from,1),S=y.mapResult(this.to,-1);return x.deleted&&S.deleted||x.pos>=S.pos?null:new fe(x.pos,S.pos,this.mark)}merge(y){return y instanceof fe&&y.mark.eq(this.mark)&&this.from<=y.to&&this.to>=y.from?new fe(Math.min(this.from,y.from),Math.max(this.to,y.to),this.mark):null}toJSON(){return{stepType:"removeMark",mark:this.mark.toJSON(),from:this.from,to:this.to}}static fromJSON(y,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for RemoveMarkStep.fromJSON");return new fe(x.from,x.to,y.markFromJSON(x.mark))}}ot.jsonID("removeMark",fe);class _e extends ot{constructor(y,x,S,E=!1){super(),this.from=y,this.to=x,this.slice=S,this.structure=E}apply(y){return this.structure&&te(y,this.from,this.to)?e.fail("Structure replace would overwrite content"):e.fromReplace(y,this.from,this.to,this.slice)}getMap(){return new ve([this.from,this.to-this.from,this.slice.size])}invert(y){return new _e(this.from,this.from+this.slice.size,y.slice(this.from,this.to))}map(y){let x=y.mapResult(this.from,1),S=y.mapResult(this.to,-1);return x.deletedAcross&&S.deletedAcross?null:new _e(x.pos,Math.max(x.pos,S.pos),this.slice)}merge(y){if(!(y instanceof _e)||y.structure||this.structure)return null;if(this.from+this.slice.size!=y.from||this.slice.openEnd||y.slice.openStart){if(y.to!=this.from||this.slice.openStart||y.slice.openEnd)return null;{let x=this.slice.size+y.slice.size==0?w.p2.empty:new w.p2(y.slice.content.append(this.slice.content),y.slice.openStart,this.slice.openEnd);return new _e(y.from,this.to,x,this.structure)}}{let x=this.slice.size+y.slice.size==0?w.p2.empty:new w.p2(this.slice.content.append(y.slice.content),this.slice.openStart,y.slice.openEnd);return new _e(this.from,this.to+(y.to-y.from),x,this.structure)}}toJSON(){let y={stepType:"replace",from:this.from,to:this.to};return this.slice.size&&(y.slice=this.slice.toJSON()),this.structure&&(y.structure=!0),y}static fromJSON(y,x){if("number"!=typeof x.from||"number"!=typeof x.to)throw new RangeError("Invalid input for ReplaceStep.fromJSON");return new _e(x.from,x.to,w.p2.fromJSON(y,x.slice),!!x.structure)}}ot.jsonID("replace",_e);class le extends ot{constructor(y,x,S,E,F,z,V=!1){super(),this.from=y,this.to=x,this.gapFrom=S,this.gapTo=E,this.slice=F,this.insert=z,this.structure=V}apply(y){if(this.structure&&(te(y,this.from,this.gapFrom)||te(y,this.gapTo,this.to)))return e.fail("Structure gap-replace would overwrite content");let x=y.slice(this.gapFrom,this.gapTo);if(x.openStart||x.openEnd)return e.fail("Gap is not a flat range");let S=this.slice.insertAt(this.insert,x.content);return S?e.fromReplace(y,this.from,this.to,S):e.fail("Content does not fit in gap")}getMap(){return new ve([this.from,this.gapFrom-this.from,this.insert,this.gapTo,this.to-this.gapTo,this.slice.size-this.insert])}invert(y){let x=this.gapTo-this.gapFrom;return new le(this.from,this.from+this.slice.size+x,this.from+this.insert,this.from+this.insert+x,y.slice(this.from,this.to).removeBetween(this.gapFrom-this.from,this.gapTo-this.from),this.gapFrom-this.from,this.structure)}map(y){let x=y.mapResult(this.from,1),S=y.mapResult(this.to,-1),E=y.map(this.gapFrom,-1),F=y.map(this.gapTo,1);return x.deletedAcross&&S.deletedAcross||E<x.pos||F>S.pos?null:new le(x.pos,S.pos,E,F,this.slice,this.insert,this.structure)}toJSON(){let y={stepType:"replaceAround",from:this.from,to:this.to,gapFrom:this.gapFrom,gapTo:this.gapTo,insert:this.insert};return this.slice.size&&(y.slice=this.slice.toJSON()),this.structure&&(y.structure=!0),y}static fromJSON(y,x){if("number"!=typeof x.from||"number"!=typeof x.to||"number"!=typeof x.gapFrom||"number"!=typeof x.gapTo||"number"!=typeof x.insert)throw new RangeError("Invalid input for ReplaceAroundStep.fromJSON");return new le(x.from,x.to,x.gapFrom,x.gapTo,w.p2.fromJSON(y,x.slice),x.insert,!!x.structure)}}function te(N,y,x){let S=N.resolve(y),E=x-y,F=S.depth;for(;E>0&&F>0&&S.indexAfter(F)==S.node(F).childCount;)F--,E--;if(E>0){let z=S.node(F).maybeChild(S.indexAfter(F));for(;E>0;){if(!z||z.isLeaf)return!0;z=z.firstChild,E--}}return!1}function Ge(N,y,x){return(0==y||N.canReplace(y,N.childCount))&&(x==N.childCount||N.canReplace(0,x))}function ze(N){let x=N.parent.content.cutByIndex(N.startIndex,N.endIndex);for(let S=N.depth;;--S){let E=N.$from.node(S),F=N.$from.index(S),z=N.$to.indexAfter(S);if(S<N.depth&&E.canReplace(F,z,x))return S;if(0==S||E.type.spec.isolating||!Ge(E,F,z))break}return null}function Me(N,y,x=null,S=N){let E=function O(N,y){let{parent:x,startIndex:S,endIndex:E}=N,F=x.contentMatchAt(S).findWrapping(y);return F&&x.canReplaceWith(S,E,F.length?F[0]:y)?F:null}(N,y),F=E&&function L(N,y){let{parent:x,startIndex:S,endIndex:E}=N,F=x.child(S),z=y.contentMatch.findWrapping(F.type);if(!z)return null;let Z=(z.length?z[z.length-1]:y).contentMatch;for(let ee=S;Z&&ee<E;ee++)Z=Z.matchType(x.child(ee).type);return Z&&Z.validEnd?z:null}(S,y);return F?E.map(re).concat({type:y,attrs:x}).concat(F.map(re)):null}function re(N){return{type:N,attrs:null}}function De(N,y,x=1,S){let E=N.resolve(y),F=E.depth-x,z=S&&S[S.length-1]||E.parent;if(F<0||E.parent.type.spec.isolating||!E.parent.canReplace(E.index(),E.parent.childCount)||!z.type.validContent(E.parent.content.cutByIndex(E.index(),E.parent.childCount)))return!1;for(let ee=E.depth-1,de=x-2;ee>F;ee--,de--){let me=E.node(ee),k=E.index(ee);if(me.type.spec.isolating)return!1;let c=me.content.cutByIndex(k,me.childCount),f=S&&S[de]||me;if(f!=me&&(c=c.replaceChild(0,f.type.create(f.attrs))),!me.canReplace(k+1,me.childCount)||!f.type.validContent(c))return!1}let V=E.indexAfter(F),Z=S&&S[0];return E.node(F).canReplaceWith(V,V,Z?Z.type:E.node(F+1).type)}function rt(N,y){let x=N.resolve(y),S=x.index();return function Le(N,y){return!(!N||!y||N.isLeaf||!N.canAppend(y))}(x.nodeBefore,x.nodeAfter)&&x.parent.canReplace(S,S+1)}function hn(N,y,x){let S=N.resolve(y);if(!x.content.size)return y;let E=x.content;for(let F=0;F<x.openStart;F++)E=E.firstChild.content;for(let F=1;F<=(0==x.openStart&&x.size?2:1);F++)for(let z=S.depth;z>=0;z--){let V=z==S.depth?0:S.pos<=(S.start(z+1)+S.end(z+1))/2?-1:1,Z=S.index(z)+(V>0?1:0),ee=S.node(z),de=!1;if(1==F)de=ee.canReplace(Z,Z,E);else{let me=ee.contentMatchAt(Z).findWrapping(E.firstChild.type);de=me&&ee.canReplaceWith(Z,Z,me[0])}if(de)return 0==V?S.pos:V<0?S.before(z+1):S.after(z+1)}return null}function mn(N,y,x=y,S=w.p2.empty){if(y==x&&!S.size)return null;let E=N.resolve(y),F=N.resolve(x);return on(E,F,S)?new _e(y,x,S):new gn(E,F,S).fit()}function on(N,y,x){return!x.openStart&&!x.openEnd&&N.start()==y.start()&&N.parent.canReplace(N.index(),y.index(),x.content)}ot.jsonID("replaceAround",le);class gn{constructor(y,x,S){this.$from=y,this.$to=x,this.unplaced=S,this.frontier=[],this.placed=w.HY.empty;for(let E=0;E<=y.depth;E++){let F=y.node(E);this.frontier.push({type:F.type,match:F.contentMatchAt(y.indexAfter(E))})}for(let E=y.depth;E>0;E--)this.placed=w.HY.from(y.node(E).copy(this.placed))}get depth(){return this.frontier.length-1}fit(){for(;this.unplaced.size;){let ee=this.findFittable();ee?this.placeNodes(ee):this.openMore()||this.dropNode()}let y=this.mustMoveInline(),x=this.placed.size-this.depth-this.$from.depth,S=this.$from,E=this.close(y<0?this.$to:S.doc.resolve(y));if(!E)return null;let F=this.placed,z=S.depth,V=E.depth;for(;z&&V&&1==F.childCount;)F=F.firstChild.content,z--,V--;let Z=new w.p2(F,z,V);return y>-1?new le(S.pos,y,this.$to.pos,this.$to.end(),Z,x):Z.size||S.pos!=this.$to.pos?new _e(S.pos,E.pos,Z):null}findFittable(){for(let y=1;y<=2;y++)for(let x=this.unplaced.openStart;x>=0;x--){let S,E=null;x?(E=St(this.unplaced.content,x-1).firstChild,S=E.content):S=this.unplaced.content;let F=S.firstChild;for(let z=this.depth;z>=0;z--){let ee,{type:V,match:Z}=this.frontier[z],de=null;if(1==y&&(F?Z.matchType(F.type)||(de=Z.fillBefore(w.HY.from(F),!1)):E&&V.compatibleContent(E.type)))return{sliceDepth:x,frontierDepth:z,parent:E,inject:de};if(2==y&&F&&(ee=Z.findWrapping(F.type)))return{sliceDepth:x,frontierDepth:z,parent:E,wrap:ee};if(E&&Z.matchType(E.type))break}}}openMore(){let{content:y,openStart:x,openEnd:S}=this.unplaced,E=St(y,x);return!(!E.childCount||E.firstChild.isLeaf||(this.unplaced=new w.p2(y,x+1,Math.max(S,E.size+x>=y.size-S?x+1:0)),0))}dropNode(){let{content:y,openStart:x,openEnd:S}=this.unplaced,E=St(y,x);if(E.childCount<=1&&x>0){let F=y.size-x<=x+E.size;this.unplaced=new w.p2(Vt(y,x-1,1),x-1,F?x-1:S)}else this.unplaced=new w.p2(Vt(y,x,1),x,S)}placeNodes({sliceDepth:y,frontierDepth:x,parent:S,inject:E,wrap:F}){for(;this.depth>x;)this.closeFrontierNode();if(F)for(let g=0;g<F.length;g++)this.openFrontierNode(F[g]);let z=this.unplaced,V=S?S.content:z.content,Z=z.openStart-y,ee=0,de=[],{match:me,type:k}=this.frontier[x];if(E){for(let g=0;g<E.childCount;g++)de.push(E.child(g));me=me.matchFragment(E)}let c=V.size+y-(z.content.size-z.openEnd);for(;ee<V.childCount;){let g=V.child(ee),v=me.matchType(g.type);if(!v)break;ee++,(ee>1||0==Z||g.content.size)&&(me=v,de.push(In(g.mark(k.allowedMarks(g.marks)),1==ee?Z:0,ee==V.childCount?c:-1)))}let f=ee==V.childCount;f||(c=-1),this.placed=At(this.placed,x,w.HY.from(de)),this.frontier[x].match=me,f&&c<0&&S&&S.type==this.frontier[this.depth].type&&this.frontier.length>1&&this.closeFrontierNode();for(let g=0,v=V;g<c;g++){let M=v.lastChild;this.frontier.push({type:M.type,match:M.contentMatchAt(M.childCount)}),v=M.content}this.unplaced=f?0==y?w.p2.empty:new w.p2(Vt(z.content,y-1,1),y-1,c<0?z.openEnd:y-1):new w.p2(Vt(z.content,y,ee),z.openStart,z.openEnd)}mustMoveInline(){if(!this.$to.parent.isTextblock)return-1;let x,y=this.frontier[this.depth];if(!y.type.isTextblock||!ct(this.$to,this.$to.depth,y.type,y.match,!1)||this.$to.depth==this.depth&&(x=this.findCloseLevel(this.$to))&&x.depth==this.depth)return-1;let{depth:S}=this.$to,E=this.$to.after(S);for(;S>1&&E==this.$to.end(--S);)++E;return E}findCloseLevel(y){e:for(let x=Math.min(this.depth,y.depth);x>=0;x--){let{match:S,type:E}=this.frontier[x],F=x<y.depth&&y.end(x+1)==y.pos+(y.depth-(x+1)),z=ct(y,x,E,S,F);if(z){for(let V=x-1;V>=0;V--){let{match:Z,type:ee}=this.frontier[V],de=ct(y,V,ee,Z,!0);if(!de||de.childCount)continue e}return{depth:x,fit:z,move:F?y.doc.resolve(y.after(x+1)):y}}}}close(y){let x=this.findCloseLevel(y);if(!x)return null;for(;this.depth>x.depth;)this.closeFrontierNode();x.fit.childCount&&(this.placed=At(this.placed,x.depth,x.fit)),y=x.move;for(let S=x.depth+1;S<=y.depth;S++){let E=y.node(S),F=E.type.contentMatch.fillBefore(E.content,!0,y.index(S));this.openFrontierNode(E.type,E.attrs,F)}return y}openFrontierNode(y,x=null,S){let E=this.frontier[this.depth];E.match=E.match.matchType(y),this.placed=At(this.placed,this.depth,w.HY.from(y.create(x,S))),this.frontier.push({type:y,match:y.contentMatch})}closeFrontierNode(){let x=this.frontier.pop().match.fillBefore(w.HY.empty,!0);x.childCount&&(this.placed=At(this.placed,this.frontier.length,x))}}function Vt(N,y,x){return 0==y?N.cutByIndex(x,N.childCount):N.replaceChild(0,N.firstChild.copy(Vt(N.firstChild.content,y-1,x)))}function At(N,y,x){return 0==y?N.append(x):N.replaceChild(N.childCount-1,N.lastChild.copy(At(N.lastChild.content,y-1,x)))}function St(N,y){for(let x=0;x<y;x++)N=N.firstChild.content;return N}function In(N,y,x){if(y<=0)return N;let S=N.content;return y>1&&(S=S.replaceChild(0,In(S.firstChild,y-1,1==S.childCount?x-1:0))),y>0&&(S=N.type.contentMatch.fillBefore(S).append(S),x<=0&&(S=S.append(N.type.contentMatch.matchFragment(S).fillBefore(w.HY.empty,!0)))),N.copy(S)}function ct(N,y,x,S,E){let F=N.node(y),z=E?N.indexAfter(y):N.index(y);if(z==F.childCount&&!x.compatibleContent(F.type))return null;let V=S.fillBefore(F.content,!0,z);return V&&!function On(N,y,x){for(let S=x;S<y.childCount;S++)if(!N.allowsMarks(y.child(S).marks))return!0;return!1}(x,F.content,z)?V:null}function Dn(N){return N.spec.defining||N.spec.definingForContent}function Gt(N,y,x,S,E){if(y<x){let F=N.firstChild;N=N.replaceChild(0,F.copy(Gt(F.content,y+1,x,S,F)))}if(y>S){let F=E.contentMatchAt(0),z=F.fillBefore(N).append(N);N=z.append(F.matchFragment(z).fillBefore(w.HY.empty,!0))}return N}function Ot(N,y){let x=[];for(let E=Math.min(N.depth,y.depth);E>=0;E--){let F=N.start(E);if(F<N.pos-(N.depth-E)||y.end(E)>y.pos+(y.depth-E)||N.node(E).type.spec.isolating||y.node(E).type.spec.isolating)break;(F==y.start(E)||E==N.depth&&E==y.depth&&N.parent.inlineContent&&y.parent.inlineContent&&E&&y.start(E-1)==F-1)&&x.push(E)}return x}let ut=class extends Error{};ut=function N(y){let x=Error.call(this,y);return x.__proto__=N.prototype,x},(ut.prototype=Object.create(Error.prototype)).constructor=ut,ut.prototype.name="TransformError";class Dt{constructor(y){this.doc=y,this.steps=[],this.docs=[],this.mapping=new ie}get before(){return this.docs.length?this.docs[0]:this.doc}step(y){let x=this.maybeStep(y);if(x.failed)throw new ut(x.failed);return this}maybeStep(y){let x=y.apply(this.doc);return x.failed||this.addStep(y,x.doc),x}get docChanged(){return this.steps.length>0}addStep(y,x){this.docs.push(this.doc),this.steps.push(y),this.mapping.appendMap(y.getMap()),this.doc=x}replace(y,x=y,S=w.p2.empty){let E=mn(this.doc,y,x,S);return E&&this.step(E),this}replaceWith(y,x,S){return this.replace(y,x,new w.p2(w.HY.from(S),0,0))}delete(y,x){return this.replace(y,x,w.p2.empty)}insert(y,x){return this.replaceWith(y,y,x)}replaceRange(y,x,S){return function It(N,y,x,S){if(!S.size)return N.deleteRange(y,x);let E=N.doc.resolve(y),F=N.doc.resolve(x);if(on(E,F,S))return N.step(new _e(y,x,S));let z=Ot(E,N.doc.resolve(x));0==z[z.length-1]&&z.pop();let V=-(E.depth+1);z.unshift(V);for(let k=E.depth,c=E.pos-1;k>0;k--,c--){let f=E.node(k).type.spec;if(f.defining||f.definingAsContext||f.isolating)break;z.indexOf(k)>-1?V=k:E.before(k)==c&&z.splice(1,0,-k)}let Z=z.indexOf(V),ee=[],de=S.openStart;for(let k=S.content,c=0;;c++){let f=k.firstChild;if(ee.push(f),c==S.openStart)break;k=f.content}for(let k=de-1;k>=0;k--){let c=ee[k].type,f=Dn(c);if(f&&E.node(Z).type!=c)de=k;else if(f||!c.isTextblock)break}for(let k=S.openStart;k>=0;k--){let c=(k+de+1)%(S.openStart+1),f=ee[c];if(f)for(let g=0;g<z.length;g++){let v=z[(g+Z)%z.length],M=!0;v<0&&(M=!1,v=-v);let P=E.node(v-1),B=E.index(v-1);if(P.canReplaceWith(B,B,f.type,f.marks))return N.replace(E.before(v),M?F.after(v):x,new w.p2(Gt(S.content,0,S.openStart,c),c,S.openEnd))}}let me=N.steps.length;for(let k=z.length-1;k>=0&&(N.replace(y,x,S),!(N.steps.length>me));k--){let c=z[k];c<0||(y=E.before(c),x=F.after(c))}}(this,y,x,S),this}replaceRangeWith(y,x,S){return function En(N,y,x,S){if(!S.isInline&&y==x&&N.doc.resolve(y).parent.content.size){let E=function wn(N,y,x){let S=N.resolve(y);if(S.parent.canReplaceWith(S.index(),S.index(),x))return y;if(0==S.parentOffset)for(let E=S.depth-1;E>=0;E--){let F=S.index(E);if(S.node(E).canReplaceWith(F,F,x))return S.before(E+1);if(F>0)return null}if(S.parentOffset==S.parent.content.size)for(let E=S.depth-1;E>=0;E--){let F=S.indexAfter(E);if(S.node(E).canReplaceWith(F,F,x))return S.after(E+1);if(F<S.node(E).childCount)return null}return null}(N.doc,y,S.type);null!=E&&(y=x=E)}N.replaceRange(y,x,new w.p2(w.HY.from(S),0,0))}(this,y,x,S),this}deleteRange(y,x){return function Pn(N,y,x){let S=N.doc.resolve(y),E=N.doc.resolve(x),F=Ot(S,E);for(let z=0;z<F.length;z++){let V=F[z],Z=z==F.length-1;if(Z&&0==V||S.node(V).type.contentMatch.validEnd)return N.delete(S.start(V),E.end(V));if(V>0&&(Z||S.node(V-1).canReplace(S.index(V-1),E.indexAfter(V-1))))return N.delete(S.before(V),E.after(V))}for(let z=1;z<=S.depth&&z<=E.depth;z++)if(y-S.start(z)==S.depth-z&&x>S.end(z)&&E.end(z)-x!=E.depth-z)return N.delete(S.before(z),x);N.delete(y,x)}(this,y,x),this}lift(y,x){return function Mt(N,y,x){let{$from:S,$to:E,depth:F}=y,z=S.before(F+1),V=E.after(F+1),Z=z,ee=V,de=w.HY.empty,me=0;for(let f=F,g=!1;f>x;f--)g||S.index(f)>0?(g=!0,de=w.HY.from(S.node(f).copy(de)),me++):Z--;let k=w.HY.empty,c=0;for(let f=F,g=!1;f>x;f--)g||E.after(f+1)<E.end(f)?(g=!0,k=w.HY.from(E.node(f).copy(k)),c++):ee++;N.step(new le(Z,ee,z,V,new w.p2(de.append(k),me,c),de.size-me,!0))}(this,y,x),this}join(y,x=1){return function jt(N,y,x){let S=new _e(y-x,y+x,w.p2.empty,!0);N.step(S)}(this,y,x),this}wrap(y,x){return function $(N,y,x){let S=w.HY.empty;for(let z=x.length-1;z>=0;z--){if(S.size){let V=x[z].type.contentMatch.matchFragment(S);if(!V||!V.validEnd)throw new RangeError("Wrapper type given to Transform.wrap does not form valid content of its parent wrapper")}S=w.HY.from(x[z].type.create(x[z].attrs,S))}let E=y.start,F=y.end;N.step(new le(E,F,E,F,new w.p2(S,0,0),x.length,!0))}(this,y,x),this}setBlockType(y,x=y,S,E=null){return function Q(N,y,x,S,E){if(!S.isTextblock)throw new RangeError("Type given to setBlockType should be a textblock");let F=N.steps.length;N.doc.nodesBetween(y,x,(z,V)=>{if(z.isTextblock&&!z.hasMarkup(S,E)&&function oe(N,y,x){let S=N.resolve(y),E=S.index();return S.parent.canReplaceWith(E,E+1,x)}(N.doc,N.mapping.slice(F).map(V),S)){N.clearIncompatible(N.mapping.slice(F).map(V,1),S);let Z=N.mapping.slice(F),ee=Z.map(V,1),de=Z.map(V+z.nodeSize,1);return N.step(new le(ee,de,ee+1,de-1,new w.p2(w.HY.from(S.create(E,null,z.marks)),0,0),1,!0)),!1}})}(this,y,x,S,E),this}setNodeMarkup(y,x,S=null,E=[]){return function xe(N,y,x,S,E){let F=N.doc.nodeAt(y);if(!F)throw new RangeError("No node at given position");x||(x=F.type);let z=x.create(S,null,E||F.marks);if(F.isLeaf)return N.replaceWith(y,y+F.nodeSize,z);if(!x.validContent(F.content))throw new RangeError("Invalid content for node type "+x.name);N.step(new le(y,y+F.nodeSize,y+1,y+F.nodeSize-1,new w.p2(w.HY.from(z),0,0),1,!0))}(this,y,x,S,E),this}split(y,x=1,S){return function We(N,y,x=1,S){let E=N.doc.resolve(y),F=w.HY.empty,z=w.HY.empty;for(let V=E.depth,Z=E.depth-x,ee=x-1;V>Z;V--,ee--){F=w.HY.from(E.node(V).copy(F));let de=S&&S[ee];z=w.HY.from(de?de.type.create(de.attrs,z):E.node(V).copy(z))}N.step(new _e(y,y,new w.p2(F.append(z),x,x),!0))}(this,y,x,S),this}addMark(y,x,S){return function Xe(N,y,x,S){let z,V,E=[],F=[];N.doc.nodesBetween(y,x,(Z,ee,de)=>{if(!Z.isInline)return;let me=Z.marks;if(!S.isInSet(me)&&de.type.allowsMarkType(S.type)){let k=Math.max(ee,y),c=Math.min(ee+Z.nodeSize,x),f=S.addToSet(me);for(let g=0;g<me.length;g++)me[g].isInSet(f)||(z&&z.to==k&&z.mark.eq(me[g])?z.to=c:E.push(z=new fe(k,c,me[g])));V&&V.to==k?V.to=c:F.push(V=new Ie(k,c,S))}}),E.forEach(Z=>N.step(Z)),F.forEach(Z=>N.step(Z))}(this,y,x,S),this}removeMark(y,x,S){return function Ye(N,y,x,S){let E=[],F=0;N.doc.nodesBetween(y,x,(z,V)=>{if(!z.isInline)return;F++;let Z=null;if(S instanceof w.ZU){let de,ee=z.marks;for(;de=S.isInSet(ee);)(Z||(Z=[])).push(de),ee=de.removeFromSet(ee)}else S?S.isInSet(z.marks)&&(Z=[S]):Z=z.marks;if(Z&&Z.length){let ee=Math.min(V+z.nodeSize,x);for(let de=0;de<Z.length;de++){let k,me=Z[de];for(let c=0;c<E.length;c++){let f=E[c];f.step==F-1&&me.eq(E[c].style)&&(k=f)}k?(k.to=ee,k.step=F):E.push({style:me,from:Math.max(V,y),to:ee,step:F})}}}),E.forEach(z=>N.step(new fe(z.from,z.to,z.style)))}(this,y,x,S),this}clearIncompatible(y,x,S){return function $e(N,y,x,S=x.contentMatch){let E=N.doc.nodeAt(y),F=[],z=y+1;for(let V=0;V<E.childCount;V++){let Z=E.child(V),ee=z+Z.nodeSize,de=S.matchType(Z.type);if(de){S=de;for(let me=0;me<Z.marks.length;me++)x.allowsMarkType(Z.marks[me].type)||N.step(new fe(z,ee,Z.marks[me]))}else F.push(new _e(z,ee,w.p2.empty));z=ee}if(!S.validEnd){let V=S.fillBefore(w.HY.empty,!0);N.replace(z,z,new w.p2(V,0,0))}for(let V=F.length-1;V>=0;V--)N.step(F[V])}(this,y,x,S),this}}},412:(bt,Fe,A)=>{A.d(Fe,{EH:()=>lt,p:()=>pt,tk:()=>lo});var w=A(6956),ye=A(8197),Ve=A(3060);const X="undefined"!=typeof navigator?navigator:null,q="undefined"!=typeof document?document:null,Ee=X&&X.userAgent||"",Oe=/Edge\/(\d+)/.exec(Ee),be=/MSIE \d/.exec(Ee),ae=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Ee),Te=!!(be||ae||Oe),ke=be?document.documentMode:ae?+ae[1]:Oe?+Oe[1]:0,ve=!Te&&/gecko\/(\d+)/i.test(Ee);ve&&/Firefox\/(\d+)/.exec(Ee);const ie=!Te&&/Chrome\/(\d+)/.exec(Ee),Se=!!ie,ot=ie?+ie[1]:0,e=!Te&&!!X&&/Apple Computer/.test(X.vendor),Ke=e&&(/Mobile\/\w+/.test(Ee)||!!X&&X.maxTouchPoints>2),Ie=Ke||!!X&&/Mac/.test(X.platform),fe=/Android \d/.test(Ee),_e=!!q&&"webkitFontSmoothing"in q.documentElement.style,le=_e?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,te=function(i){for(var t=0;;t++)if(!(i=i.previousSibling))return t},Xe=function(i){let t=i.assignedSlot||i.parentNode;return t&&11==t.nodeType?t.host:t};let Ye=null;const $e=function(i,t,n){let s=Ye||(Ye=document.createRange());return s.setEnd(i,null==n?i.nodeValue.length:n),s.setStart(i,t||0),s},Ge=function(i,t,n,s){return n&&(Mt(i,t,n,s,-1)||Mt(i,t,n,s,1))},ze=/^(img|br|input|textarea|hr)$/i;function Mt(i,t,n,s,l){for(;;){if(i==n&&t==s)return!0;if(t==(l<0?0:Me(i))){let a=i.parentNode;if(!a||1!=a.nodeType||O(i)||ze.test(i.nodeName)||"false"==i.contentEditable)return!1;t=te(i)+(l<0?0:1),i=a}else{if(1!=i.nodeType)return!1;if("false"==(i=i.childNodes[t+(l<0?-1:0)]).contentEditable)return!1;t=l<0?Me(i):0}}}function Me(i){return 3==i.nodeType?i.nodeValue.length:i.childNodes.length}function O(i){let t;for(let n=i;n&&!(t=n.pmViewDesc);n=n.parentNode);return t&&t.node&&t.node.isBlock&&(t.dom==i||t.contentDOM==i)}const L=function(i){let t=i.isCollapsed;return t&&Se&&i.rangeCount&&!i.getRangeAt(0).collapsed&&(t=!1),t};function $(i,t){let n=document.createEvent("Event");return n.initEvent("keydown",!0,!0),n.keyCode=i,n.key=n.code=t,n}function Q(i){return{left:0,right:i.documentElement.clientWidth,top:0,bottom:i.documentElement.clientHeight}}function oe(i,t){return"number"==typeof i?i:i[t]}function xe(i){let t=i.getBoundingClientRect();return{left:t.left,right:t.left+i.clientWidth*(t.width/i.offsetWidth||1),top:t.top,bottom:t.top+i.clientHeight*(t.height/i.offsetHeight||1)}}function De(i,t,n){let s=i.someProp("scrollThreshold")||0,l=i.someProp("scrollMargin")||5,a=i.dom.ownerDocument;for(let d=n||i.dom;d;d=Xe(d)){if(1!=d.nodeType)continue;let h=d,m=h==a.body,b=m?Q(a):xe(h),C=0,I=0;if(t.top<b.top+oe(s,"top")?I=-(b.top-t.top+oe(l,"top")):t.bottom>b.bottom-oe(s,"bottom")&&(I=t.bottom-b.bottom+oe(l,"bottom")),t.left<b.left+oe(s,"left")?C=-(b.left-t.left+oe(l,"left")):t.right>b.right-oe(s,"right")&&(C=t.right-b.right+oe(l,"right")),C||I)if(m)a.defaultView.scrollBy(C,I);else{let D=h.scrollLeft,R=h.scrollTop;I&&(h.scrollTop+=I),C&&(h.scrollLeft+=C);let H=h.scrollLeft-D,W=h.scrollTop-R;t={left:t.left-H,top:t.top-W,right:t.right-H,bottom:t.bottom-W}}if(m)break}}function rt(i){let t=[],n=i.ownerDocument;for(let s=i;s&&(t.push({dom:s,top:s.scrollTop,left:s.scrollLeft}),i!=n);s=Xe(s));return t}function Yt(i,t){for(let n=0;n<i.length;n++){let{dom:s,top:l,left:a}=i[n];s.scrollTop!=l+t&&(s.scrollTop=l+t),s.scrollLeft!=a&&(s.scrollLeft=a)}}let jt=null;function hn(i,t){let n,l,s=2e8,a=0,d=t.top,h=t.top;for(let m=i.firstChild,b=0;m;m=m.nextSibling,b++){let C;if(1==m.nodeType)C=m.getClientRects();else{if(3!=m.nodeType)continue;C=$e(m).getClientRects()}for(let I=0;I<C.length;I++){let D=C[I];if(D.top<=d&&D.bottom>=h){d=Math.max(D.bottom,d),h=Math.min(D.top,h);let R=D.left>t.left?D.left-t.left:D.right<t.left?t.left-D.right:0;if(R<s){n=m,s=R,l=R&&3==n.nodeType?{left:D.right<t.left?D.right:D.left,top:t.top}:t,1==m.nodeType&&R&&(a=b+(t.left>=(D.left+D.right)/2?1:0));continue}}!n&&(t.left>=D.right&&t.top>=D.top||t.left>=D.left&&t.top>=D.bottom)&&(a=b+1)}}return n&&3==n.nodeType?function mn(i,t){let n=i.nodeValue.length,s=document.createRange();for(let l=0;l<n;l++){s.setEnd(i,l+1),s.setStart(i,l);let a=ct(s,1);if(a.top!=a.bottom&&on(t,a))return{node:i,offset:l+(t.left>=(a.left+a.right)/2?1:0)}}return{node:i,offset:0}}(n,l):!n||s&&1==n.nodeType?{node:i,offset:a}:hn(n,l)}function on(i,t){return i.left>=t.left-1&&i.left<=t.right+1&&i.top>=t.top-1&&i.top<=t.bottom+1}function St(i,t,n){let s=i.childNodes.length;if(s&&n.top<n.bottom)for(let l=Math.max(0,Math.min(s-1,Math.floor(s*(t.top-n.top)/(n.bottom-n.top))-2)),a=l;;){let d=i.childNodes[a];if(1==d.nodeType){let h=d.getClientRects();for(let m=0;m<h.length;m++){let b=h[m];if(on(t,b))return St(d,t,b)}}if((a=(a+1)%s)==l)break}return i}function In(i,t){let s,n=i.dom.ownerDocument,l=0;if(n.caretPositionFromPoint)try{let m=n.caretPositionFromPoint(t.left,t.top);m&&({offsetNode:s,offset:l}=m)}catch(m){}if(!s&&n.caretRangeFromPoint){let m=n.caretRangeFromPoint(t.left,t.top);m&&({startContainer:s,startOffset:l}=m)}let d,a=(i.root.elementFromPoint?i.root:n).elementFromPoint(t.left,t.top);if(!a||!i.dom.contains(1!=a.nodeType?a.parentNode:a)){let m=i.dom.getBoundingClientRect();if(!on(t,m)||(a=St(i.dom,t,m),!a))return null}if(e)for(let m=a;s&&m;m=Xe(m))m.draggable&&(s=void 0);if(a=function gn(i,t){let n=i.parentNode;return n&&/^li$/i.test(n.nodeName)&&t.left<i.getBoundingClientRect().left?n:i}(a,t),s){if(ve&&1==s.nodeType&&(l=Math.min(l,s.childNodes.length),l<s.childNodes.length)){let b,m=s.childNodes[l];"IMG"==m.nodeName&&(b=m.getBoundingClientRect()).right<=t.left&&b.bottom>t.top&&l++}s==i.dom&&l==s.childNodes.length-1&&1==s.lastChild.nodeType&&t.top>s.lastChild.getBoundingClientRect().bottom?d=i.state.doc.content.size:(0==l||1!=s.nodeType||"BR"!=s.childNodes[l-1].nodeName)&&(d=function At(i,t,n,s){let l=-1;for(let a=t;a!=i.dom;){let d=i.docView.nearestDesc(a,!0);if(!d)return null;if(d.node.isBlock&&d.parent){let h=d.dom.getBoundingClientRect();if(h.left>s.left||h.top>s.top)l=d.posBefore;else{if(!(h.right<s.left||h.bottom<s.top))break;l=d.posAfter}}a=d.dom.parentNode}return l>-1?l:i.docView.posFromDOM(t,n,1)}(i,s,l,t))}null==d&&(d=function Vt(i,t,n){let{node:s,offset:l}=hn(t,n),a=-1;if(1==s.nodeType&&!s.firstChild){let d=s.getBoundingClientRect();a=d.left!=d.right&&n.left>(d.left+d.right)/2?1:-1}return i.docView.posFromDOM(s,l,a)}(i,a,t));let h=i.docView.nearestDesc(a,!0);return{pos:d,inside:h?h.posAtStart-h.border:-1}}function ct(i,t){let n=i.getClientRects();return n.length?n[t<0?0:n.length-1]:i.getBoundingClientRect()}const On=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;function Dn(i,t,n){let{node:s,offset:l,atom:a}=i.docView.domFromPos(t,n<0?-1:1),d=_e||ve;if(3==s.nodeType){if(!d||!On.test(s.nodeValue)&&(n<0?l:l!=s.nodeValue.length)){let m=l,b=l,C=n<0?1:-1;return n<0&&!l?(b++,C=-1):n>=0&&l==s.nodeValue.length?(m--,C=1):n<0?m--:b++,It(ct($e(s,m,b),C),C<0)}{let m=ct($e(s,l,l),n);if(ve&&l&&/\s/.test(s.nodeValue[l-1])&&l<s.nodeValue.length){let b=ct($e(s,l-1,l-1),-1);if(b.top==m.top){let C=ct($e(s,l,l+1),-1);if(C.top!=m.top)return It(C,C.left<b.left)}}return m}}if(!i.state.doc.resolve(t-(a||0)).parent.inlineContent){if(null==a&&l&&(n<0||l==Me(s))){let m=s.childNodes[l-1];if(1==m.nodeType)return Gt(m.getBoundingClientRect(),!1)}if(null==a&&l<Me(s)){let m=s.childNodes[l];if(1==m.nodeType)return Gt(m.getBoundingClientRect(),!0)}return Gt(s.getBoundingClientRect(),n>=0)}if(null==a&&l&&(n<0||l==Me(s))){let m=s.childNodes[l-1],b=3==m.nodeType?$e(m,Me(m)-(d?0:1)):1!=m.nodeType||"BR"==m.nodeName&&m.nextSibling?null:m;if(b)return It(ct(b,1),!1)}if(null==a&&l<Me(s)){let m=s.childNodes[l];for(;m.pmViewDesc&&m.pmViewDesc.ignoreForCoords;)m=m.nextSibling;let b=m?3==m.nodeType?$e(m,0,d?0:1):1==m.nodeType?m:null:null;if(b)return It(ct(b,-1),!0)}return It(ct(3==s.nodeType?$e(s):s,-n),n>=0)}function It(i,t){if(0==i.width)return i;let n=t?i.left:i.right;return{top:i.top,bottom:i.bottom,left:n,right:n}}function Gt(i,t){if(0==i.height)return i;let n=t?i.top:i.bottom;return{top:n,bottom:n,left:i.left,right:i.right}}function En(i,t,n){let s=i.state,l=i.root.activeElement;s!=t&&i.updateState(t),l!=i.dom&&i.focus();try{return n()}finally{s!=t&&i.updateState(s),l!=i.dom&&l&&l.focus()}}const Ot=/[\u0590-\u08ac]/;let Dt=null,N=null,y=!1;class V{constructor(t,n,s,l){this.parent=t,this.children=n,this.dom=s,this.contentDOM=l,this.dirty=0,s.pmViewDesc=this}matchesWidget(t){return!1}matchesMark(t){return!1}matchesNode(t,n,s){return!1}matchesHack(t){return!1}parseRule(){return null}stopEvent(t){return!1}get size(){let t=0;for(let n=0;n<this.children.length;n++)t+=this.children[n].size;return t}get border(){return 0}destroy(){this.parent=void 0,this.dom.pmViewDesc==this&&(this.dom.pmViewDesc=void 0);for(let t=0;t<this.children.length;t++)this.children[t].destroy()}posBeforeChild(t){for(let n=0,s=this.posAtStart;;n++){let l=this.children[n];if(l==t)return s;s+=l.size}}get posBefore(){return this.parent.posBeforeChild(this)}get posAtStart(){return this.parent?this.parent.posBeforeChild(this)+this.border:0}get posAfter(){return this.posBefore+this.size}get posAtEnd(){return this.posAtStart+this.size-2*this.border}localPosFromDOM(t,n,s){if(this.contentDOM&&this.contentDOM.contains(1==t.nodeType?t:t.parentNode)){if(s<0){let a,d;if(t==this.contentDOM)a=t.childNodes[n-1];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.previousSibling}for(;a&&(!(d=a.pmViewDesc)||d.parent!=this);)a=a.previousSibling;return a?this.posBeforeChild(d)+d.size:this.posAtStart}{let a,d;if(t==this.contentDOM)a=t.childNodes[n];else{for(;t.parentNode!=this.contentDOM;)t=t.parentNode;a=t.nextSibling}for(;a&&(!(d=a.pmViewDesc)||d.parent!=this);)a=a.nextSibling;return a?this.posBeforeChild(d):this.posAtEnd}}let l;if(t==this.dom&&this.contentDOM)l=n>te(this.contentDOM);else if(this.contentDOM&&this.contentDOM!=this.dom&&this.dom.contains(this.contentDOM))l=2&t.compareDocumentPosition(this.contentDOM);else if(this.dom.firstChild){if(0==n)for(let a=t;;a=a.parentNode){if(a==this.dom){l=!1;break}if(a.previousSibling)break}if(null==l&&n==t.childNodes.length)for(let a=t;;a=a.parentNode){if(a==this.dom){l=!0;break}if(a.nextSibling)break}}return(null==l?s>0:l)?this.posAtEnd:this.posAtStart}nearestDesc(t,n=!1){for(let s=!0,l=t;l;l=l.parentNode){let d,a=this.getDesc(l);if(a&&(!n||a.node)){if(!s||!(d=a.nodeDOM)||(1==d.nodeType?d.contains(1==t.nodeType?t:t.parentNode):d==t))return a;s=!1}}}getDesc(t){let n=t.pmViewDesc;for(let s=n;s;s=s.parent)if(s==this)return n}posFromDOM(t,n,s){for(let l=t;l;l=l.parentNode){let a=this.getDesc(l);if(a)return a.localPosFromDOM(t,n,s)}return-1}descAt(t){for(let n=0,s=0;n<this.children.length;n++){let l=this.children[n],a=s+l.size;if(s==t&&a!=s){for(;!l.border&&l.children.length;)l=l.children[0];return l}if(t<a)return l.descAt(t-s-l.border);s=a}}domFromPos(t,n){if(!this.contentDOM)return{node:this.dom,offset:0,atom:t+1};let a,s=0,l=0;for(let a=0;s<this.children.length;s++){let d=this.children[s],h=a+d.size;if(h>t||d instanceof f){l=t-a;break}a=h}if(l)return this.children[s].domFromPos(l-this.children[s].border,n);for(;s&&!(a=this.children[s-1]).size&&a instanceof Z&&a.side>=0;s--);if(n<=0){let a,d=!0;for(;a=s?this.children[s-1]:null,a&&a.dom.parentNode!=this.contentDOM;s--,d=!1);return a&&n&&d&&!a.border&&!a.domAtom?a.domFromPos(a.size,n):{node:this.contentDOM,offset:a?te(a.dom)+1:0}}{let a,d=!0;for(;a=s<this.children.length?this.children[s]:null,a&&a.dom.parentNode!=this.contentDOM;s++,d=!1);return a&&d&&!a.border&&!a.domAtom?a.domFromPos(0,n):{node:this.contentDOM,offset:a?te(a.dom):this.contentDOM.childNodes.length}}}parseRange(t,n,s=0){if(0==this.children.length)return{node:this.contentDOM,from:t,to:n,fromOffset:0,toOffset:this.contentDOM.childNodes.length};let l=-1,a=-1;for(let d=s,h=0;;h++){let m=this.children[h],b=d+m.size;if(-1==l&&t<=b){let C=d+m.border;if(t>=C&&n<=b-m.border&&m.node&&m.contentDOM&&this.contentDOM.contains(m.contentDOM))return m.parseRange(t,n,C);t=d;for(let I=h;I>0;I--){let D=this.children[I-1];if(D.size&&D.dom.parentNode==this.contentDOM&&!D.emptyChildAt(1)){l=te(D.dom)+1;break}t-=D.size}-1==l&&(l=0)}if(l>-1&&(b>n||h==this.children.length-1)){n=b;for(let C=h+1;C<this.children.length;C++){let I=this.children[C];if(I.size&&I.dom.parentNode==this.contentDOM&&!I.emptyChildAt(-1)){a=te(I.dom);break}n+=I.size}-1==a&&(a=this.contentDOM.childNodes.length);break}d=b}return{node:this.contentDOM,from:t,to:n,fromOffset:l,toOffset:a}}emptyChildAt(t){if(this.border||!this.contentDOM||!this.children.length)return!1;let n=this.children[t<0?0:this.children.length-1];return 0==n.size||n.emptyChildAt(t)}domAfterPos(t){let{node:n,offset:s}=this.domFromPos(t,0);if(1!=n.nodeType||s==n.childNodes.length)throw new RangeError("No node after pos "+t);return n.childNodes[s]}setSelection(t,n,s,l=!1){let a=Math.min(t,n),d=Math.max(t,n);for(let D=0,R=0;D<this.children.length;D++){let H=this.children[D],W=R+H.size;if(a>R&&d<W)return H.setSelection(t-R-H.border,n-R-H.border,s,l);R=W}let h=this.domFromPos(t,t?-1:1),m=n==t?h:this.domFromPos(n,n?-1:1),b=s.getSelection(),C=!1;if((ve||e)&&t==n){let{node:D,offset:R}=h;if(3==D.nodeType){if(C=!(!R||"\n"!=D.nodeValue[R-1]),C&&R==D.nodeValue.length)for(let W,H=D;H;H=H.parentNode){if(W=H.nextSibling){"BR"==W.nodeName&&(h=m={node:W.parentNode,offset:te(W)+1});break}let Y=H.pmViewDesc;if(Y&&Y.node&&Y.node.isBlock)break}}else{let H=D.childNodes[R-1];C=H&&("BR"==H.nodeName||"false"==H.contentEditable)}}if(ve&&b.focusNode&&b.focusNode!=m.node&&1==b.focusNode.nodeType){let D=b.focusNode.childNodes[b.focusOffset];D&&"false"==D.contentEditable&&(l=!0)}if(!(l||C&&e)&&Ge(h.node,h.offset,b.anchorNode,b.anchorOffset)&&Ge(m.node,m.offset,b.focusNode,b.focusOffset))return;let I=!1;if((b.extend||t==n)&&!C){b.collapse(h.node,h.offset);try{t!=n&&b.extend(m.node,m.offset),I=!0}catch(D){if(!(D instanceof DOMException))throw D}}if(!I){if(t>n){let R=h;h=m,m=R}let D=document.createRange();D.setEnd(m.node,m.offset),D.setStart(h.node,h.offset),b.removeAllRanges(),b.addRange(D)}}ignoreMutation(t){return!this.contentDOM&&"selection"!=t.type}get contentLost(){return this.contentDOM&&this.contentDOM!=this.dom&&!this.dom.contains(this.contentDOM)}markDirty(t,n){for(let s=0,l=0;l<this.children.length;l++){let a=this.children[l],d=s+a.size;if(s==d?t<=d&&n>=s:t<d&&n>s){let h=s+a.border,m=d-a.border;if(t>=h&&n<=m)return this.dirty=t==s||n==d?2:1,void(t!=h||n!=m||!a.contentLost&&a.dom.parentNode==this.contentDOM?a.markDirty(t-h,n-h):a.dirty=3);a.dirty=a.dom!=a.contentDOM||a.dom.parentNode!=this.contentDOM||a.children.length?3:2}s=d}this.dirty=2}markParentsDirty(){let t=1;for(let n=this.parent;n;n=n.parent,t++){let s=1==t?2:1;n.dirty<s&&(n.dirty=s)}}get domAtom(){return!1}get ignoreForCoords(){return!1}}class Z extends V{constructor(t,n,s,l){let a,d=n.type.toDOM;if("function"==typeof d&&(d=d(s,()=>a?a.parent?a.parent.posBeforeChild(a):void 0:l)),!n.type.spec.raw){if(1!=d.nodeType){let h=document.createElement("span");h.appendChild(d),d=h}d.contentEditable="false",d.classList.add("ProseMirror-widget")}super(t,[],d,null),this.widget=n,this.widget=n,a=this}matchesWidget(t){return 0==this.dirty&&t.type.eq(this.widget.type)}parseRule(){return{ignore:!0}}stopEvent(t){let n=this.widget.spec.stopEvent;return!!n&&n(t)}ignoreMutation(t){return"selection"!=t.type||this.widget.spec.ignoreSelection}destroy(){this.widget.type.destroy(this.dom),super.destroy()}get domAtom(){return!0}get side(){return this.widget.type.side}}class ee extends V{constructor(t,n,s,l){super(t,[],n,null),this.textDOM=s,this.text=l}get size(){return this.text.length}localPosFromDOM(t,n){return t!=this.textDOM?this.posAtStart+(n?this.size:0):this.posAtStart+n}domFromPos(t){return{node:this.textDOM,offset:t}}ignoreMutation(t){return"characterData"===t.type&&t.target.nodeValue==t.oldValue}}class de extends V{constructor(t,n,s,l){super(t,[],s,l),this.mark=n}static create(t,n,s,l){let a=l.nodeViews[n.type.name],d=a&&a(n,l,s);return(!d||!d.dom)&&(d=ye.PW.renderSpec(document,n.type.spec.toDOM(n,s))),new de(t,n,d.dom,d.contentDOM||d.dom)}parseRule(){return 3&this.dirty||this.mark.type.spec.reparseInView?null:{mark:this.mark.type.name,attrs:this.mark.attrs,contentElement:this.contentDOM||void 0}}matchesMark(t){return 3!=this.dirty&&this.mark.eq(t)}markDirty(t,n){if(super.markDirty(t,n),0!=this.dirty){let s=this.parent;for(;!s.node;)s=s.parent;s.dirty<this.dirty&&(s.dirty=this.dirty),this.dirty=0}}slice(t,n,s){let l=de.create(this.parent,this.mark,!0,s),a=this.children,d=this.size;n<d&&(a=yn(a,n,d,s)),t>0&&(a=yn(a,0,t,s));for(let h=0;h<a.length;h++)a[h].parent=l;return l.children=a,l}}class me extends V{constructor(t,n,s,l,a,d,h,m,b){super(t,[],a,d),this.node=n,this.outerDeco=s,this.innerDeco=l,this.nodeDOM=h,d&&this.updateChildren(m,b)}static create(t,n,s,l,a,d){let m,h=a.nodeViews[n.type.name],b=h&&h(n,a,()=>m?m.parent?m.parent.posBeforeChild(m):void 0:d,s,l),C=b&&b.dom,I=b&&b.contentDOM;if(n.isText)if(C){if(3!=C.nodeType)throw new RangeError("Text must be rendered as a DOM text node")}else C=document.createTextNode(n.text);else C||({dom:C,contentDOM:I}=ye.PW.renderSpec(document,n.type.spec.toDOM(n)));!I&&!n.isText&&"BR"!=C.nodeName&&(C.hasAttribute("contenteditable")||(C.contentEditable="false"),n.type.spec.draggable&&(C.draggable=!0));let D=C;return C=ge(C,s,n),b?m=new g(t,n,s,l,C,I||null,D,b,a,d+1):n.isText?new c(t,n,s,l,C,D,a):new me(t,n,s,l,C,I||null,D,a,d+1)}parseRule(){if(this.node.type.spec.reparseInView)return null;let t={node:this.node.type.name,attrs:this.node.attrs};if("pre"==this.node.type.whitespace&&(t.preserveWhitespace="full"),this.contentDOM)if(this.contentLost){for(let n=this.children.length-1;n>=0;n--){let s=this.children[n];if(this.dom.contains(s.dom.parentNode)){t.contentElement=s.dom.parentNode;break}}t.contentElement||(t.getContent=()=>ye.HY.empty)}else t.contentElement=this.contentDOM;else t.getContent=()=>this.node.content;return t}matchesNode(t,n,s){return 0==this.dirty&&t.eq(this.node)&&_t(n,this.outerDeco)&&s.eq(this.innerDeco)}get size(){return this.node.nodeSize}get border(){return this.node.isLeaf?0:1}updateChildren(t,n){let s=this.node.inlineContent,l=n,a=t.composing?this.localCompositionInfo(t,n):null,d=a&&a.pos>-1?a:null,h=a&&a.pos<0,m=new sn(this,d&&d.node);(function $n(i,t,n,s){let l=t.locals(i),a=0;if(0==l.length){for(let b=0;b<i.childCount;b++){let C=i.child(b);s(C,l,t.forChild(a,C),b),a+=C.nodeSize}return}let d=0,h=[],m=null;for(let b=0;;){if(d<l.length&&l[d].to==a){let W,H=l[d++];for(;d<l.length&&l[d].to==a;)(W||(W=[H])).push(l[d++]);if(W){W.sort(_n);for(let Y=0;Y<W.length;Y++)n(W[Y],b,!!m)}else n(H,b,!!m)}let C,I;if(m)I=-1,C=m,m=null;else{if(!(b<i.childCount))break;I=b,C=i.child(b++)}for(let H=0;H<h.length;H++)h[H].to<=a&&h.splice(H--,1);for(;d<l.length&&l[d].from<=a&&l[d].to>a;)h.push(l[d++]);let D=a+C.nodeSize;if(C.isText){let H=D;d<l.length&&l[d].from<H&&(H=l[d].from);for(let W=0;W<h.length;W++)h[W].to<H&&(H=h[W].to);H<D&&(m=C.cut(H-a),C=C.cut(0,H-a),D=H,I=-1)}s(C,C.isInline&&!C.isLeaf?h.filter(H=>!H.inline):h.slice(),t.forChild(a,C),I),a=D}})(this.node,this.innerDeco,(b,C,I)=>{b.spec.marks?m.syncToMarks(b.spec.marks,s,t):b.type.side>=0&&!I&&m.syncToMarks(C==this.node.childCount?ye.vc.none:this.node.child(C).marks,s,t),m.placeWidget(b,t,l)},(b,C,I,D)=>{let R;m.syncToMarks(b.marks,s,t),m.findNodeMatch(b,C,I,D)||h&&t.state.selection.from>l&&t.state.selection.to<l+b.nodeSize&&(R=m.findIndexWithChild(a.node))>-1&&m.updateNodeAt(b,C,I,R,t)||m.updateNextNode(b,C,I,t,D)||m.addNode(b,C,I,t,l),l+=b.nodeSize}),m.syncToMarks([],s,t),this.node.isTextblock&&m.addTextblockHacks(),m.destroyRest(),(m.changed||2==this.dirty)&&(d&&this.protectLocalComposition(t,d),v(this.contentDOM,this.children,t),Ke&&function qe(i){if("UL"==i.nodeName||"OL"==i.nodeName){let t=i.style.cssText;i.style.cssText=t+"; list-style: square !important",window.getComputedStyle(i),i.style.cssText=t}}(this.dom))}localCompositionInfo(t,n){let{from:s,to:l}=t.state.selection;if(!(t.state.selection instanceof w.Bs)||s<n||l>n+this.node.content.size)return null;let a=t.domSelection(),d=function Nn(i,t){for(;;){if(3==i.nodeType)return i;if(1==i.nodeType&&t>0){if(i.childNodes.length>t&&3==i.childNodes[t].nodeType)return i.childNodes[t];t=Me(i=i.childNodes[t-1])}else{if(!(1==i.nodeType&&t<i.childNodes.length))return null;i=i.childNodes[t],t=0}}}(a.focusNode,a.focusOffset);if(!d||!this.dom.contains(d.parentNode))return null;if(this.node.inlineContent){let h=d.nodeValue,m=function Et(i,t,n,s){for(let l=0,a=0;l<i.childCount&&a<=s;){let d=i.child(l++),h=a;if(a+=d.nodeSize,!d.isText)continue;let m=d.text;for(;l<i.childCount;){let b=i.child(l++);if(a+=b.nodeSize,!b.isText)break;m+=b.text}if(a>=n){let b=h<s?m.lastIndexOf(t,s-h-1):-1;if(b>=0&&b+t.length+h>=n)return h+b;if(n==s&&m.length>=s+t.length-h&&m.slice(s-h,s-h+t.length)==t)return s}}return-1}(this.node.content,h,s-n,l-n);return m<0?null:{node:d,pos:m,text:h}}return{node:d,pos:-1,text:""}}protectLocalComposition(t,{node:n,pos:s,text:l}){if(this.getDesc(n))return;let a=n;for(;a.parentNode!=this.contentDOM;a=a.parentNode){for(;a.previousSibling;)a.parentNode.removeChild(a.previousSibling);for(;a.nextSibling;)a.parentNode.removeChild(a.nextSibling);a.pmViewDesc&&(a.pmViewDesc=void 0)}let d=new ee(this,a,n,l);t.input.compositionNodes.push(d),this.children=yn(this.children,s,s+l.length,t,d)}update(t,n,s,l){return!(3==this.dirty||!t.sameMarkup(this.node)||(this.updateInner(t,n,s,l),0))}updateInner(t,n,s,l){this.updateOuterDeco(n),this.node=t,this.innerDeco=s,this.contentDOM&&this.updateChildren(l,this.posAtStart),this.dirty=0}updateOuterDeco(t){if(_t(t,this.outerDeco))return;let n=1!=this.nodeDOM.nodeType,s=this.dom;this.dom=J(this.dom,this.nodeDOM,B(this.outerDeco,this.node,n),B(t,this.node,n)),this.dom!=s&&(s.pmViewDesc=void 0,this.dom.pmViewDesc=this),this.outerDeco=t}selectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.add("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&(this.dom.draggable=!0)}deselectNode(){1==this.nodeDOM.nodeType&&this.nodeDOM.classList.remove("ProseMirror-selectednode"),(this.contentDOM||!this.node.type.spec.draggable)&&this.dom.removeAttribute("draggable")}get domAtom(){return this.node.isAtom}}function k(i,t,n,s,l){return ge(s,t,i),new me(void 0,i,t,n,s,s,s,l,0)}class c extends me{constructor(t,n,s,l,a,d,h){super(t,n,s,l,a,null,d,h,0)}parseRule(){let t=this.nodeDOM.parentNode;for(;t&&t!=this.dom&&!t.pmIsDeco;)t=t.parentNode;return{skip:t||!0}}update(t,n,s,l){return!(3==this.dirty||0!=this.dirty&&!this.inParent()||!t.sameMarkup(this.node)||(this.updateOuterDeco(n),(0!=this.dirty||t.text!=this.node.text)&&t.text!=this.nodeDOM.nodeValue&&(this.nodeDOM.nodeValue=t.text,l.trackWrites==this.nodeDOM&&(l.trackWrites=null)),this.node=t,this.dirty=0,0))}inParent(){let t=this.parent.contentDOM;for(let n=this.nodeDOM;n;n=n.parentNode)if(n==t)return!0;return!1}domFromPos(t){return{node:this.nodeDOM,offset:t}}localPosFromDOM(t,n,s){return t==this.nodeDOM?this.posAtStart+Math.min(n,this.node.text.length):super.localPosFromDOM(t,n,s)}ignoreMutation(t){return"characterData"!=t.type&&"selection"!=t.type}slice(t,n,s){let l=this.node.cut(t,n),a=document.createTextNode(l.text);return new c(this.parent,l,this.outerDeco,this.innerDeco,a,a,s)}markDirty(t,n){super.markDirty(t,n),this.dom!=this.nodeDOM&&(0==t||n==this.nodeDOM.nodeValue.length)&&(this.dirty=3)}get domAtom(){return!1}}class f extends V{parseRule(){return{ignore:!0}}matchesHack(t){return 0==this.dirty&&this.dom.nodeName==t}get domAtom(){return!0}get ignoreForCoords(){return"IMG"==this.dom.nodeName}}class g extends me{constructor(t,n,s,l,a,d,h,m,b,C){super(t,n,s,l,a,d,h,b,C),this.spec=m}update(t,n,s,l){if(3==this.dirty)return!1;if(this.spec.update){let a=this.spec.update(t,n,s);return a&&this.updateInner(t,n,s,l),a}return!(!this.contentDOM&&!t.isLeaf)&&super.update(t,n,s,l)}selectNode(){this.spec.selectNode?this.spec.selectNode():super.selectNode()}deselectNode(){this.spec.deselectNode?this.spec.deselectNode():super.deselectNode()}setSelection(t,n,s,l){this.spec.setSelection?this.spec.setSelection(t,n,s):super.setSelection(t,n,s,l)}destroy(){this.spec.destroy&&this.spec.destroy(),super.destroy()}stopEvent(t){return!!this.spec.stopEvent&&this.spec.stopEvent(t)}ignoreMutation(t){return this.spec.ignoreMutation?this.spec.ignoreMutation(t):super.ignoreMutation(t)}}function v(i,t,n){let s=i.firstChild,l=!1;for(let a=0;a<t.length;a++){let d=t[a],h=d.dom;if(h.parentNode==i){for(;h!=s;)s=rn(s),l=!0;s=s.nextSibling}else l=!0,i.insertBefore(h,s);if(d instanceof de){let m=s?s.previousSibling:i.lastChild;v(d.contentDOM,d.children,n),s=m?m.nextSibling:i.firstChild}}for(;s;)s=rn(s),l=!0;l&&n.trackWrites==i&&(n.trackWrites=null)}const M=function(i){i&&(this.nodeName=i)};M.prototype=Object.create(null);const P=[new M];function B(i,t,n){if(0==i.length)return P;let s=n?P[0]:new M,l=[s];for(let a=0;a<i.length;a++){let d=i[a].type.attrs;if(d){d.nodeName&&l.push(s=new M(d.nodeName));for(let h in d){let m=d[h];null!=m&&(n&&1==l.length&&l.push(s=new M(t.isInline?"span":"div")),"class"==h?s.class=(s.class?s.class+" ":"")+m:"style"==h?s.style=(s.style?s.style+";":"")+m:"nodeName"!=h&&(s[h]=m))}}}return l}function J(i,t,n,s){if(n==P&&s==P)return t;let l=t;for(let a=0;a<s.length;a++){let d=s[a],h=n[a];if(a){let m;h&&h.nodeName==d.nodeName&&l!=i&&(m=l.parentNode)&&m.nodeName.toLowerCase()==d.nodeName||(m=document.createElement(d.nodeName),m.pmIsDeco=!0,m.appendChild(l),h=P[0]),l=m}K(l,h||P[0],d)}return l}function K(i,t,n){for(let s in t)"class"!=s&&"style"!=s&&"nodeName"!=s&&!(s in n)&&i.removeAttribute(s);for(let s in n)"class"!=s&&"style"!=s&&"nodeName"!=s&&n[s]!=t[s]&&i.setAttribute(s,n[s]);if(t.class!=n.class){let s=t.class?t.class.split(" ").filter(Boolean):[],l=n.class?n.class.split(" ").filter(Boolean):[];for(let a=0;a<s.length;a++)-1==l.indexOf(s[a])&&i.classList.remove(s[a]);for(let a=0;a<l.length;a++)-1==s.indexOf(l[a])&&i.classList.add(l[a]);0==i.classList.length&&i.removeAttribute("class")}if(t.style!=n.style){if(t.style){let l,s=/\s*([\w\-\xa1-\uffff]+)\s*:(?:"(?:\\.|[^"])*"|'(?:\\.|[^'])*'|\(.*?\)|[^;])*/g;for(;l=s.exec(t.style);)i.style.removeProperty(l[1])}n.style&&(i.style.cssText+=n.style)}}function ge(i,t,n){return J(i,i,P,B(t,n,1!=i.nodeType))}function _t(i,t){if(i.length!=t.length)return!1;for(let n=0;n<i.length;n++)if(!i[n].type.eq(t[n].type))return!1;return!0}function rn(i){let t=i.nextSibling;return i.parentNode.removeChild(i),t}class sn{constructor(t,n){this.lock=n,this.index=0,this.stack=[],this.changed=!1,this.top=t,this.preMatch=function Ki(i,t){let n=t,s=n.children.length,l=i.childCount,a=new Map,d=[];e:for(;l>0;){let h;for(;;)if(s){let b=n.children[s-1];if(!(b instanceof de)){h=b,s--;break}n=b,s=b.children.length}else{if(n==t)break e;s=n.parent.children.indexOf(n),n=n.parent}let m=h.node;if(m){if(m!=i.child(l-1))break;--l,a.set(h,l),d.push(h)}}return{index:l,matched:a,matches:d.reverse()}}(t.node.content,t)}destroyBetween(t,n){if(t!=n){for(let s=t;s<n;s++)this.top.children[s].destroy();this.top.children.splice(t,n-t),this.changed=!0}}destroyRest(){this.destroyBetween(this.index,this.top.children.length)}syncToMarks(t,n,s){let l=0,a=this.stack.length>>1,d=Math.min(a,t.length);for(;l<d&&(l==a-1?this.top:this.stack[l+1<<1]).matchesMark(t[l])&&!1!==t[l].type.spec.spanning;)l++;for(;l<a;)this.destroyRest(),this.top.dirty=0,this.index=this.stack.pop(),this.top=this.stack.pop(),a--;for(;a<t.length;){this.stack.push(this.top,this.index+1);let h=-1;for(let m=this.index;m<Math.min(this.index+3,this.top.children.length);m++)if(this.top.children[m].matchesMark(t[a])){h=m;break}if(h>-1)h>this.index&&(this.changed=!0,this.destroyBetween(this.index,h)),this.top=this.top.children[this.index];else{let m=de.create(this.top,t[a],n,s);this.top.children.splice(this.index,0,m),this.top=m,this.changed=!0}this.index=0,a++}}findNodeMatch(t,n,s,l){let d,a=-1;if(l>=this.preMatch.index&&(d=this.preMatch.matches[l-this.preMatch.index]).parent==this.top&&d.matchesNode(t,n,s))a=this.top.children.indexOf(d,this.index);else for(let h=this.index,m=Math.min(this.top.children.length,h+5);h<m;h++){let b=this.top.children[h];if(b.matchesNode(t,n,s)&&!this.preMatch.matched.has(b)){a=h;break}}return!(a<0||(this.destroyBetween(this.index,a),this.index++,0))}updateNodeAt(t,n,s,l,a){let d=this.top.children[l];return 3==d.dirty&&d.dom==d.contentDOM&&(d.dirty=2),!!d.update(t,n,s,a)&&(this.destroyBetween(this.index,l),this.index++,!0)}findIndexWithChild(t){for(;;){let n=t.parentNode;if(!n)return-1;if(n==this.top.contentDOM){let s=t.pmViewDesc;if(s)for(let l=this.index;l<this.top.children.length;l++)if(this.top.children[l]==s)return l;return-1}t=n}}updateNextNode(t,n,s,l,a){for(let d=this.index;d<this.top.children.length;d++){let h=this.top.children[d];if(h instanceof me){let m=this.preMatch.matched.get(h);if(null!=m&&m!=a)return!1;let b=h.dom;if((!this.lock||!(b==this.lock||1==b.nodeType&&b.contains(this.lock.parentNode))||t.isText&&h.node&&h.node.isText&&h.nodeDOM.nodeValue==t.text&&3!=h.dirty&&_t(n,h.outerDeco))&&h.update(t,n,s,l))return this.destroyBetween(this.index,d),h.dom!=b&&(this.changed=!0),this.index++,!0;break}}return!1}addNode(t,n,s,l,a){this.top.children.splice(this.index++,0,me.create(this.top,t,n,s,l,a)),this.changed=!0}placeWidget(t,n,s){let l=this.index<this.top.children.length?this.top.children[this.index]:null;if(!l||!l.matchesWidget(t)||t!=l.widget&&l.widget.type.toDOM.parentNode){let a=new Z(this.top,t,n,s);this.top.children.splice(this.index++,0,a),this.changed=!0}else this.index++}addTextblockHacks(){let t=this.top.children[this.index-1],n=this.top;for(;t instanceof de;)n=t,t=n.children[n.children.length-1];(!t||!(t instanceof c)||/\n$/.test(t.node.text))&&((e||Se)&&t&&"false"==t.dom.contentEditable&&this.addHackNode("IMG",n),this.addHackNode("BR",this.top))}addHackNode(t,n){if(n==this.top&&this.index<n.children.length&&n.children[this.index].matchesHack(t))this.index++;else{let s=document.createElement(t);"IMG"==t&&(s.className="ProseMirror-separator",s.alt=""),"BR"==t&&(s.className="ProseMirror-trailingBreak");let l=new f(this.top,[],s,null);n!=this.top?n.children.push(l):n.children.splice(this.index++,0,l),this.changed=!0}}}function _n(i,t){return i.type.side-t.type.side}function yn(i,t,n,s,l){let a=[];for(let d=0,h=0;d<i.length;d++){let m=i[d],b=h,C=h+=m.size;b>=n||C<=t?a.push(m):(b<t&&a.push(m.slice(0,t-b,s)),l&&(a.push(l),l=void 0),C>n&&a.push(m.slice(n-b,m.size,s)))}return a}function Cn(i,t=null){let n=i.domSelection(),s=i.state.doc;if(!n.focusNode)return null;let l=i.docView.nearestDesc(n.focusNode),a=l&&0==l.size,d=i.docView.posFromDOM(n.focusNode,n.focusOffset,1);if(d<0)return null;let m,b,h=s.resolve(d);if(L(n)){for(m=h;l&&!l.node;)l=l.parent;let C=l.node;if(l&&C.isAtom&&w.qv.isSelectable(C)&&l.parent&&(!C.isInline||!function re(i,t,n){for(let s=0==t,l=t==Me(i);s||l;){if(i==n)return!0;let a=te(i);if(!(i=i.parentNode))return!1;s=s&&0==a,l=l&&a==Me(i)}}(n.focusNode,n.focusOffset,l.dom))){let I=l.posBefore;b=new w.qv(d==I?h:s.resolve(I))}}else{let C=i.docView.posFromDOM(n.anchorNode,n.anchorOffset,1);if(C<0)return null;m=s.resolve(C)}return b||(b=ai(i,m,h,"pointer"==t||i.state.selection.head<h.pos&&!a?1:-1)),b}function kt(i){return i.editable?i.hasFocus():ci(i)&&document.activeElement&&document.activeElement.contains(i.dom)}function ln(i,t=!1){let n=i.state.selection;if(li(i,n),kt(i)){if(!t&&i.input.mouseDown&&i.input.mouseDown.allowDefault&&Se){let s=i.domSelection(),l=i.domObserver.currentSelection;if(s.anchorNode&&l.anchorNode&&Ge(s.anchorNode,s.anchorOffset,l.anchorNode,l.anchorOffset))return i.input.mouseDown.delayedSelectionSync=!0,void i.domObserver.setCurSelection()}if(i.domObserver.disconnectSelection(),i.cursorWrapper)!function Ri(i){let t=i.domSelection(),n=document.createRange(),s=i.cursorWrapper.dom,l="IMG"==s.nodeName;l?n.setEnd(s.parentNode,te(s)+1):n.setEnd(s,0),n.collapse(!1),t.removeAllRanges(),t.addRange(n),!l&&!i.state.selection.visible&&Te&&ke<=11&&(s.disabled=!0,s.disabled=!1)}(i);else{let a,d,{anchor:s,head:l}=n;oi&&!(n instanceof w.Bs)&&(n.$from.parent.inlineContent||(a=ri(i,n.from)),!n.empty&&!n.$from.parent.inlineContent&&(d=ri(i,n.to))),i.docView.setSelection(s,l,i.root,t),oi&&(a&&si(a),d&&si(d)),n.visible?i.dom.classList.remove("ProseMirror-hideselection"):(i.dom.classList.add("ProseMirror-hideselection"),"onselectionchange"in document&&function Ni(i){let t=i.dom.ownerDocument;t.removeEventListener("selectionchange",i.input.hideSelectionGuard);let n=i.domSelection(),s=n.anchorNode,l=n.anchorOffset;t.addEventListener("selectionchange",i.input.hideSelectionGuard=()=>{(n.anchorNode!=s||n.anchorOffset!=l)&&(t.removeEventListener("selectionchange",i.input.hideSelectionGuard),setTimeout(()=>{(!kt(i)||i.state.selection.visible)&&i.dom.classList.remove("ProseMirror-hideselection")},20))})}(i))}i.domObserver.setCurSelection(),i.domObserver.connectSelection()}}const oi=e||Se&&ot<63;function ri(i,t){let{node:n,offset:s}=i.docView.domFromPos(t,0),l=s<n.childNodes.length?n.childNodes[s]:null,a=s?n.childNodes[s-1]:null;if(e&&l&&"false"==l.contentEditable)return Ne(l);if(!(l&&"false"!=l.contentEditable||a&&"false"!=a.contentEditable)){if(l)return Ne(l);if(a)return Ne(a)}}function Ne(i){return i.contentEditable="true",e&&i.draggable&&(i.draggable=!1,i.wasDraggable=!0),i}function si(i){i.contentEditable="false",i.wasDraggable&&(i.draggable=!0,i.wasDraggable=null)}function li(i,t){if(t instanceof w.qv){let n=i.docView.descAt(t.from);n!=i.lastSelectedViewDesc&&($t(i),n&&n.selectNode(),i.lastSelectedViewDesc=n)}else $t(i)}function $t(i){i.lastSelectedViewDesc&&(i.lastSelectedViewDesc.parent&&i.lastSelectedViewDesc.deselectNode(),i.lastSelectedViewDesc=void 0)}function ai(i,t,n,s){return i.someProp("createSelectionBetween",l=>l(i,t,n))||w.Bs.between(t,n,s)}function Zt(i){return(!i.editable||i.root.activeElement==i.dom)&&ci(i)}function ci(i){let t=i.domSelection();if(!t.anchorNode)return!1;try{return i.dom.contains(3==t.anchorNode.nodeType?t.anchorNode.parentNode:t.anchorNode)&&(i.editable||i.dom.contains(3==t.focusNode.nodeType?t.focusNode.parentNode:t.focusNode))}catch(n){return!1}}function Be(i,t){let{$anchor:n,$head:s}=i.selection,l=t>0?n.max(s):n.min(s),a=l.parent.inlineContent?l.depth?i.doc.resolve(t>0?l.after():l.before()):null:l;return a&&w.Y1.findFrom(a,t)}function dt(i,t){return i.dispatch(i.state.tr.setSelection(t).scrollIntoView()),!0}function Ai(i,t,n){let s=i.state.selection;if(!(s instanceof w.Bs)){if(s instanceof w.qv&&s.node.isInline)return dt(i,new w.Bs(t>0?s.$to:s.$from));{let l=Be(i.state,t);return!!l&&dt(i,l)}}if(!s.empty||n.indexOf("s")>-1)return!1;if(i.endOfTextblock(t>0?"right":"left")){let l=Be(i.state,t);return!!(l&&l instanceof w.qv)&&dt(i,l)}if(!(Ie&&n.indexOf("m")>-1)){let d,l=s.$head,a=l.textOffset?null:t<0?l.nodeBefore:l.nodeAfter;if(!a||a.isText)return!1;let h=t<0?l.pos-a.nodeSize:l.pos;return!!(a.isAtom||(d=i.docView.descAt(h))&&!d.contentDOM)&&(w.qv.isSelectable(a)?dt(i,new w.qv(t<0?i.state.doc.resolve(l.pos-a.nodeSize):l)):!!_e&&dt(i,new w.Bs(i.state.doc.resolve(t<0?h:h+a.nodeSize))))}}function Wn(i){return 3==i.nodeType?i.nodeValue.length:i.childNodes.length}function Rn(i){let t=i.pmViewDesc;return t&&0==t.size&&(i.nextSibling||"BR"!=i.nodeName)}function Jn(i){let t=i.domSelection(),n=t.focusNode,s=t.focusOffset;if(!n)return;let l,a,d=!1;for(ve&&1==n.nodeType&&s<Wn(n)&&Rn(n.childNodes[s])&&(d=!0);;)if(s>0){if(1!=n.nodeType)break;{let h=n.childNodes[s-1];if(Rn(h))l=n,a=--s;else{if(3!=h.nodeType)break;n=h,s=n.nodeValue.length}}}else{if(Bt(n))break;{let h=n.previousSibling;for(;h&&Rn(h);)l=n.parentNode,a=te(h),h=h.previousSibling;if(h)n=h,s=Wn(n);else{if(n=n.parentNode,n==i.dom)break;s=0}}}d?Yn(i,t,n,s):l&&Yn(i,t,l,a)}function Kn(i){let t=i.domSelection(),n=t.focusNode,s=t.focusOffset;if(!n)return;let a,d,l=Wn(n);for(;;)if(s<l){if(1!=n.nodeType)break;if(!Rn(n.childNodes[s]))break;a=n,d=++s}else{if(Bt(n))break;{let h=n.nextSibling;for(;h&&Rn(h);)a=h.parentNode,d=te(h)+1,h=h.nextSibling;if(h)n=h,s=0,l=Wn(n);else{if(n=n.parentNode,n==i.dom)break;s=l=0}}}a&&Yn(i,t,a,d)}function Bt(i){let t=i.pmViewDesc;return t&&t.node&&t.node.isBlock}function Yn(i,t,n,s){if(L(t)){let a=document.createRange();a.setEnd(n,s),a.setStart(n,s),t.removeAllRanges(),t.addRange(a)}else t.extend&&t.extend(n,s);i.domObserver.setCurSelection();let{state:l}=i;setTimeout(()=>{i.state==l&&ln(i)},50)}function wt(i,t,n){let s=i.state.selection;if(s instanceof w.Bs&&!s.empty||n.indexOf("s")>-1||Ie&&n.indexOf("m")>-1)return!1;let{$from:l,$to:a}=s;if(!l.parent.inlineContent||i.endOfTextblock(t<0?"up":"down")){let d=Be(i.state,t);if(d&&d instanceof w.qv)return dt(i,d)}if(!l.parent.inlineContent){let d=t<0?l:a,h=s instanceof w.C1?w.Y1.near(d,t):w.Y1.findFrom(d,t);return!!h&&dt(i,h)}return!1}function ui(i,t){if(!(i.state.selection instanceof w.Bs))return!0;let{$head:n,$anchor:s,empty:l}=i.state.selection;if(!n.sameParent(s))return!0;if(!l)return!1;if(i.endOfTextblock(t>0?"forward":"backward"))return!0;let a=!n.textOffset&&(t<0?n.nodeBefore:n.nodeAfter);if(a&&!a.isText){let d=i.state.tr;return t<0?d.delete(n.pos-a.nodeSize,n.pos):d.delete(n.pos,n.pos+a.nodeSize),i.dispatch(d),!0}return!1}function di(i,t,n){i.domObserver.stop(),t.contentEditable=n,i.domObserver.start()}function Fi(i,t){let n=[],{content:s,openStart:l,openEnd:a}=t;for(;l>1&&a>1&&1==s.childCount&&1==s.firstChild.childCount;){l--,a--;let R=s.firstChild;n.push(R.type.name,R.attrs!=R.type.defaultAttrs?R.attrs:null),s=R.content}let d=i.someProp("clipboardSerializer")||ye.PW.fromSchema(i.state.schema),h=mi(),m=h.createElement("div");m.appendChild(d.serializeFragment(s,{document:h}));let C,b=m.firstChild,I=0;for(;b&&1==b.nodeType&&(C=Ut[b.nodeName.toLowerCase()]);){for(let R=C.length-1;R>=0;R--){let H=h.createElement(C[R]);for(;m.firstChild;)H.appendChild(m.firstChild);m.appendChild(H),I++}b=m.firstChild}return b&&1==b.nodeType&&b.setAttribute("data-pm-slice",`${l} ${a}${I?` -${I}`:""} ${JSON.stringify(n)}`),{dom:m,text:i.someProp("clipboardTextSerializer",R=>R(t))||t.content.textBetween(0,t.content.size,"\n\n")}}function pi(i,t,n,s,l){let d,h,a=l.parent.type.spec.code;if(!n&&!t)return null;let m=t&&(s||a||!n);if(m){if(i.someProp("transformPastedText",D=>{t=D(t,a||s)}),a)return t?new ye.p2(ye.HY.from(i.state.schema.text(t.replace(/\r\n?/g,"\n"))),0,0):ye.p2.empty;let I=i.someProp("clipboardTextParser",D=>D(t,l,s));if(I)h=I;else{let D=l.marks(),{schema:R}=i.state,H=ye.PW.fromSchema(R);d=document.createElement("div"),t.split(/(?:\r\n?|\n)+/).forEach(W=>{let Y=d.appendChild(document.createElement("p"));W&&Y.appendChild(H.serializeNode(R.text(W,D)))})}}else i.someProp("transformPastedHTML",I=>{n=I(n)}),d=function Zi(i){let t=/^(\s*<meta [^>]*>)*/.exec(i);t&&(i=i.slice(t[0].length));let l,n=mi().createElement("div"),s=/<([a-z][^>\s]+)/i.exec(i);if((l=s&&Ut[s[1].toLowerCase()])&&(i=l.map(a=>"<"+a+">").join("")+i+l.map(a=>"</"+a+">").reverse().join("")),n.innerHTML=i,l)for(let a=0;a<l.length;a++)n=n.querySelector(l[a])||n;return n}(n),_e&&function Zn(i){let t=i.querySelectorAll(Se?"span:not([class]):not([style])":"span.Apple-converted-space");for(let n=0;n<t.length;n++){let s=t[n];1==s.childNodes.length&&"\xa0"==s.textContent&&s.parentNode&&s.parentNode.replaceChild(i.ownerDocument.createTextNode(" "),s)}}(d);let b=d&&d.querySelector("[data-pm-slice]"),C=b&&/^(\d+) (\d+)(?: -(\d+))? (.*)/.exec(b.getAttribute("data-pm-slice")||"");if(C&&C[3])for(let I=+C[3];I>0&&d.firstChild;I--)d=d.firstChild;if(h||(h=(i.someProp("clipboardParser")||i.someProp("domParser")||ye.aw.fromSchema(i.state.schema)).parseSlice(d,{preserveWhitespace:!(!m&&!C),context:l,ruleFromNode:D=>"BR"!=D.nodeName||D.nextSibling||!D.parentNode||Yi.test(D.parentNode.nodeName)?null:{ignore:!0}})),C)h=function Li(i,t){if(!i.size)return i;let s,n=i.content.firstChild.type.schema;try{s=JSON.parse(t)}catch(h){return i}let{content:l,openStart:a,openEnd:d}=i;for(let h=s.length-2;h>=0;h-=2){let m=n.nodes[s[h]];if(!m||m.hasRequiredAttrs())break;l=ye.HY.from(m.create(s[h+1],l)),a++,d++}return new ye.p2(l,a,d)}(qt(h,+C[1],+C[2]),C[4]);else if(h=ye.p2.maxOpen(function Gi(i,t){if(i.childCount<2)return i;for(let n=t.depth;n>=0;n--){let a,l=t.node(n).contentMatchAt(t.index(n)),d=[];if(i.forEach(h=>{if(!d)return;let b,m=l.findWrapping(h.type);if(!m)return d=null;if(b=d.length&&a.length&&fi(m,a,h,d[d.length-1],0))d[d.length-1]=b;else{d.length&&(d[d.length-1]=hi(d[d.length-1],a.length));let C=zi(h,m);d.push(C),l=l.matchType(C.type),a=m}}),d)return ye.HY.from(d)}return i}(h.content,l),!0),h.openStart||h.openEnd){let I=0,D=0;for(let R=h.content.firstChild;I<h.openStart&&!R.type.spec.isolating;I++,R=R.firstChild);for(let R=h.content.lastChild;D<h.openEnd&&!R.type.spec.isolating;D++,R=R.lastChild);h=qt(h,I,D)}return i.someProp("transformPasted",I=>{h=I(h)}),h}const Yi=/^(a|abbr|acronym|b|cite|code|del|em|i|ins|kbd|label|output|q|ruby|s|samp|span|strong|sub|sup|time|u|tt|var)$/i;function zi(i,t,n=0){for(let s=t.length-1;s>=n;s--)i=t[s].create(null,ye.HY.from(i));return i}function fi(i,t,n,s,l){if(l<i.length&&l<t.length&&i[l]==t[l]){let a=fi(i,t,n,s.lastChild,l+1);if(a)return s.copy(s.content.replaceChild(s.childCount-1,a));if(s.contentMatchAt(s.childCount).matchType(l==i.length-1?n.type:i[l+1]))return s.copy(s.content.append(ye.HY.from(zi(n,i,l+1))))}}function hi(i,t){if(0==t)return i;let n=i.content.replaceChild(i.childCount-1,hi(i.lastChild,t-1)),s=i.contentMatchAt(i.childCount).fillBefore(ye.HY.empty,!0);return i.copy(n.append(s))}function Xt(i,t,n,s,l,a){let d=t<0?i.firstChild:i.lastChild,h=d.content;return l<s-1&&(h=Xt(h,t,n,s,l+1,a)),l>=n&&(h=t<0?d.contentMatchAt(0).fillBefore(h,i.childCount>1||a<=l).append(h):h.append(d.contentMatchAt(d.childCount).fillBefore(ye.HY.empty,!0))),i.replaceChild(t<0?0:i.childCount-1,d.copy(h))}function qt(i,t,n){return t<i.openStart&&(i=new ye.p2(Xt(i.content,-1,t,i.openStart,0,i.openEnd),t,i.openEnd)),n<i.openEnd&&(i=new ye.p2(Xt(i.content,1,n,i.openEnd,0,0),i.openStart,n)),i}const Ut={thead:["table"],tbody:["table"],tfoot:["table"],caption:["table"],colgroup:["table"],col:["table","colgroup"],tr:["table","tbody"],td:["table","tbody","tr"],th:["table","tbody","tr"]};let it=null;function mi(){return it||(it=document.implementation.createHTMLDocument("title"))}const ft={};let ht={};class Qi{constructor(){this.shiftKey=!1,this.mouseDown=null,this.lastKeyCode=null,this.lastKeyCodeTime=0,this.lastClick={time:0,x:0,y:0,type:""},this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastIOSEnter=0,this.lastIOSEnterFallbackTimeout=-1,this.lastAndroidDelete=0,this.composing=!1,this.composingTimeout=-1,this.compositionNodes=[],this.compositionEndedAt=-2e8,this.domChangeCount=0,this.eventHandlers=Object.create(null),this.hideSelectionGuard=null}}function U(i,t){i.input.lastSelectionOrigin=t,i.input.lastSelectionTime=Date.now()}function An(i){i.someProp("handleDOMEvents",t=>{for(let n in t)i.input.eventHandlers[n]||i.dom.addEventListener(n,i.input.eventHandlers[n]=s=>Ft(i,s))})}function Ft(i,t){return i.someProp("handleDOMEvents",n=>{let s=n[t.type];return!!s&&(s(i,t)||t.defaultPrevented)})}function ce(i,t){if(!t.bubbles)return!0;if(t.defaultPrevented)return!1;for(let n=t.target;n!=i.dom;n=n.parentNode)if(!n||11==n.nodeType||n.pmViewDesc&&n.pmViewDesc.stopEvent(t))return!1;return!0}function Pt(i){return{left:i.clientX,top:i.clientY}}function gi(i,t,n,s,l){if(-1==s)return!1;let a=i.state.doc.resolve(s);for(let d=a.depth+1;d>0;d--)if(i.someProp(t,h=>d>a.depth?h(i,n,a.nodeAfter,a.before(d),l,!0):h(i,n,a.node(d),a.before(d),l,!1)))return!0;return!1}function mt(i,t,n){i.focused||i.focus();let s=i.state.tr.setSelection(t);"pointer"==n&&s.setMeta("pointer",!0),i.dispatch(s)}function yi(i,t,n,s){return gi(i,"handleDoubleClickOn",t,n,s)||i.someProp("handleDoubleClick",l=>l(i,t,s))}function fo(i,t,n,s){return gi(i,"handleTripleClickOn",t,n,s)||i.someProp("handleTripleClick",l=>l(i,t,s))||function bn(i,t,n){if(0!=n.button)return!1;let s=i.state.doc;if(-1==t)return!!s.inlineContent&&(mt(i,w.Bs.create(s,0,s.content.size),"pointer"),!0);let l=s.resolve(t);for(let a=l.depth+1;a>0;a--){let d=a>l.depth?l.nodeAfter:l.node(a),h=l.before(a);if(d.inlineContent)mt(i,w.Bs.create(s,h+1,h+1+d.content.size),"pointer");else{if(!w.qv.isSelectable(d))continue;mt(i,w.qv.create(s,h),"pointer")}return!0}}(i,n,s)}function xt(i){return an(i)}ht.keydown=(i,t)=>{let n=t;if(i.input.shiftKey=16==n.keyCode||n.shiftKey,!Fn(i,n)&&(i.input.lastKeyCode=n.keyCode,i.input.lastKeyCodeTime=Date.now(),!fe||!Se||13!=n.keyCode))if(229!=n.keyCode&&i.domObserver.forceFlush(),!Ke||13!=n.keyCode||n.ctrlKey||n.altKey||n.metaKey)i.someProp("handleKeyDown",s=>s(i,n))||function Qt(i,t){let n=t.keyCode,s=function Gn(i){let t="";return i.ctrlKey&&(t+="c"),i.metaKey&&(t+="m"),i.altKey&&(t+="a"),i.shiftKey&&(t+="s"),t}(t);return 8==n||Ie&&72==n&&"c"==s?ui(i,-1)||Jn(i):46==n||Ie&&68==n&&"c"==s?ui(i,1)||Kn(i):13==n||27==n||(37==n||Ie&&66==n&&"c"==s?Ai(i,-1,s)||Jn(i):39==n||Ie&&70==n&&"c"==s?Ai(i,1,s)||Kn(i):38==n||Ie&&80==n&&"c"==s?wt(i,-1,s)||Jn(i):40==n||Ie&&78==n&&"c"==s?function Bi(i){if(!e||i.state.selection.$head.parentOffset>0)return!1;let{focusNode:t,focusOffset:n}=i.domSelection();if(t&&1==t.nodeType&&0==n&&t.firstChild&&"false"==t.firstChild.contentEditable){let s=t.firstChild;di(i,s,"true"),setTimeout(()=>di(i,s,"false"),20)}return!1}(i)||wt(i,1,s)||Kn(i):s==(Ie?"m":"c")&&(66==n||73==n||89==n||90==n))}(i,n)?n.preventDefault():U(i,"key");else{let s=Date.now();i.input.lastIOSEnter=s,i.input.lastIOSEnterFallbackTimeout=setTimeout(()=>{i.input.lastIOSEnter==s&&(i.someProp("handleKeyDown",l=>l(i,$(13,"Enter"))),i.input.lastIOSEnter=0)},200)}},ht.keyup=(i,t)=>{16==t.keyCode&&(i.input.shiftKey=!1)},ht.keypress=(i,t)=>{let n=t;if(Fn(i,n)||!n.charCode||n.ctrlKey&&!n.altKey||Ie&&n.metaKey)return;if(i.someProp("handleKeyPress",l=>l(i,n)))return void n.preventDefault();let s=i.state.selection;if(!(s instanceof w.Bs&&s.$from.sameParent(s.$to))){let l=String.fromCharCode(n.charCode);i.someProp("handleTextInput",a=>a(i,s.$from.pos,s.$to.pos,l))||i.dispatch(i.state.tr.insertText(l).scrollIntoView()),n.preventDefault()}};const Ci=Ie?"metaKey":"ctrlKey";ft.mousedown=(i,t)=>{let n=t;i.input.shiftKey=n.shiftKey;let s=xt(i),l=Date.now(),a="singleClick";l-i.input.lastClick.time<500&&function Bn(i,t){let n=t.x-i.clientX,s=t.y-i.clientY;return n*n+s*s<100}(n,i.input.lastClick)&&!n[Ci]&&("singleClick"==i.input.lastClick.type?a="doubleClick":"doubleClick"==i.input.lastClick.type&&(a="tripleClick")),i.input.lastClick={time:l,x:n.clientX,y:n.clientY,type:a};let d=i.posAtCoords(Pt(n));!d||("singleClick"==a?(i.input.mouseDown&&i.input.mouseDown.done(),i.input.mouseDown=new Hi(i,d,n,!!s)):("doubleClick"==a?yi:fo)(i,d.pos,d.inside,n)?n.preventDefault():U(i,"pointer"))};class Hi{constructor(t,n,s,l){let a,d;if(this.view=t,this.pos=n,this.event=s,this.flushed=l,this.delayedSelectionSync=!1,this.mightDrag=null,this.startDoc=t.state.doc,this.selectNode=!!s[Ci],this.allowDefault=s.shiftKey,n.inside>-1)a=t.state.doc.nodeAt(n.inside),d=n.inside;else{let C=t.state.doc.resolve(n.pos);a=C.parent,d=C.depth?C.before():0}const h=l?null:s.target,m=h?t.docView.nearestDesc(h,!0):null;this.target=m?m.dom:null;let{selection:b}=t.state;(0==s.button&&a.type.spec.draggable&&!1!==a.type.spec.selectable||b instanceof w.qv&&b.from<=d&&b.to>d)&&(this.mightDrag={node:a,pos:d,addAttr:!(!this.target||this.target.draggable),setUneditable:!(!this.target||!ve||this.target.hasAttribute("contentEditable"))}),this.target&&this.mightDrag&&(this.mightDrag.addAttr||this.mightDrag.setUneditable)&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&(this.target.draggable=!0),this.mightDrag.setUneditable&&setTimeout(()=>{this.view.input.mouseDown==this&&this.target.setAttribute("contentEditable","false")},20),this.view.domObserver.start()),t.root.addEventListener("mouseup",this.up=this.up.bind(this)),t.root.addEventListener("mousemove",this.move=this.move.bind(this)),U(t,"pointer")}done(){this.view.root.removeEventListener("mouseup",this.up),this.view.root.removeEventListener("mousemove",this.move),this.mightDrag&&this.target&&(this.view.domObserver.stop(),this.mightDrag.addAttr&&this.target.removeAttribute("draggable"),this.mightDrag.setUneditable&&this.target.removeAttribute("contentEditable"),this.view.domObserver.start()),this.delayedSelectionSync&&setTimeout(()=>ln(this.view)),this.view.input.mouseDown=null}up(t){if(this.done(),!this.view.dom.contains(t.target))return;let n=this.pos;this.view.state.doc!=this.startDoc&&(n=this.view.posAtCoords(Pt(t))),this.allowDefault||!n?U(this.view,"pointer"):function qi(i,t,n,s,l){return gi(i,"handleClickOn",t,n,s)||i.someProp("handleClick",a=>a(i,t,s))||(l?function _i(i,t){if(-1==t)return!1;let s,l,n=i.state.selection;n instanceof w.qv&&(s=n.node);let a=i.state.doc.resolve(t);for(let d=a.depth+1;d>0;d--){let h=d>a.depth?a.nodeAfter:a.node(d);if(w.qv.isSelectable(h)){l=s&&n.$from.depth>0&&d>=n.$from.depth&&a.before(n.$from.depth+1)==n.$from.pos?a.before(n.$from.depth):a.before(d);break}}return null!=l&&(mt(i,w.qv.create(i.state.doc,l),"pointer"),!0)}(i,n):function vt(i,t){if(-1==t)return!1;let n=i.state.doc.resolve(t),s=n.nodeAfter;return!!(s&&s.isAtom&&w.qv.isSelectable(s))&&(mt(i,new w.qv(n),"pointer"),!0)}(i,n))}(this.view,n.pos,n.inside,t,this.selectNode)?t.preventDefault():0==t.button&&(this.flushed||e&&this.mightDrag&&!this.mightDrag.node.isAtom||Se&&!(this.view.state.selection instanceof w.Bs)&&Math.min(Math.abs(n.pos-this.view.state.selection.from),Math.abs(n.pos-this.view.state.selection.to))<=2)?(mt(this.view,w.Y1.near(this.view.state.doc.resolve(n.pos)),"pointer"),t.preventDefault()):U(this.view,"pointer")}move(t){!this.allowDefault&&(Math.abs(this.event.x-t.clientX)>4||Math.abs(this.event.y-t.clientY)>4)&&(this.allowDefault=!0),U(this.view,"pointer"),0==t.buttons&&this.done()}}function Fn(i,t){return!!i.composing||!!(e&&Math.abs(t.timeStamp-i.input.compositionEndedAt)<500)&&(i.input.compositionEndedAt=-2e8,!0)}ft.touchdown=i=>{xt(i),U(i,"pointer")},ft.contextmenu=i=>xt(i);const bi=fe?5e3:-1;function vi(i,t){clearTimeout(i.input.composingTimeout),t>-1&&(i.input.composingTimeout=setTimeout(()=>an(i),t))}function xi(i){for(i.composing&&(i.input.composing=!1,i.input.compositionEndedAt=function ji(){let i=document.createEvent("Event");return i.initEvent("event",!0,!0),i.timeStamp}());i.input.compositionNodes.length>0;)i.input.compositionNodes.pop().markParentsDirty()}function an(i,t=!1){if(!(fe&&i.domObserver.flushingSoon>=0)){if(i.domObserver.forceFlush(),xi(i),t||i.docView&&i.docView.dirty){let n=Cn(i);return n&&!n.eq(i.state.selection)?i.dispatch(i.state.tr.setSelection(n)):i.updateState(i.state),!0}return!1}}ht.compositionstart=ht.compositionupdate=i=>{if(!i.composing){i.domObserver.flush();let{state:t}=i,n=t.selection.$from;if(t.selection.empty&&(t.storedMarks||!n.textOffset&&n.parentOffset&&n.nodeBefore.marks.some(s=>!1===s.type.spec.inclusive)))i.markCursor=i.state.storedMarks||n.marks(),an(i,!0),i.markCursor=null;else if(an(i),ve&&t.selection.empty&&n.parentOffset&&!n.textOffset&&n.nodeBefore.marks.length){let s=i.domSelection();for(let l=s.focusNode,a=s.focusOffset;l&&1==l.nodeType&&0!=a;){let d=a<0?l.lastChild:l.childNodes[a-1];if(!d)break;if(3==d.nodeType){s.collapse(d,d.nodeValue.length);break}l=d,a=-1}}i.input.composing=!0}vi(i,bi)},ht.compositionend=(i,t)=>{i.composing&&(i.input.composing=!1,i.input.compositionEndedAt=t.timeStamp,vi(i,20))};const zn=Te&&ke<15||Ke&&le<604;function Ze(i,t,n,s){let l=pi(i,t,n,i.input.shiftKey,i.state.selection.$from);if(i.someProp("handlePaste",h=>h(i,s,l||ye.p2.empty)))return!0;if(!l)return!1;let a=function Nt(i){return 0==i.openStart&&0==i.openEnd&&1==i.content.childCount?i.content.firstChild:null}(l),d=a?i.state.tr.replaceSelectionWith(a,i.input.shiftKey):i.state.tr.replaceSelection(l);return i.dispatch(d.scrollIntoView().setMeta("paste",!0).setMeta("uiEvent","paste")),!0}ft.copy=ht.cut=(i,t)=>{let n=t,s=i.state.selection,l="cut"==n.type;if(s.empty)return;let a=zn?null:n.clipboardData,d=s.content(),{dom:h,text:m}=Fi(i,d);a?(n.preventDefault(),a.clearData(),a.setData("text/html",h.innerHTML),a.setData("text/plain",m)):function Ti(i,t){if(!i.dom.parentNode)return;let n=i.dom.parentNode.appendChild(document.createElement("div"));n.appendChild(t),n.style.cssText="position: fixed; left: -10000px; top: 10px";let s=getSelection(),l=document.createRange();l.selectNodeContents(t),i.dom.blur(),s.removeAllRanges(),s.addRange(l),setTimeout(()=>{n.parentNode&&n.parentNode.removeChild(n),i.focus()},50)}(i,h),l&&i.dispatch(i.state.tr.deleteSelection().scrollIntoView().setMeta("uiEvent","cut"))},ht.paste=(i,t)=>{let n=t;if(i.composing&&!fe)return;let s=zn?null:n.clipboardData;s&&Ze(i,s.getData("text/plain"),s.getData("text/html"),n)?n.preventDefault():function ho(i,t){if(!i.dom.parentNode)return;let n=i.input.shiftKey||i.state.selection.$from.parent.type.spec.code,s=i.dom.parentNode.appendChild(document.createElement(n?"textarea":"div"));n||(s.contentEditable="true"),s.style.cssText="position: fixed; left: -10000px; top: 10px",s.focus(),setTimeout(()=>{i.focus(),s.parentNode&&s.parentNode.removeChild(s),n?Ze(i,s.value,null,t):Ze(i,s.textContent,s.innerHTML,t)},50)}(i,n)};class eo{constructor(t,n){this.slice=t,this.move=n}}const gt=Ie?"altKey":"ctrlKey";ft.dragstart=(i,t)=>{let n=t,s=i.input.mouseDown;if(s&&s.done(),!n.dataTransfer)return;let l=i.state.selection,a=l.empty?null:i.posAtCoords(Pt(n));if(!(a&&a.pos>=l.from&&a.pos<=(l instanceof w.qv?l.to-1:l.to)))if(s&&s.mightDrag)i.dispatch(i.state.tr.setSelection(w.qv.create(i.state.doc,s.mightDrag.pos)));else if(n.target&&1==n.target.nodeType){let b=i.docView.nearestDesc(n.target,!0);b&&b.node.type.spec.draggable&&b!=i.docView&&i.dispatch(i.state.tr.setSelection(w.qv.create(i.state.doc,b.posBefore)))}let d=i.state.selection.content(),{dom:h,text:m}=Fi(i,d);n.dataTransfer.clearData(),n.dataTransfer.setData(zn?"Text":"text/html",h.innerHTML),n.dataTransfer.effectAllowed="copyMove",zn||n.dataTransfer.setData("text/plain",m),i.dragging=new eo(d,!n[gt])},ft.dragend=i=>{let t=i.dragging;window.setTimeout(()=>{i.dragging==t&&(i.dragging=null)},50)},ht.dragover=ht.dragenter=(i,t)=>t.preventDefault(),ht.drop=(i,t)=>{let n=t,s=i.dragging;if(i.dragging=null,!n.dataTransfer)return;let l=i.posAtCoords(Pt(n));if(!l)return;let a=i.state.doc.resolve(l.pos);if(!a)return;let d=s&&s.slice;d?i.someProp("transformPasted",H=>{d=H(d)}):d=pi(i,n.dataTransfer.getData(zn?"Text":"text/plain"),zn?null:n.dataTransfer.getData("text/html"),!1,a);let h=!(!s||n[gt]);if(i.someProp("handleDrop",H=>H(i,n,d||ye.p2.empty,h)))return void n.preventDefault();if(!d)return;n.preventDefault();let m=d?(0,Ve.nj)(i.state.doc,a.pos,d):a.pos;null==m&&(m=a.pos);let b=i.state.tr;h&&b.deleteSelection();let C=b.mapping.map(m),I=0==d.openStart&&0==d.openEnd&&1==d.content.childCount,D=b.doc;if(I?b.replaceRangeWith(C,C,d.content.firstChild):b.replaceRange(C,C,d),b.doc.eq(D))return;let R=b.doc.resolve(C);if(I&&w.qv.isSelectable(d.content.firstChild)&&R.nodeAfter&&R.nodeAfter.sameMarkup(d.content.firstChild))b.setSelection(new w.qv(R));else{let H=b.mapping.map(m);b.mapping.maps[b.mapping.maps.length-1].forEach((W,Y,ue,Ue)=>H=Ue),b.setSelection(ai(i,R,b.doc.resolve(H)))}i.focus(),i.dispatch(b.setMeta("uiEvent","drop"))},ft.focus=i=>{i.focused||(i.domObserver.stop(),i.dom.classList.add("ProseMirror-focused"),i.domObserver.start(),i.focused=!0,setTimeout(()=>{i.docView&&i.hasFocus()&&!i.domObserver.currentSelection.eq(i.domSelection())&&ln(i)},20))},ft.blur=(i,t)=>{let n=t;i.focused&&(i.domObserver.stop(),i.dom.classList.remove("ProseMirror-focused"),i.domObserver.start(),n.relatedTarget&&i.dom.contains(n.relatedTarget)&&i.domObserver.currentSelection.clear(),i.focused=!1)},ft.beforeinput=(i,t)=>{if(Se&&fe&&"deleteContentBackward"==t.inputType){i.domObserver.flushSoon();let{domChangeCount:s}=i.input;setTimeout(()=>{if(i.input.domChangeCount!=s||(i.dom.blur(),i.focus(),i.someProp("handleKeyDown",a=>a(i,$(8,"Backspace")))))return;let{$cursor:l}=i.state.selection;l&&l.pos>0&&i.dispatch(i.state.tr.delete(l.pos-1,l.pos).scrollIntoView())},50)}};for(let i in ht)ft[i]=ht[i];function vn(i,t){if(i==t)return!0;for(let n in i)if(i[n]!==t[n])return!1;for(let n in t)if(!(n in i))return!1;return!0}class Mi{constructor(t,n){this.toDOM=t,this.spec=n||Rt,this.side=this.spec.side||0}map(t,n,s,l){let{pos:a,deleted:d}=t.mapResult(n.from+l,this.side<0?-1:1);return d?null:new pt(a-s,a-s,this)}valid(){return!0}eq(t){return this==t||t instanceof Mi&&(this.spec.key&&this.spec.key==t.spec.key||this.toDOM==t.toDOM&&vn(this.spec,t.spec))}destroy(t){this.spec.destroy&&this.spec.destroy(t)}}class tn{constructor(t,n){this.attrs=t,this.spec=n||Rt}map(t,n,s,l){let a=t.map(n.from+l,this.spec.inclusiveStart?-1:1)-s,d=t.map(n.to+l,this.spec.inclusiveEnd?1:-1)-s;return a>=d?null:new pt(a,d,this)}valid(t,n){return n.from<n.to}eq(t){return this==t||t instanceof tn&&vn(this.attrs,t.attrs)&&vn(this.spec,t.spec)}static is(t){return t.type instanceof tn}destroy(){}}class xn{constructor(t,n){this.attrs=t,this.spec=n||Rt}map(t,n,s,l){let a=t.mapResult(n.from+l,1);if(a.deleted)return null;let d=t.mapResult(n.to+l,-1);return d.deleted||d.pos<=a.pos?null:new pt(a.pos-s,d.pos-s,this)}valid(t,n){let a,{index:s,offset:l}=t.content.findIndex(n.from);return l==n.from&&!(a=t.child(s)).isText&&l+a.nodeSize==n.to}eq(t){return this==t||t instanceof xn&&vn(this.attrs,t.attrs)&&vn(this.spec,t.spec)}destroy(){}}class pt{constructor(t,n,s){this.from=t,this.to=n,this.type=s}copy(t,n){return new pt(t,n,this.type)}eq(t,n=0){return this.type.eq(t.type)&&this.from+n==t.from&&this.to+n==t.to}map(t,n,s){return this.type.map(t,this,n,s)}static widget(t,n,s){return new pt(t,t,new Mi(n,s))}static inline(t,n,s,l){return new pt(t,n,new tn(s,l))}static node(t,n,s,l){return new pt(t,n,new xn(s,l))}get spec(){return this.type.spec}get inline(){return this.type instanceof tn}}const cn=[],Rt={};class lt{constructor(t,n){this.local=t.length?t:cn,this.children=n.length?n:cn}static create(t,n){return n.length?nn(n,t,0,Rt):at}find(t,n,s){let l=[];return this.findInner(null==t?0:t,null==n?1e9:n,l,0,s),l}findInner(t,n,s,l,a){for(let d=0;d<this.local.length;d++){let h=this.local[d];h.from<=n&&h.to>=t&&(!a||a(h.spec))&&s.push(h.copy(h.from+l,h.to+l))}for(let d=0;d<this.children.length;d+=3)if(this.children[d]<n&&this.children[d+1]>t){let h=this.children[d]+1;this.children[d+2].findInner(t-h,n-h,s,l+h,a)}}map(t,n,s){return this==at||0==t.maps.length?this:this.mapInner(t,n,0,0,s||Rt)}mapInner(t,n,s,l,a){let d;for(let h=0;h<this.local.length;h++){let m=this.local[h].map(t,s,l);m&&m.type.valid(n,m)?(d||(d=[])).push(m):a.onRemove&&a.onRemove(this.local[h].spec)}return this.children.length?function Vi(i,t,n,s,l,a,d){let h=i.slice(),m=(C,I,D,R)=>{for(let H=0;H<h.length;H+=3){let Y,W=h[H+1];if(W<0||C>W+a)continue;let ue=h[H]+a;I>=ue?h[H+1]=C<=ue?-2:-1:D>=l&&(Y=R-D-(I-C))&&(h[H]+=Y,h[H+1]+=Y)}};for(let C=0;C<n.maps.length;C++)n.maps[C].forEach(m);let b=!1;for(let C=0;C<h.length;C+=3)if(h[C+1]<0){if(-2==h[C+1]){b=!0,h[C+1]=-1;continue}let I=n.map(i[C]+a),D=I-l;if(D<0||D>=s.content.size){b=!0;continue}let H=n.map(i[C+1]+a,-1)-l,{index:W,offset:Y}=s.content.findIndex(D),ue=s.maybeChild(W);if(ue&&Y==D&&Y+ue.nodeSize==H){let Ue=h[C+2].mapInner(n,ue,I+1,i[C]+a+1,d);Ue!=at?(h[C]=D,h[C+1]=H,h[C+2]=Ue):(h[C+1]=-2,b=!0)}else b=!0}if(b){let C=function Xn(i,t,n,s,l,a,d){function h(m,b){for(let C=0;C<m.local.length;C++){let I=m.local[C].map(s,l,b);I?n.push(I):d.onRemove&&d.onRemove(m.local[C].spec)}for(let C=0;C<m.children.length;C+=3)h(m.children[C+2],m.children[C]+b+1)}for(let m=0;m<i.length;m+=3)-1==i[m+1]&&h(i[m+2],t[m]+a+1);return n}(h,i,t,n,l,a,d),I=nn(C,s,0,d);t=I.local;for(let D=0;D<h.length;D+=3)h[D+1]<0&&(h.splice(D,3),D-=3);for(let D=0,R=0;D<I.children.length;D+=3){let H=I.children[D];for(;R<h.length&&h[R]<H;)R+=3;h.splice(R,0,I.children[D],I.children[D+1],I.children[D+2])}}return new lt(t.sort(un),h)}(this.children,d||[],t,n,s,l,a):d?new lt(d.sort(un),cn):at}add(t,n){return n.length?this==at?lt.create(t,n):this.addInner(t,n,0):this}addInner(t,n,s){let l,a=0;t.forEach((h,m)=>{let C,b=m+s;if(C=Ln(n,h,b)){for(l||(l=this.children.slice());a<l.length&&l[a]<m;)a+=3;l[a]==m?l[a+2]=l[a+2].addInner(h,C,b+1):l.splice(a,0,m,m+h.nodeSize,nn(C,h,b+1,Rt)),a+=3}});let d=Qn(a?Si(n):n,-s);for(let h=0;h<d.length;h++)d[h].type.valid(t,d[h])||d.splice(h--,1);return new lt(d.length?this.local.concat(d).sort(un):this.local,l||this.children)}remove(t){return 0==t.length||this==at?this:this.removeInner(t,0)}removeInner(t,n){let s=this.children,l=this.local;for(let a=0;a<s.length;a+=3){let d,h=s[a]+n,m=s[a+1]+n;for(let I,C=0;C<t.length;C++)(I=t[C])&&I.from>h&&I.to<m&&(t[C]=null,(d||(d=[])).push(I));if(!d)continue;s==this.children&&(s=this.children.slice());let b=s[a+2].removeInner(d,h+1);b!=at?s[a+2]=b:(s.splice(a,3),a-=3)}if(l.length)for(let d,a=0;a<t.length;a++)if(d=t[a])for(let h=0;h<l.length;h++)l[h].eq(d,n)&&(l==this.local&&(l=this.local.slice()),l.splice(h--,1));return s==this.children&&l==this.local?this:l.length||s.length?new lt(l,s):at}forChild(t,n){if(this==at)return this;if(n.isLeaf)return lt.empty;let s,l;for(let h=0;h<this.children.length;h+=3)if(this.children[h]>=t){this.children[h]==t&&(s=this.children[h+2]);break}let a=t+1,d=a+n.content.size;for(let h=0;h<this.local.length;h++){let m=this.local[h];if(m.from<d&&m.to>a&&m.type instanceof tn){let b=Math.max(a,m.from)-a,C=Math.min(d,m.to)-a;b<C&&(l||(l=[])).push(m.copy(b,C))}}if(l){let h=new lt(l.sort(un),cn);return s?new Wt([h,s]):h}return s||at}eq(t){if(this==t)return!0;if(!(t instanceof lt)||this.local.length!=t.local.length||this.children.length!=t.children.length)return!1;for(let n=0;n<this.local.length;n++)if(!this.local[n].eq(t.local[n]))return!1;for(let n=0;n<this.children.length;n+=3)if(this.children[n]!=t.children[n]||this.children[n+1]!=t.children[n+1]||!this.children[n+2].eq(t.children[n+2]))return!1;return!0}locals(t){return ki(this.localsInner(t))}localsInner(t){if(this==at)return cn;if(t.inlineContent||!this.local.some(tn.is))return this.local;let n=[];for(let s=0;s<this.local.length;s++)this.local[s].type instanceof tn||n.push(this.local[s]);return n}}lt.empty=new lt([],[]),lt.removeOverlap=ki;const at=lt.empty;class Wt{constructor(t){this.members=t}map(t,n){const s=this.members.map(l=>l.map(t,n,Rt));return Wt.from(s)}forChild(t,n){if(n.isLeaf)return lt.empty;let s=[];for(let l=0;l<this.members.length;l++){let a=this.members[l].forChild(t,n);a!=at&&(a instanceof Wt?s=s.concat(a.members):s.push(a))}return Wt.from(s)}eq(t){if(!(t instanceof Wt)||t.members.length!=this.members.length)return!1;for(let n=0;n<this.members.length;n++)if(!this.members[n].eq(t.members[n]))return!1;return!0}locals(t){let n,s=!0;for(let l=0;l<this.members.length;l++){let a=this.members[l].localsInner(t);if(a.length)if(n){s&&(n=n.slice(),s=!1);for(let d=0;d<a.length;d++)n.push(a[d])}else n=a}return n?ki(s?n:n.sort(un)):cn}static from(t){switch(t.length){case 0:return at;case 1:return t[0];default:return new Wt(t)}}}function Qn(i,t){if(!t||!i.length)return i;let n=[];for(let s=0;s<i.length;s++){let l=i[s];n.push(new pt(l.from+t,l.to+t,l.type))}return n}function Ln(i,t,n){if(t.isLeaf)return null;let s=n+t.nodeSize,l=null;for(let d,a=0;a<i.length;a++)(d=i[a])&&d.from>n&&d.to<s&&((l||(l=[])).push(d),i[a]=null);return l}function Si(i){let t=[];for(let n=0;n<i.length;n++)null!=i[n]&&t.push(i[n]);return t}function nn(i,t,n,s){let l=[],a=!1;t.forEach((h,m)=>{let b=Ln(i,h,m+n);if(b){a=!0;let C=nn(b,h,n+m+1,s);C!=at&&l.push(m,m+h.nodeSize,C)}});let d=Qn(a?Si(i):i,-n).sort(un);for(let h=0;h<d.length;h++)d[h].type.valid(t,d[h])||(s.onRemove&&s.onRemove(d[h].spec),d.splice(h--,1));return d.length||l.length?new lt(d,l):at}function un(i,t){return i.from-t.from||i.to-t.to}function ki(i){let t=i;for(let n=0;n<t.length-1;n++){let s=t[n];if(s.from!=s.to)for(let l=n+1;l<t.length;l++){let a=t[l];if(a.from!=s.from){a.from<s.to&&(t==i&&(t=i.slice()),t[n]=s.copy(s.from,a.from),qn(t,l,s.copy(a.from,s.to)));break}a.to!=s.to&&(t==i&&(t=i.slice()),t[l]=a.copy(a.from,s.to),qn(t,l+1,a.copy(s.to,a.to)))}}return t}function qn(i,t,n){for(;t<i.length&&un(n,i[t])>0;)t++;i.splice(t,0,n)}function Jt(i){let t=[];return i.someProp("decorations",n=>{let s=n(i.state);s&&s!=at&&t.push(s)}),i.cursorWrapper&&t.push(lt.create(i.state.doc,[i.cursorWrapper.deco])),Wt.from(t)}const to={childList:!0,characterData:!0,characterDataOldValue:!0,attributes:!0,attributeOldValue:!0,subtree:!0},mo=Te&&ke<=11;class ei{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}set(t){this.anchorNode=t.anchorNode,this.anchorOffset=t.anchorOffset,this.focusNode=t.focusNode,this.focusOffset=t.focusOffset}clear(){this.anchorNode=this.focusNode=null}eq(t){return t.anchorNode==this.anchorNode&&t.anchorOffset==this.anchorOffset&&t.focusNode==this.focusNode&&t.focusOffset==this.focusOffset}}class wi{constructor(t,n){this.view=t,this.handleDOMChange=n,this.queue=[],this.flushingSoon=-1,this.observer=null,this.currentSelection=new ei,this.onCharData=null,this.suppressingSelectionUpdates=!1,this.observer=window.MutationObserver&&new window.MutationObserver(s=>{for(let l=0;l<s.length;l++)this.queue.push(s[l]);Te&&ke<=11&&s.some(l=>"childList"==l.type&&l.removedNodes.length||"characterData"==l.type&&l.oldValue.length>l.target.nodeValue.length)?this.flushSoon():this.flush()}),mo&&(this.onCharData=s=>{this.queue.push({target:s.target,type:"characterData",oldValue:s.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this)}flushSoon(){this.flushingSoon<0&&(this.flushingSoon=window.setTimeout(()=>{this.flushingSoon=-1,this.flush()},20))}forceFlush(){this.flushingSoon>-1&&(window.clearTimeout(this.flushingSoon),this.flushingSoon=-1,this.flush())}start(){this.observer&&(this.observer.takeRecords(),this.observer.observe(this.view.dom,to)),this.onCharData&&this.view.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.connectSelection()}stop(){if(this.observer){let t=this.observer.takeRecords();if(t.length){for(let n=0;n<t.length;n++)this.queue.push(t[n]);window.setTimeout(()=>this.flush(),20)}this.observer.disconnect()}this.onCharData&&this.view.dom.removeEventListener("DOMCharacterDataModified",this.onCharData),this.disconnectSelection()}connectSelection(){this.view.dom.ownerDocument.addEventListener("selectionchange",this.onSelectionChange)}disconnectSelection(){this.view.dom.ownerDocument.removeEventListener("selectionchange",this.onSelectionChange)}suppressSelectionUpdates(){this.suppressingSelectionUpdates=!0,setTimeout(()=>this.suppressingSelectionUpdates=!1,50)}onSelectionChange(){if(Zt(this.view)){if(this.suppressingSelectionUpdates)return ln(this.view);if(Te&&ke<=11&&!this.view.state.selection.empty){let t=this.view.domSelection();if(t.focusNode&&Ge(t.focusNode,t.focusOffset,t.anchorNode,t.anchorOffset))return this.flushSoon()}this.flush()}}setCurSelection(){this.currentSelection.set(this.view.domSelection())}ignoreSelectionChange(t){if(0==t.rangeCount)return!0;let n=t.getRangeAt(0).commonAncestorContainer,s=this.view.docView.nearestDesc(n);return s&&s.ignoreMutation({type:"selection",target:3==n.nodeType?n.parentNode:n})?(this.setCurSelection(),!0):void 0}flush(){if(!this.view.docView||this.flushingSoon>-1)return;let t=this.observer?this.observer.takeRecords():[];this.queue.length&&(t=this.queue.concat(t),this.queue.length=0);let n=this.view.domSelection(),s=!this.suppressingSelectionUpdates&&!this.currentSelection.eq(n)&&Zt(this.view)&&!this.ignoreSelectionChange(n),l=-1,a=-1,d=!1,h=[];if(this.view.editable)for(let m=0;m<t.length;m++){let b=this.registerMutation(t[m],h);b&&(l=l<0?b.from:Math.min(b.from,l),a=a<0?b.to:Math.max(b.to,a),b.typeOver&&(d=!0))}if(ve&&h.length>1){let m=h.filter(b=>"BR"==b.nodeName);if(2==m.length){let b=m[0],C=m[1];b.parentNode&&b.parentNode.parentNode==C.parentNode?C.remove():b.remove()}}(l>-1||s)&&(l>-1&&(this.view.docView.markDirty(l,a),function no(i){$i||($i=!0,"normal"==getComputedStyle(i.dom).whiteSpace&&console.warn("ProseMirror expects the CSS white-space property to be set, preferably to 'pre-wrap'. It is recommended to load style/prosemirror.css from the prosemirror-view package."))}(this.view)),this.handleDOMChange(l,a,d,h),this.view.docView&&this.view.docView.dirty?this.view.updateState(this.view.state):this.currentSelection.eq(n)||ln(this.view),this.currentSelection.set(n))}registerMutation(t,n){if(n.indexOf(t.target)>-1)return null;let s=this.view.docView.nearestDesc(t.target);if("attributes"==t.type&&(s==this.view.docView||"contenteditable"==t.attributeName||"style"==t.attributeName&&!t.oldValue&&!t.target.getAttribute("style"))||!s||s.ignoreMutation(t))return null;if("childList"==t.type){for(let C=0;C<t.addedNodes.length;C++)n.push(t.addedNodes[C]);if(s.contentDOM&&s.contentDOM!=s.dom&&!s.contentDOM.contains(t.target))return{from:s.posBefore,to:s.posAfter};let l=t.previousSibling,a=t.nextSibling;if(Te&&ke<=11&&t.addedNodes.length)for(let C=0;C<t.addedNodes.length;C++){let{previousSibling:I,nextSibling:D}=t.addedNodes[C];(!I||Array.prototype.indexOf.call(t.addedNodes,I)<0)&&(l=I),(!D||Array.prototype.indexOf.call(t.addedNodes,D)<0)&&(a=D)}let d=l&&l.parentNode==t.target?te(l)+1:0,h=s.localPosFromDOM(t.target,d,-1),m=a&&a.parentNode==t.target?te(a):t.target.childNodes.length;return{from:h,to:s.localPosFromDOM(t.target,m,1)}}return"attributes"==t.type?{from:s.posAtStart-s.border,to:s.posAtEnd+s.border}:{from:s.posAtStart,to:s.posAtEnd,typeOver:t.target.nodeValue==t.oldValue}}}let $i=!1;function oo(i){let t=i.pmViewDesc;if(t)return t.parseRule();if("BR"==i.nodeName&&i.parentNode){if(e&&/^(ul|ol)$/i.test(i.parentNode.nodeName)){let n=document.createElement("div");return n.appendChild(document.createElement("li")),{skip:n}}if(i.parentNode.lastChild==i||e&&/^(tr|table)$/i.test(i.parentNode.nodeName))return{ignore:!0}}else if("IMG"==i.nodeName&&i.getAttribute("mark-placeholder"))return{ignore:!0};return null}function Ii(i,t,n){return Math.max(n.anchor,n.head)>t.content.size?null:ai(i,t.resolve(n.anchor),t.resolve(n.head))}function Hn(i,t,n){let s=i.depth,l=t?i.end():i.pos;for(;s>0&&(t||i.indexAfter(s)==i.node(s).childCount);)s--,l++,t=!1;if(n){let a=i.node(s).maybeChild(i.indexAfter(s));for(;a&&!a.isLeaf;)a=a.firstChild,l++}return l}class lo{constructor(t,n){this._root=null,this.focused=!1,this.trackWrites=null,this.mounted=!1,this.markCursor=null,this.cursorWrapper=null,this.lastSelectedViewDesc=void 0,this.input=new Qi,this.prevDirectPlugins=[],this.pluginViews=[],this.dragging=null,this._props=n,this.state=n.state,this.directPlugins=n.plugins||[],this.directPlugins.forEach(se),this.dispatch=this.dispatch.bind(this),this.dom=t&&t.mount||document.createElement("div"),t&&(t.appendChild?t.appendChild(this.dom):"function"==typeof t?t(this.dom):t.mount&&(this.mounted=!0)),this.editable=ao(this),dn(this),this.nodeViews=co(this),this.docView=k(this.state.doc,Qe(this),Jt(this),this.dom,this),this.domObserver=new wi(this,(s,l,a,d)=>function ro(i,t,n,s,l){if(t<0){let we=i.input.lastSelectionTime>Date.now()-50?i.input.lastSelectionOrigin:null,pn=Cn(i,we);if(pn&&!i.state.selection.eq(pn)){let uo=i.state.tr.setSelection(pn);"pointer"==we?uo.setMeta("pointer",!0):"key"==we&&uo.scrollIntoView(),i.dispatch(uo)}return}let a=i.state.doc.resolve(t),d=a.sharedDepth(n);t=a.before(d+1),n=i.state.doc.resolve(n).after(d+1);let h=i.state.selection,m=function io(i,t,n){let b,{node:s,fromOffset:l,toOffset:a,from:d,to:h}=i.docView.parseRange(t,n),m=i.domSelection(),C=m.anchorNode;if(C&&i.dom.contains(1==C.nodeType?C:C.parentNode)&&(b=[{node:C,offset:m.anchorOffset}],L(m)||b.push({node:m.focusNode,offset:m.focusOffset})),Se&&8===i.input.lastKeyCode)for(let Y=a;Y>l;Y--){let ue=s.childNodes[Y-1],Ue=ue.pmViewDesc;if("BR"==ue.nodeName&&!Ue){a=Y;break}if(!Ue||Ue.size)break}let I=i.state.doc,D=i.someProp("domParser")||ye.aw.fromSchema(i.state.schema),R=I.resolve(d),H=null,W=D.parse(s,{topNode:R.parent,topMatch:R.parent.contentMatchAt(R.index()),topOpen:!0,from:l,to:a,preserveWhitespace:"pre"!=R.parent.type.whitespace||"full",findPositions:b,ruleFromNode:oo,context:R});if(b&&null!=b[0].pos){let Y=b[0].pos,ue=b[1]&&b[1].pos;null==ue&&(ue=Y),H={anchor:Y+d,head:ue+d}}return{doc:W,sel:H,from:d,to:h}}(i,t,n);if(Se&&i.cursorWrapper&&m.sel&&m.sel.anchor==i.cursorWrapper.deco.from&&m.sel.head==m.sel.anchor){let we=i.cursorWrapper.deco.type.toDOM.nextSibling,pn=we&&we.nodeValue?we.nodeValue.length:1;m.sel={anchor:m.sel.anchor+pn,head:m.sel.anchor+pn}}let I,D,b=i.state.doc,C=b.slice(m.from,m.to);8===i.input.lastKeyCode&&Date.now()-100<i.input.lastKeyCodeTime?(I=i.state.selection.to,D="end"):(I=i.state.selection.from,D="start"),i.input.lastKeyCode=null;let R=function ti(i,t,n,s,l){let a=i.findDiffStart(t,n);if(null==a)return null;let{a:d,b:h}=i.findDiffEnd(t,n+i.size,n+t.size);return"end"==l&&(s-=d+Math.max(0,a-Math.min(d,h))-a),d<a&&i.size<t.size?(a-=s<=a&&s>=d?a-s:0,h=a+(h-d),d=a):h<a&&(a-=s<=a&&s>=h?a-s:0,d=a+(d-h),h=a),{start:a,endA:d,endB:h}}(C.content,m.doc.content,m.from,I,D);if((Ke&&i.input.lastIOSEnter>Date.now()-225||fe)&&l.some(we=>"DIV"==we.nodeName||"P"==we.nodeName)&&(!R||R.endA>=R.endB)&&i.someProp("handleKeyDown",we=>we(i,$(13,"Enter"))))return void(i.input.lastIOSEnter=0);if(!R){if(!(s&&h instanceof w.Bs&&!h.empty&&h.$head.sameParent(h.$anchor))||i.composing||m.sel&&m.sel.anchor!=m.sel.head){if(m.sel){let we=Ii(i,i.state.doc,m.sel);we&&!we.eq(i.state.selection)&&i.dispatch(i.state.tr.setSelection(we))}return}R={start:h.from,endA:h.to,endB:h.to}}i.input.domChangeCount++,i.state.selection.from<i.state.selection.to&&R.start==R.endB&&i.state.selection instanceof w.Bs&&(R.start>i.state.selection.from&&R.start<=i.state.selection.from+2&&i.state.selection.from>=m.from?R.start=i.state.selection.from:R.endA<i.state.selection.to&&R.endA>=i.state.selection.to-2&&i.state.selection.to<=m.to&&(R.endB+=i.state.selection.to-R.endA,R.endA=i.state.selection.to)),Te&&ke<=11&&R.endB==R.start+1&&R.endA==R.start&&R.start>m.from&&" \xa0"==m.doc.textBetween(R.start-m.from-1,R.start-m.from+1)&&(R.start--,R.endA--,R.endB--);let Ue,H=m.doc.resolveNoCache(R.start-m.from),W=m.doc.resolveNoCache(R.endB-m.from),Y=b.resolve(R.start),ue=H.sameParent(W)&&H.parent.inlineContent&&Y.end()>=R.endA;if((Ke&&i.input.lastIOSEnter>Date.now()-225&&(!ue||l.some(we=>"DIV"==we.nodeName||"P"==we.nodeName))||!ue&&H.pos<m.doc.content.size&&(Ue=w.Y1.findFrom(m.doc.resolve(H.pos+1),1,!0))&&Ue.head==W.pos)&&i.someProp("handleKeyDown",we=>we(i,$(13,"Enter"))))return void(i.input.lastIOSEnter=0);if(i.state.selection.anchor>R.start&&function so(i,t,n,s,l){if(!s.parent.isTextblock||n-t<=l.pos-s.pos||Hn(s,!0,!1)<l.pos)return!1;let a=i.resolve(t);if(a.parentOffset<a.parent.content.size||!a.parent.isTextblock)return!1;let d=i.resolve(Hn(a,!0,!0));return!(!d.parent.isTextblock||d.pos>n||Hn(d,!0,!1)<n)&&s.parent.content.cut(s.parentOffset).eq(d.parent.content)}(b,R.start,R.endA,H,W)&&i.someProp("handleKeyDown",we=>we(i,$(8,"Backspace"))))return void(fe&&Se&&i.domObserver.suppressSelectionUpdates());Se&&fe&&R.endB==R.start&&(i.input.lastAndroidDelete=Date.now()),fe&&!ue&&H.start()!=W.start()&&0==W.parentOffset&&H.depth==W.depth&&m.sel&&m.sel.anchor==m.sel.head&&m.sel.head==R.endA&&(R.endB-=2,W=m.doc.resolveNoCache(R.endB-m.from),setTimeout(()=>{i.someProp("handleKeyDown",function(we){return we(i,$(13,"Enter"))})},20));let Re,Kt,zt,yt=R.start,Tt=R.endA;if(ue)if(H.pos==W.pos)Te&&ke<=11&&0==H.parentOffset&&(i.domObserver.suppressSelectionUpdates(),setTimeout(()=>ln(i),20)),Re=i.state.tr.delete(yt,Tt),Kt=b.resolve(R.start).marksAcross(b.resolve(R.endA));else if(R.endA==R.endB&&(zt=function Oi(i,t){let d,h,m,n=i.firstChild.marks,s=t.firstChild.marks,l=n,a=s;for(let C=0;C<s.length;C++)l=s[C].removeFromSet(l);for(let C=0;C<n.length;C++)a=n[C].removeFromSet(a);if(1==l.length&&0==a.length)h=l[0],d="add",m=C=>C.mark(h.addToSet(C.marks));else{if(0!=l.length||1!=a.length)return null;h=a[0],d="remove",m=C=>C.mark(h.removeFromSet(C.marks))}let b=[];for(let C=0;C<t.childCount;C++)b.push(m(t.child(C)));if(ye.HY.from(b).eq(i))return{mark:h,type:d}}(H.parent.content.cut(H.parentOffset,W.parentOffset),Y.parent.content.cut(Y.parentOffset,R.endA-Y.start()))))Re=i.state.tr,"add"==zt.type?Re.addMark(yt,Tt,zt.mark):Re.removeMark(yt,Tt,zt.mark);else if(H.parent.child(H.index()).isText&&H.index()==W.index()-(W.textOffset?0:1)){let we=H.parent.textBetween(H.parentOffset,W.parentOffset);if(i.someProp("handleTextInput",pn=>pn(i,yt,Tt,we)))return;Re=i.state.tr.insertText(we,yt,Tt)}if(Re||(Re=i.state.tr.replace(yt,Tt,m.doc.slice(R.start-m.from,R.endB-m.from))),m.sel){let we=Ii(i,Re.doc,m.sel);we&&!(Se&&fe&&i.composing&&we.empty&&(R.start!=R.endB||i.input.lastAndroidDelete<Date.now()-100)&&(we.head==yt||we.head==Re.mapping.map(Tt)-1)||Te&&we.empty&&we.head==yt)&&Re.setSelection(we)}Kt&&Re.ensureMarks(Kt),i.dispatch(Re.scrollIntoView())}(this,s,l,a,d)),this.domObserver.start(),function Xi(i){for(let t in ft){let n=ft[t];i.dom.addEventListener(t,i.input.eventHandlers[t]=s=>{ce(i,s)&&!Ft(i,s)&&(i.editable||!(s.type in ht))&&n(i,s)})}e&&i.dom.addEventListener("input",()=>null),An(i)}(this),this.updatePluginViews()}get composing(){return this.input.composing}get props(){if(this._props.state!=this.state){let t=this._props;this._props={};for(let n in t)this._props[n]=t[n];this._props.state=this.state}return this._props}update(t){t.handleDOMEvents!=this._props.handleDOMEvents&&An(this),this._props=t,t.plugins&&(t.plugins.forEach(se),this.directPlugins=t.plugins),this.updateStateInner(t.state,!0)}setProps(t){let n={};for(let s in this._props)n[s]=this._props[s];n.state=this.state;for(let s in t)n[s]=t[s];this.update(n)}updateState(t){this.updateStateInner(t,this.state.plugins!=t.plugins)}updateStateInner(t,n){let s=this.state,l=!1,a=!1;if(t.storedMarks&&this.composing&&(xi(this),a=!0),this.state=t,n){let I=co(this);(function ne(i,t){let n=0,s=0;for(let l in i){if(i[l]!=t[l])return!0;n++}for(let l in t)s++;return n!=s})(I,this.nodeViews)&&(this.nodeViews=I,l=!0),An(this)}this.editable=ao(this),dn(this);let d=Jt(this),h=Qe(this),m=n?"reset":t.scrollToSelection>s.scrollToSelection?"to selection":"preserve",b=l||!this.docView.matchesNode(t.doc,h,d);(b||!t.selection.eq(s.selection))&&(a=!0);let C="preserve"==m&&a&&null==this.dom.style.overflowAnchor&&function We(i){let s,l,t=i.dom.getBoundingClientRect(),n=Math.max(0,t.top);for(let a=(t.left+t.right)/2,d=n+1;d<Math.min(innerHeight,t.bottom);d+=5){let h=i.root.elementFromPoint(a,d);if(!h||h==i.dom||!i.dom.contains(h))continue;let m=h.getBoundingClientRect();if(m.top>=n-20){s=h,l=m.top;break}}return{refDOM:s,refTop:l,stack:rt(i.dom)}}(this);if(a){this.domObserver.stop();let I=b&&(Te||Se)&&!this.composing&&!s.selection.empty&&!t.selection.empty&&function Ui(i,t){let n=Math.min(i.$anchor.sharedDepth(i.head),t.$anchor.sharedDepth(t.head));return i.$anchor.start(n)!=t.$anchor.start(n)}(s.selection,t.selection);if(b){let D=Se?this.trackWrites=this.domSelection().focusNode:null;(l||!this.docView.update(t.doc,h,d,this))&&(this.docView.updateOuterDeco([]),this.docView.destroy(),this.docView=k(t.doc,h,d,this.dom,this)),D&&!this.trackWrites&&(I=!0)}I||!(this.input.mouseDown&&this.domObserver.currentSelection.eq(this.domSelection())&&function Un(i){let t=i.docView.domFromPos(i.state.selection.anchor,0),n=i.domSelection();return Ge(t.node,t.offset,n.anchorNode,n.anchorOffset)}(this))?ln(this,I):(li(this,t.selection),this.domObserver.setCurSelection()),this.domObserver.start()}if(this.updatePluginViews(s),"reset"==m)this.dom.scrollTop=0;else if("to selection"==m){let I=this.domSelection().focusNode;if(!this.someProp("handleScrollToSelection",D=>D(this)))if(t.selection instanceof w.qv){let D=this.docView.domAfterPos(t.selection.from);1==D.nodeType&&De(this,D.getBoundingClientRect(),I)}else De(this,this.coordsAtPos(t.selection.head,1),I)}else C&&function Le({refDOM:i,refTop:t,stack:n}){let s=i?i.getBoundingClientRect().top:0;Yt(n,0==s?0:s-t)}(C)}destroyPluginViews(){let t;for(;t=this.pluginViews.pop();)t.destroy&&t.destroy()}updatePluginViews(t){if(t&&t.plugins==this.state.plugins&&this.directPlugins==this.prevDirectPlugins)for(let n=0;n<this.pluginViews.length;n++){let s=this.pluginViews[n];s.update&&s.update(this,t)}else{this.prevDirectPlugins=this.directPlugins,this.destroyPluginViews();for(let n=0;n<this.directPlugins.length;n++){let s=this.directPlugins[n];s.spec.view&&this.pluginViews.push(s.spec.view(this))}for(let n=0;n<this.state.plugins.length;n++){let s=this.state.plugins[n];s.spec.view&&this.pluginViews.push(s.spec.view(this))}}}someProp(t,n){let l,s=this._props&&this._props[t];if(null!=s&&(l=n?n(s):s))return l;for(let d=0;d<this.directPlugins.length;d++){let h=this.directPlugins[d].props[t];if(null!=h&&(l=n?n(h):h))return l}let a=this.state.plugins;if(a)for(let d=0;d<a.length;d++){let h=a[d].props[t];if(null!=h&&(l=n?n(h):h))return l}}hasFocus(){return this.root.activeElement==this.dom}focus(){this.domObserver.stop(),this.editable&&function wn(i){if(i.setActive)return i.setActive();if(jt)return i.focus(jt);let t=rt(i);i.focus(null==jt?{get preventScroll(){return jt={preventScroll:!0},!0}}:void 0),jt||(jt=!1,Yt(t,0))}(this.dom),ln(this),this.domObserver.start()}get root(){let t=this._root;if(null==t)for(let n=this.dom.parentNode;n;n=n.parentNode)if(9==n.nodeType||11==n.nodeType&&n.host)return n.getSelection||(Object.getPrototypeOf(n).getSelection=()=>n.ownerDocument.getSelection()),this._root=n;return t||document}posAtCoords(t){return In(this,t)}coordsAtPos(t,n=1){return Dn(this,t,n)}domAtPos(t,n=0){return this.docView.domFromPos(t,n)}nodeDOM(t){let n=this.docView.descAt(t);return n?n.nodeDOM:null}posAtDOM(t,n,s=-1){let l=this.docView.posFromDOM(t,n,s);if(null==l)throw new RangeError("DOM position not inside the editor");return l}endOfTextblock(t,n){return function x(i,t,n){return Dt==t&&N==n?y:(Dt=t,N=n,y="up"==n||"down"==n?function Pn(i,t,n){let s=t.selection,l="up"==n?s.$from:s.$to;return En(i,t,()=>{let{node:a}=i.docView.domFromPos(l.pos,"up"==n?-1:1);for(;;){let h=i.docView.nearestDesc(a,!0);if(!h)break;if(h.node.isBlock){a=h.dom;break}a=h.dom.parentNode}let d=Dn(i,l.pos,1);for(let h=a.firstChild;h;h=h.nextSibling){let m;if(1==h.nodeType)m=h.getClientRects();else{if(3!=h.nodeType)continue;m=$e(h,0,h.nodeValue.length).getClientRects()}for(let b=0;b<m.length;b++){let C=m[b];if(C.bottom>C.top+1&&("up"==n?d.top-C.top>2*(C.bottom-d.top):C.bottom-d.bottom>2*(d.bottom-C.top)))return!1}}return!0})}(i,t,n):function ut(i,t,n){let{$head:s}=t.selection;if(!s.parent.isTextblock)return!1;let l=s.parentOffset,a=!l,d=l==s.parent.content.size,h=i.domSelection();return Ot.test(s.parent.textContent)&&h.modify?En(i,t,()=>{let m=h.getRangeAt(0),b=h.focusNode,C=h.focusOffset,I=h.caretBidiLevel;h.modify("move",n,"character");let R=!(s.depth?i.docView.domAfterPos(s.before()):i.dom).contains(1==h.focusNode.nodeType?h.focusNode:h.focusNode.parentNode)||b==h.focusNode&&C==h.focusOffset;return h.removeAllRanges(),h.addRange(m),null!=I&&(h.caretBidiLevel=I),R}):"left"==n||"backward"==n?a:d}(i,t,n))}(this,n||this.state,t)}destroy(){!this.docView||(function Je(i){i.domObserver.stop();for(let t in i.input.eventHandlers)i.dom.removeEventListener(t,i.input.eventHandlers[t]);clearTimeout(i.input.composingTimeout),clearTimeout(i.input.lastIOSEnterFallbackTimeout)}(this),this.destroyPluginViews(),this.mounted?(this.docView.update(this.state.doc,[],Jt(this),this),this.dom.textContent=""):this.dom.parentNode&&this.dom.parentNode.removeChild(this.dom),this.docView.destroy(),this.docView=null)}get isDestroyed(){return null==this.docView}dispatchEvent(t){return function en(i,t){!Ft(i,t)&&ft[t.type]&&(i.editable||!(t.type in ht))&&ft[t.type](i,t)}(this,t)}dispatch(t){let n=this._props.dispatchTransaction;n?n.call(this,t):this.updateState(this.state.apply(t))}domSelection(){return this.root.getSelection()}}function Qe(i){let t=Object.create(null);return t.class="ProseMirror",t.contenteditable=String(i.editable),t.translate="no",i.someProp("attributes",n=>{if("function"==typeof n&&(n=n(i.state)),n)for(let s in n)"class"==s&&(t.class+=" "+n[s]),"style"==s?t.style=(t.style?t.style+";":"")+n[s]:!t[s]&&"contenteditable"!=s&&"nodeName"!=s&&(t[s]=String(n[s]))}),[pt.node(0,i.state.doc.content.size,t)]}function dn(i){if(i.markCursor){let t=document.createElement("img");t.className="ProseMirror-separator",t.setAttribute("mark-placeholder","true"),t.setAttribute("alt",""),i.cursorWrapper={dom:t,deco:pt.widget(i.state.selection.head,t,{raw:!0,marks:i.markCursor})}}else i.cursorWrapper=null}function ao(i){return!i.someProp("editable",t=>!1===t(i.state))}function co(i){let t=Object.create(null);function n(s){for(let l in s)Object.prototype.hasOwnProperty.call(t,l)||(t[l]=s[l])}return i.someProp("nodeViews",n),i.someProp("markViews",n),t}function se(i){if(i.spec.state||i.spec.filterTransaction||i.spec.appendTransaction)throw new RangeError("Plugins passed directly to the view must not have a state component")}}}]);